# åŒºå—é“¾ä¸æ™ºèƒ½åˆçº¦çš„å¯è®¡ç®—æ€§åˆ†æ

> **ä¸»é¢˜**: å›¾çµå®Œå¤‡æ€§çš„è¯…å’’ä¸ç¥ç¦
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-02
> **éš¾åº¦**: â­â­â­
> **å‰ç½®çŸ¥è¯†**: REç†è®ºã€Riceå®šç†

---

## ğŸ“‹ ç›®å½•

- [åŒºå—é“¾ä¸æ™ºèƒ½åˆçº¦çš„å¯è®¡ç®—æ€§åˆ†æ](#åŒºå—é“¾ä¸æ™ºèƒ½åˆçº¦çš„å¯è®¡ç®—æ€§åˆ†æ)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ™ºèƒ½åˆçº¦çš„è®¡ç®—æ¨¡å‹](#1-æ™ºèƒ½åˆçº¦çš„è®¡ç®—æ¨¡å‹)
    - [1.1 Solidity = å›¾çµå®Œå¤‡](#11-solidity--å›¾çµå®Œå¤‡)
    - [1.2 Gasæœºåˆ¶çš„ç†è®ºå¿…ç„¶æ€§](#12-gasæœºåˆ¶çš„ç†è®ºå¿…ç„¶æ€§)
  - [2. å›¾çµå®Œå¤‡çš„ä»£ä»·](#2-å›¾çµå®Œå¤‡çš„ä»£ä»·)
    - [2.1 æ— æ³•é™æ€éªŒè¯çš„æ€§è´¨](#21-æ— æ³•é™æ€éªŒè¯çš„æ€§è´¨)
    - [2.2 å®é™…æ”»å‡»æ¡ˆä¾‹](#22-å®é™…æ”»å‡»æ¡ˆä¾‹)
    - [2.3 éå›¾çµå®Œå¤‡çš„é€‰æ‹©](#23-éå›¾çµå®Œå¤‡çš„é€‰æ‹©)
  - [3. å½¢å¼åŒ–éªŒè¯ç­–ç•¥](#3-å½¢å¼åŒ–éªŒè¯ç­–ç•¥)
    - [3.1 éªŒè¯ç‰¹å®šæ€§è´¨](#31-éªŒè¯ç‰¹å®šæ€§è´¨)
    - [3.2 å·¥å…·é“¾](#32-å·¥å…·é“¾)
  - [4. å®è·µæ¡ˆä¾‹](#4-å®è·µæ¡ˆä¾‹)
    - [4.1 Uniswap V3éªŒè¯](#41-uniswap-v3éªŒè¯)
    - [4.2 The DAOäº‹ä»¶å¤ç›˜](#42-the-daoäº‹ä»¶å¤ç›˜)
  - [5. æœªæ¥æ–¹å‘](#5-æœªæ¥æ–¹å‘)
    - [5.1 é›¶çŸ¥è¯†è¯æ˜åˆçº¦](#51-é›¶çŸ¥è¯†è¯æ˜åˆçº¦)
    - [5.2 å½¢å¼åŒ–é©±åŠ¨å¼€å‘](#52-å½¢å¼åŒ–é©±åŠ¨å¼€å‘)
  - [6. ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾](#6-ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾)
    - [6.1 è®ºè¯ä¾èµ–å…³ç³»](#61-è®ºè¯ä¾èµ–å…³ç³»)
    - [6.2 æ¦‚å¿µä¾èµ–å…³ç³»](#62-æ¦‚å¿µä¾èµ–å…³ç³»)
  - [7. å‚è€ƒèµ„æº](#7-å‚è€ƒèµ„æº)
    - [7.1 ç»å…¸è®ºæ–‡](#71-ç»å…¸è®ºæ–‡)
    - [7.2 æ•™æ](#72-æ•™æ)
    - [7.3 åœ¨çº¿èµ„æº](#73-åœ¨çº¿èµ„æº)

---

## 1. æ™ºèƒ½åˆçº¦çš„è®¡ç®—æ¨¡å‹

### 1.1 Solidity = å›¾çµå®Œå¤‡

**Solidityç‰¹æ€§**:

- å¾ªç¯: `while`, `for`
- é€’å½’å‡½æ•°è°ƒç”¨
- åŠ¨æ€å­˜å‚¨

**æ˜ å°„åˆ°å½¢å¼ç³»ç»Ÿ**:

| Solidity | å½¢å¼ç³»ç»Ÿ | å¯è®¡ç®—æ€§ |
|----------|----------|----------|
| çŠ¶æ€å˜é‡ | å›¾çµæœºç£å¸¦ | æ— é™å­˜å‚¨ |
| å‡½æ•°è°ƒç”¨ | çŠ¶æ€è½¬ç§» | ä»»æ„è®¡ç®— |
| revertæœºåˆ¶ | æ‹’ç»çŠ¶æ€ | REè¯†åˆ« |

**ç»“è®º**: Solidity â‰ˆ å›¾çµæœºï¼ˆå›¾çµå®Œå¤‡ï¼‰

### 1.2 Gasæœºåˆ¶çš„ç†è®ºå¿…ç„¶æ€§

**é—®é¢˜**: å¦‚ä½•é˜²æ­¢æ— é™å¾ªç¯ï¼Ÿ

**åœæœºé—®é¢˜**: æ— æ³•åˆ¤å®šåˆçº¦æ˜¯å¦ç»ˆæ­¢ï¼

**è§£å†³**: Gasé™åˆ¶ï¼ˆè¿è¡Œæ—¶çº¦æŸï¼‰

```solidity
function potentialLoop() {
    while (condition) {  // å¯èƒ½æ— é™å¾ªç¯
        // ... æ¯æ­¥æ¶ˆè€—gas
    }
    // Gasè€—å°½ â†’ è‡ªåŠ¨revert
}
```

**ç†è®ºè§†è§’**:

- æ‰¿è®¤åœæœºé—®é¢˜ä¸å¯åˆ¤å®š
- ç”¨èµ„æºé™åˆ¶æ›¿ä»£åˆ¤å®š

---

## 2. å›¾çµå®Œå¤‡çš„ä»£ä»·

### 2.1 æ— æ³•é™æ€éªŒè¯çš„æ€§è´¨

**Riceå®šç†åº”ç”¨**: ä»¥ä¸‹æ€§è´¨éƒ½**ä¸å¯åˆ¤å®š**

âŒ åˆçº¦æ˜¯å¦æ€»æ˜¯ç»ˆæ­¢ï¼Ÿ
âŒ åˆçº¦æ˜¯å¦å¯èƒ½æ•´æ•°æº¢å‡ºï¼Ÿ
âŒ åˆçº¦æ˜¯å¦ä¿æŒä¸å˜å¼ï¼Ÿ
âŒ åˆçº¦Gasæ¶ˆè€—æ˜¯å¦â‰¤æŸä¸ªç•Œï¼Ÿ

### 2.2 å®é™…æ”»å‡»æ¡ˆä¾‹

**DAOæ”»å‡» (2016)**:

```solidity
// é€’å½’è°ƒç”¨ (é‡å…¥æ”»å‡»)
function withdraw() {
    uint amount = balances[msg.sender];
    msg.sender.call.value(amount)();  // å¤–éƒ¨è°ƒç”¨
    balances[msg.sender] = 0;  // å¤ªæ™šäº†!
}
```

**å¯è®¡ç®—æ€§åˆ†æ**:

- é‡å…¥ = é€’å½’è°ƒç”¨ = ä¸åŠ¨ç‚¹
- é™æ€æ£€æµ‹**æ‰€æœ‰**é‡å…¥ = Riceå®šç† â†’ ä¸å¯åˆ¤å®š
- âœ… å¯ä»¥æ£€æµ‹**å·²çŸ¥æ¨¡å¼**ï¼ˆå¯å‘å¼ï¼‰

### 2.3 éå›¾çµå®Œå¤‡çš„é€‰æ‹©

**Bitcoin Script**:

- æ— å¾ªç¯
- éå›¾çµå®Œå¤‡
- âœ… å¯ä¿è¯ç»ˆæ­¢
- âŒ è¡¨è¾¾åŠ›å—é™

**Moveè¯­è¨€** (Diem/Aptos):

- èµ„æºç±»å‹ï¼ˆçº¿æ€§é€»è¾‘ï¼‰
- é™åˆ¶é€’å½’
- å¹³è¡¡å®‰å…¨æ€§ä¸è¡¨è¾¾åŠ›

---

## 3. å½¢å¼åŒ–éªŒè¯ç­–ç•¥

### 3.1 éªŒè¯ç‰¹å®šæ€§è´¨

**å¯è¡Œç­–ç•¥**: éªŒè¯Î£â‚æ€§è´¨

**ä¾‹å­**: "ä¸å˜å¼æ°¸è¿œæˆç«‹"

```solidity
// ä¸å˜å¼: totalSupply = sum(balances)
contract Token {
    mapping(address => uint) balances;
    uint totalSupply;

    // éªŒè¯: transferåä¸å˜å¼ä¿æŒ
}
```

**Kæ¡†æ¶æ–¹æ³•**:

```k
rule <k> transfer(To, Amount) => . ... </k>
     <balances> ... From |-> (B1 => B1 - Amount) ... </balances>
     <balances> ... To |-> (B2 => B2 + Amount) ... </balances>
     <totalSupply> T </totalSupply>
requires B1 >= Amount
ensures T == T'  // ä¸å˜å¼ä¿æŒ
```

### 3.2 å·¥å…·é“¾

| å·¥å…· | æ–¹æ³• | å¯åˆ¤å®šæ€§ |
|------|------|----------|
| **Mythril** | ç¬¦å·æ‰§è¡Œ | ä¸å®Œå…¨ï¼ˆå¯èƒ½æ¼æŠ¥ï¼‰ |
| **Slither** | é™æ€åˆ†æ | å¯å‘å¼ï¼ˆè¯¯æŠ¥ï¼‰ |
| **Certora** | å½¢å¼åŒ–éªŒè¯ | ç‰¹å®šæ€§è´¨å¯åˆ¤å®š |
| **Kæ¡†æ¶** | è¯­ä¹‰å®šä¹‰ | å¯éªŒè¯ç‰¹å®šè§„åˆ™ |

---

## 4. å®è·µæ¡ˆä¾‹

### 4.1 Uniswap V3éªŒè¯

**éªŒè¯ç›®æ ‡**:

- æµåŠ¨æ€§ä¸å˜å¼: xÂ·y = k
- æ— æŠ¢è·‘æ”»å‡»ï¼ˆfront-runningï¼‰

**æ–¹æ³•**:

- å½¢å¼åŒ–æ ¸å¿ƒé€»è¾‘ï¼ˆç®€åŒ–æ¨¡å‹ï¼‰
- Coqè¯æ˜ä¸å˜å¼

**å±€é™**:

- åªèƒ½éªŒè¯**å»ºæ¨¡çš„**éƒ¨åˆ†
- å®é™…åˆçº¦æ›´å¤æ‚ï¼ˆä¸å¯å®Œå…¨éªŒè¯ï¼‰

### 4.2 The DAOäº‹ä»¶å¤ç›˜

**ç†è®ºåˆ†æ**:

- é‡å…¥æ”»å‡» = æ„å¤–çš„é€’å½’
- å½¢å¼åŒ–éªŒè¯å¯èƒ½æ£€æµ‹åˆ°ï¼ˆå¦‚æœåšäº†ï¼‰
- ä½†**å®Œç¾é˜²å¾¡**ä¸å¯èƒ½ï¼ˆRiceå®šç†ï¼‰

**æ•™è®­**:

- åˆ†å±‚é˜²å¾¡ï¼ˆChecks-Effects-Interactionsæ¨¡å¼ï¼‰
- å®¡è®¡ + å½¢å¼åŒ– + Bug Bounty

---

## 5. æœªæ¥æ–¹å‘

### 5.1 é›¶çŸ¥è¯†è¯æ˜åˆçº¦

**zk-SNARKs**: éªŒè¯è®¡ç®—è€Œä¸é€éœ²è¾“å…¥

**å¯è®¡ç®—æ€§**:

- éªŒè¯è¯æ˜ âˆˆ Pï¼ˆå¯åˆ¤å®šä¸”é«˜æ•ˆï¼ï¼‰
- ç”Ÿæˆè¯æ˜ âˆˆ NPï¼ˆå›°éš¾ä½†å¯è¡Œï¼‰

### 5.2 å½¢å¼åŒ–é©±åŠ¨å¼€å‘

**æ–°èŒƒå¼**:

1. ç”¨Coq/Leanå†™è§„èŒƒ
2. æå–Solidityä»£ç 
3. ä¿è¯æ­£ç¡®æ€§

**é™åˆ¶**: ä»…é™**å¯å½¢å¼åŒ–**çš„éƒ¨åˆ†

---

## 6. ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾

### 6.1 è®ºè¯ä¾èµ–å…³ç³»

```mermaid
graph TD
    A[åŒºå—é“¾ä¸æ™ºèƒ½åˆçº¦] --> B[é—®é¢˜æå‡º]
    B --> C[æ™ºèƒ½åˆçº¦çš„è®¡ç®—æ¨¡å‹]

    C --> D[å®šä¹‰å»ºç«‹]
    D --> D1[Solidityå›¾çµå®Œå¤‡]
    D --> D2[Gasæœºåˆ¶]

    D1 --> E[æ€§è´¨æ¢ç´¢]
    D2 --> E
    E --> E1[å›¾çµå®Œå¤‡çš„ä»£ä»·]
    E --> E2[å½¢å¼åŒ–éªŒè¯ç­–ç•¥]

    E1 --> F[è¯æ˜æ„é€ ]
    E2 --> F
    F --> F1[æ— æ³•é™æ€éªŒè¯]
    F --> F2[éªŒè¯ç‰¹å®šæ€§è´¨]

    F1 --> G[åº”ç”¨å±•ç¤º]
    F2 --> G
    G --> G1[å®è·µæ¡ˆä¾‹]
    G --> G2[æœªæ¥æ–¹å‘]

    G1 --> H[æ‰¹åˆ¤åæ€]
    G2 --> H
    H --> H1[å¯è®¡ç®—æ€§åˆ†æ]
    H --> H2[å›¾çµå®Œå¤‡æ€§]

    style A fill:#ffcccc
    style D fill:#ccffcc
    style F fill:#ccccff
    style H fill:#ffffcc
```

### 6.2 æ¦‚å¿µä¾èµ–å…³ç³»

```mermaid
graph LR
    A[æ™ºèƒ½åˆçº¦] --> B[å›¾çµå®Œå¤‡]

    B --> C[Gasæœºåˆ¶]
    B --> D[å½¢å¼åŒ–éªŒè¯]

    C --> E[å¯è®¡ç®—æ€§]
    D --> E

    E --> F[å®è·µæ¡ˆä¾‹]
    E --> G[é€’å½’ç†è®º]

    F --> H[åŒºå—é“¾åº”ç”¨]
    G --> H

    style A fill:#ffffcc
    style B fill:#ffcccc
    style E fill:#ccffcc
    style H fill:#ccccff
```

**è®ºè¯é€»è¾‘é“¾æ¡**ï¼š

1. **é—®é¢˜æå‡º** (1èŠ‚)ï¼š
   - æ™ºèƒ½åˆçº¦çš„è®¡ç®—æ¨¡å‹

2. **å®šä¹‰å»ºç«‹** (1.1-1.2èŠ‚)ï¼š
   - Solidityå›¾çµå®Œå¤‡å’ŒGasæœºåˆ¶

3. **æ€§è´¨æ¢ç´¢** (2-3èŠ‚)ï¼š
   - å›¾çµå®Œå¤‡çš„ä»£ä»·ï¼ˆ2èŠ‚ï¼‰
   - å½¢å¼åŒ–éªŒè¯ç­–ç•¥ï¼ˆ3èŠ‚ï¼‰

4. **è¯æ˜æ„é€ ** (2.1, 3.1-3.2èŠ‚)ï¼š
   - æ— æ³•é™æ€éªŒè¯å’ŒéªŒè¯ç‰¹å®šæ€§è´¨

5. **åº”ç”¨å±•ç¤º** (4-5èŠ‚)ï¼š
   - å®è·µæ¡ˆä¾‹ï¼ˆ4èŠ‚ï¼‰
   - æœªæ¥æ–¹å‘ï¼ˆ5èŠ‚ï¼‰

6. **æ‰¹åˆ¤åæ€** (è´¯ç©¿å…¨æ–‡)ï¼š
   - å¯è®¡ç®—æ€§åˆ†æ

---

## 7. å‚è€ƒèµ„æº

### 7.1 ç»å…¸è®ºæ–‡

1. **Wood, G.** (2014). "Ethereum: A Secure Decentralised Generalised Transaction Ledger"
   - Ethereum Yellow Paper
   - ä»¥å¤ªåŠæŠ€æœ¯è§„èŒƒ

2. **Buterin, V.** (2014). "A Next-Generation Smart Contract and Decentralized Application Platform"
   - Ethereum White Paper
   - ä»¥å¤ªåŠç™½çš®ä¹¦

3. **Bhargavan, K., et al.** (2016). "Formal Verification of Smart Contracts"
   - _PLAS 2016_. Proceedings of the 2016 ACM Workshop on Programming Languages and Analysis for Security
   - æ™ºèƒ½åˆçº¦å½¢å¼åŒ–éªŒè¯

### 7.2 æ•™æ

1. **Antonopoulos, A. M., & Wood, G.** (2018)
   - _Mastering Ethereum: Building Smart Contracts and DApps_
   - O'Reilly Media. ISBN 978-1491971949
   - ä»¥å¤ªåŠå¼€å‘æŒ‡å—

2. **Narayanan, A., et al.** (2016)
   - _Bitcoin and Cryptocurrency Technologies: A Comprehensive Introduction_
   - Princeton University Press. ISBN 978-0691171692
   - åŠ å¯†è´§å¸æŠ€æœ¯

### 7.3 åœ¨çº¿èµ„æº

1. **Ethereum**
   - https://ethereum.org/
   - ä»¥å¤ªåŠå®˜æ–¹ç½‘ç«™

2. **Solidity**
   - https://soliditylang.org/
   - Solidityç¼–ç¨‹è¯­è¨€

3. **Smart Contract**
   - https://en.wikipedia.org/wiki/Smart_contract
   - æ™ºèƒ½åˆçº¦åŸºæœ¬æ¦‚å¿µ

---

**æœ€åæ›´æ–°**: 2025-12-04
**çŠ¶æ€**: âœ… å·²æ·»åŠ ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾å’Œå‚è€ƒèµ„æºç« èŠ‚
**çŠ¶æ€**: åˆç¨¿å®Œæˆ
