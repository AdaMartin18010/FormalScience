# Hindley-Milnerç±»å‹æ¨å¯¼ç®—æ³•

> **ä¸»é¢˜**: ML/Haskellçš„è‡ªåŠ¨ç±»å‹æ¨å¯¼æœºåˆ¶
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-02
> **éš¾åº¦**: â­â­â­â­
> **å‰ç½®çŸ¥è¯†**: Lambdaæ¼”ç®—ã€ç±»å‹ç†è®ºã€åˆä¸€ç®—æ³•

---

## ğŸ“‹ ç›®å½•

- [Hindley-Milnerç±»å‹æ¨å¯¼ç®—æ³•](#hindley-milnerç±»å‹æ¨å¯¼ç®—æ³•)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. ç®€å•ç±»å‹Lambdaæ¼”ç®—å›é¡¾](#1-ç®€å•ç±»å‹lambdaæ¼”ç®—å›é¡¾)
    - [1.1 ç±»å‹è§„åˆ™](#11-ç±»å‹è§„åˆ™)
    - [1.2 ç±»å‹æ¨å¯¼vsæ£€æŸ¥](#12-ç±»å‹æ¨å¯¼vsæ£€æŸ¥)
  - [2. Hindley-Milnerç®—æ³•](#2-hindley-milnerç®—æ³•)
    - [2.1 ç®—æ³•æµç¨‹](#21-ç®—æ³•æµç¨‹)
    - [2.2 çº¦æŸç”Ÿæˆ](#22-çº¦æŸç”Ÿæˆ)
    - [2.3 åˆä¸€ç®—æ³•](#23-åˆä¸€ç®—æ³•)
  - [3. let-å¤šæ€](#3-let-å¤šæ€)
    - [3.1 æ³›åŒ–è§„åˆ™](#31-æ³›åŒ–è§„åˆ™)
    - [3.2 å®ä¾‹åŒ–](#32-å®ä¾‹åŒ–)
  - [4. å¤æ‚åº¦åˆ†æ](#4-å¤æ‚åº¦åˆ†æ)
  - [5. å®è·µæ¡ˆä¾‹](#5-å®è·µæ¡ˆä¾‹)
    - [5.1 Haskellç±»å‹æ¨å¯¼](#51-haskellç±»å‹æ¨å¯¼)
    - [5.2 OCamlç±»å‹æ¨å¯¼](#52-ocamlç±»å‹æ¨å¯¼)
  - [6. é€’å½’ç†è®ºæ„ä¹‰](#6-é€’å½’ç†è®ºæ„ä¹‰)
  - [7. ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾](#7-ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾)
    - [7.1 è®ºè¯ä¾èµ–å…³ç³»](#71-è®ºè¯ä¾èµ–å…³ç³»)
    - [7.2 æ¦‚å¿µä¾èµ–å…³ç³»](#72-æ¦‚å¿µä¾èµ–å…³ç³»)
  - [8. å‚è€ƒèµ„æº](#8-å‚è€ƒèµ„æº)
    - [8.1 ç»å…¸è®ºæ–‡](#81-ç»å…¸è®ºæ–‡)
    - [8.2 æ•™æ](#82-æ•™æ)
    - [8.3 åœ¨çº¿èµ„æº](#83-åœ¨çº¿èµ„æº)

---

## 1. ç®€å•ç±»å‹Lambdaæ¼”ç®—å›é¡¾

### 1.1 ç±»å‹è§„åˆ™

```text
ç±»å‹:
Ï„ ::= Î± | Ï„â‚ â†’ Ï„â‚‚

ç±»å‹è§„åˆ™:
Î“ âŠ¢ x : Î“(x)                    (Var)
Î“, x:Ï„â‚ âŠ¢ e:Ï„â‚‚ â‡’ Î“ âŠ¢ Î»x.e : Ï„â‚â†’Ï„â‚‚  (Abs)
Î“âŠ¢eâ‚:Ï„â‚â†’Ï„â‚‚, Î“âŠ¢eâ‚‚:Ï„â‚ â‡’ Î“âŠ¢eâ‚ eâ‚‚:Ï„â‚‚  (App)
```

---

### 1.2 ç±»å‹æ¨å¯¼vsæ£€æŸ¥

```text
ç±»å‹æ£€æŸ¥:
è¾“å…¥: e, Ï„
è¾“å‡º: e:Ï„? (æ˜¯/å¦)
å¤æ‚åº¦: O(n) âœ“

ç±»å‹æ¨å¯¼:
è¾“å…¥: e
è¾“å‡º: Ï„ (æœ€ä¸€èˆ¬ç±»å‹)
å¤æ‚åº¦: ?

HMç®—æ³•: O(n) (å‡ ä¹çº¿æ€§!) â­â­â­â­â­
```

---

## 2. Hindley-Milnerç®—æ³•

### 2.1 ç®—æ³•æµç¨‹

```text
æ­¥éª¤:
1. ç”Ÿæˆç±»å‹å˜é‡
   ä¸ºæ¯ä¸ªå­è¡¨è¾¾å¼åˆ†é…Î±_i

2. ç”Ÿæˆçº¦æŸ
   æ ¹æ®ç±»å‹è§„åˆ™ç”Ÿæˆç­‰å¼

3. åˆä¸€ (Unification)
   æ±‚è§£çº¦æŸç³»ç»Ÿ

4. æ›¿æ¢
   åº”ç”¨è§£åˆ°ç±»å‹å˜é‡

ç¤ºä¾‹:
let id = Î»x. x in id 5
```

---

### 2.2 çº¦æŸç”Ÿæˆ

**ç¤ºä¾‹æ¨å¯¼**:

```text
è¡¨è¾¾å¼: Î»x. x x

æ­¥éª¤:
1. Î»x. x x : Î± (ç›®æ ‡ç±»å‹)
2. x : Î² (å‡è®¾)
3. x x : Î³ (åº”ç”¨ç»“æœ)

çº¦æŸ:
- ç¬¬ä¸€ä¸ªx: Î²
- ç¬¬äºŒä¸ªx: Î²
- åº”ç”¨: Î² = Î² â†’ Î³
- æ•´ä½“: Î± = Î² â†’ Î³

é—®é¢˜:
Î² = Î² â†’ Î³ (é€’å½’çº¦æŸ!)
â†’ æ— ç©·ç±»å‹ âœ—
â†’ MLæ‹’ç»æ­¤ç¨‹åº âœ“

å‘ç”Ÿæ£€æŸ¥ (Occurs check):
Î²å‡ºç°åœ¨Î²â†’Î³ä¸­
â†’ æ‹’ç» âœ“
```

---

### 2.3 åˆä¸€ç®—æ³•

**Robinsonåˆä¸€ (1965)**:

```text
Unify(Ï„â‚, Ï„â‚‚):
  if Ï„â‚ = Ï„â‚‚: return âˆ…
  if Ï„â‚ = Î±: return [Î± := Ï„â‚‚]
  if Ï„â‚‚ = Î±: return [Î± := Ï„â‚]
  if Ï„â‚ = Ïƒâ‚â†’Ïƒâ‚‚, Ï„â‚‚ = Ïƒâ‚ƒâ†’Ïƒâ‚„:
    Î¸â‚ = Unify(Ïƒâ‚, Ïƒâ‚ƒ)
    Î¸â‚‚ = Unify(Î¸â‚(Ïƒâ‚‚), Î¸â‚(Ïƒâ‚„))
    return Î¸â‚‚ âˆ˜ Î¸â‚
  else: fail

å¤æ‚åº¦: O(n log n) (å‡ ä¹çº¿æ€§)

é€’å½’æ€§è´¨:
âœ“ åˆä¸€é€’å½’å®šä¹‰
âœ“ å¿…ç»ˆæ­¢ (ç»“æ„é€’å½’)
```

---

## 3. let-å¤šæ€

### 3.1 æ³›åŒ–è§„åˆ™

```text
let x = eâ‚ in eâ‚‚

è§„åˆ™:
Î“ âŠ¢ eâ‚ : Ï„
âˆ€Î± âˆ‰ FV(Î“): Î“, x:âˆ€Î±.Ï„ âŠ¢ eâ‚‚ : Ïƒ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Î“ âŠ¢ let x=eâ‚ in eâ‚‚ : Ïƒ

æ³›åŒ–: Ï„ â†’ âˆ€Î±.Ï„
â†’ å¤šæ€ç±»å‹ âœ“

ä¾‹å­:
let id = Î»x.x in (id 5, id true)
- idè¢«æ³›åŒ–ä¸º âˆ€Î±. Î±â†’Î±
- ä¸¤æ¬¡å®ä¾‹åŒ–: Intâ†’Int, Boolâ†’Bool
```

---

### 3.2 å®ä¾‹åŒ–

```text
å®ä¾‹åŒ–: âˆ€Î±.Ï„ â†’ Ï„[Î± := Ï„']

HMè§„åˆ™:
letç»‘å®š: å¯æ³›åŒ–/å®ä¾‹åŒ– âœ“
Î»ç»‘å®š: ä¸æ³›åŒ– âœ—

åŸå› :
let: å€¼é™åˆ¶ (value restriction)
Î»: å¯èƒ½å‰¯ä½œç”¨

é€’å½’æ€§è´¨:
âœ“ æ³›åŒ–/å®ä¾‹åŒ–é€’å½’åº”ç”¨
âœ“ ç±»å‹å±‚æ¬¡é€’å½’
```

---

## 4. å¤æ‚åº¦åˆ†æ

```text
HMç®—æ³•å¤æ‚åº¦:

ç†è®º:
- æœ€å: O(n log n) (åˆä¸€)
- å®è·µ: O(n) (å‡ ä¹çº¿æ€§) â­

vs System F:
System F: ä¸å¯åˆ¤å®š âœ—
HM: O(n) âœ“
â†’ å¯åˆ¤å®šæ€§çš„èƒœåˆ©

ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«?
âœ“ let-å¤šæ€ (éå…¨ç§°é‡åŒ–)
âœ“ ç®€å•ç»“æ„
âœ“ æ— ä¾èµ–ç±»å‹
â†’ å®ç”¨æ€§æœ€ä¼˜ â­â­â­â­â­
```

---

## 5. å®è·µæ¡ˆä¾‹

### 5.1 Haskellç±»å‹æ¨å¯¼

```text
ä¾‹å­:
map f [] = []
map f (x:xs) = f x : map f xs

æ¨å¯¼:
1. f : Î± â†’ Î²
2. [] : [Î³]
3. x : Î³
4. xs : [Î³]
5. f x : Î²
6. map f xs : [Î²]
7. map : (Î±â†’Î²) â†’ [Î±] â†’ [Î²]

æ³›åŒ–:
map : âˆ€Î± Î². (Î±â†’Î²) â†’ [Î±] â†’ [Î²] âœ“

æ— éœ€ç±»å‹æ ‡æ³¨! â­
```

---

### 5.2 OCamlç±»å‹æ¨å¯¼

```text
let rec fact n =
  if n = 0 then 1
  else n * fact (n-1)

æ¨å¯¼:
1. n : int (ä»n=0æ¨å‡º)
2. 1 : int
3. n * ... : int
4. fact : int â†’ int âœ“

é€’å½’:
let recå…è®¸é€’å½’å®šä¹‰
ç±»å‹æ¨å¯¼æ­£ç¡®å¤„ç† âœ“
```

---

## 6. é€’å½’ç†è®ºæ„ä¹‰

```text
HMç®—æ³• = é€’å½’+åˆä¸€

é€’å½’æ€§è´¨:
âœ“ çº¦æŸç”Ÿæˆé€’å½’
âœ“ åˆä¸€ç®—æ³•é€’å½’
âœ“ ç±»å‹æ›¿æ¢é€’å½’

å¯åˆ¤å®šæ€§:
âœ“ HM: O(n)å¯åˆ¤å®š â­
âœ— System F: ä¸å¯åˆ¤å®š
â†’ è¡¨è¾¾åŠ›ä¸å¯åˆ¤å®šæ€§æƒè¡¡

å†å²åœ°ä½:
1969: Hindley
1978: Milner (ç‹¬ç«‹)
1982: Damas-Milner (å®Œæ•´)
â†’ ML/Haskellæ ¸å¿ƒ â­â­â­â­â­

é€’å½’ç†è®º:
âœ“ HM âˆˆ P âŠ‚ RE
âœ“ ç±»å‹æ¨å¯¼å¯é€’å½’é«˜æ•ˆ
â†’ é€’å½’ç†è®ºçš„å®è·µèƒœåˆ©
```

---

## 7. ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾

### 7.1 è®ºè¯ä¾èµ–å…³ç³»

```mermaid
graph TD
    A[HMç±»å‹æ¨å¯¼] --> B[é—®é¢˜æå‡º]
    B --> C[ç®€å•ç±»å‹Lambdaæ¼”ç®—]

    C --> D[å®šä¹‰å»ºç«‹]
    D --> D1[ç±»å‹è§„åˆ™]
    D --> D2[ç±»å‹æ¨å¯¼vsæ£€æŸ¥]

    D1 --> E[æ€§è´¨æ¢ç´¢]
    D2 --> E
    E --> E1[Hindley-Milnerç®—æ³•]
    E --> E2[let-å¤šæ€]

    E1 --> F[è¯æ˜æ„é€ ]
    E2 --> F
    F --> F1[çº¦æŸç”Ÿæˆ]
    F --> F2[åˆä¸€ç®—æ³•]

    F1 --> G[åº”ç”¨å±•ç¤º]
    F2 --> G
    G --> G1[å¤æ‚åº¦åˆ†æ]
    G --> G2[å®è·µæ¡ˆä¾‹]

    G1 --> H[æ‰¹åˆ¤åæ€]
    G2 --> H
    H --> H1[é€’å½’ç†è®ºæ„ä¹‰]
    H --> H2[ç®—æ³•æ•ˆç‡]

    style A fill:#ffcccc
    style D fill:#ccffcc
    style F fill:#ccccff
    style H fill:#ffffcc
```

### 7.2 æ¦‚å¿µä¾èµ–å…³ç³»

```mermaid
graph LR
    A[HMç®—æ³•] --> B[ç±»å‹æ¨å¯¼]

    B --> C[çº¦æŸç”Ÿæˆ]
    B --> D[åˆä¸€ç®—æ³•]

    C --> E[let-å¤šæ€]
    D --> E

    E --> F[å¤æ‚åº¦]
    E --> G[å®è·µåº”ç”¨]

    F --> H[é€’å½’ç†è®º]
    G --> H

    H --> I[å¯åˆ¤å®šæ€§]
    H --> J[ç®—æ³•æ•ˆç‡]

    style A fill:#ffffcc
    style B fill:#ffcccc
    style E fill:#ccffcc
    style H fill:#ccccff
```

**è®ºè¯é€»è¾‘é“¾æ¡**ï¼š

1. **é—®é¢˜æå‡º** (1èŠ‚)ï¼š
   - ç®€å•ç±»å‹Lambdaæ¼”ç®—å›é¡¾

2. **å®šä¹‰å»ºç«‹** (1.1-1.2èŠ‚)ï¼š
   - ç±»å‹è§„åˆ™å’Œç±»å‹æ¨å¯¼vsæ£€æŸ¥

3. **æ€§è´¨æ¢ç´¢** (2-3èŠ‚)ï¼š
   - Hindley-Milnerç®—æ³•ï¼ˆ2èŠ‚ï¼‰
   - let-å¤šæ€ï¼ˆ3èŠ‚ï¼‰

4. **è¯æ˜æ„é€ ** (2.2-2.3èŠ‚)ï¼š
   - çº¦æŸç”Ÿæˆå’Œåˆä¸€ç®—æ³•

5. **åº”ç”¨å±•ç¤º** (4-5èŠ‚)ï¼š
   - å¤æ‚åº¦åˆ†æï¼ˆ4èŠ‚ï¼‰
   - å®è·µæ¡ˆä¾‹ï¼ˆ5èŠ‚ï¼‰

6. **æ‰¹åˆ¤åæ€** (6èŠ‚)ï¼š
   - é€’å½’ç†è®ºæ„ä¹‰

---

## 8. å‚è€ƒèµ„æº

### 8.1 ç»å…¸è®ºæ–‡

1. **Damas, L., & Milner, R.** (1982). "Principal type-schemes for functional programs"
   - _POPL 1982_. Proceedings of the 9th ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages
   - HMç®—æ³•å®Œæ•´è¯æ˜ â­â­â­â­â­

2. **Hindley, J. R.** (1969). "The Principal Type-Scheme of an Object in Combinatory Logic"
   - _Transactions of the American Mathematical Society_, 146, 29-60
   - HindleyåŸå§‹ç®—æ³•

3. **Heeren, B., Hage, J., & Swierstra, S. D.** (2002). "Generalizing Hindley-Milner Type Inference Algorithms"
   - Technical Report UU-CS-2002-031, Utrecht University
   - HMç®—æ³•ç°ä»£æ”¹è¿›

### 8.2 æ•™æ

1. **Pierce, B. C.** (2002)
   - _Types and Programming Languages_
   - MIT Press. ISBN 978-0262162098
   - ç¬¬22ç« ï¼šç±»å‹é‡æ„ï¼ˆHMç®—æ³•ï¼‰

2. **Mitchell, J. C.** (1996)
   - _Foundations for Programming Languages_
   - MIT Press. ISBN 978-0262133210
   - ç±»å‹ç³»ç»ŸåŸºç¡€

### 8.3 åœ¨çº¿èµ„æº

1. **Wikipedia - Hindley-Milner type system**
   - https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system
   - HMç±»å‹ç³»ç»ŸåŸºæœ¬æ¦‚å¿µ

2. **OCaml Type System**
   - https://ocaml.org/manual/types.html
   - OCamlç±»å‹ç³»ç»Ÿæ–‡æ¡£

3. **Haskell Type System**
   - https://www.haskell.org/documentation/
   - Haskellç±»å‹ç³»ç»Ÿæ–‡æ¡£

---

**æœ€åæ›´æ–°**: 2025-12-04
**Tier**: 1-2 (ç†è®º+å·¥ç¨‹)
**é‡è¦æ€§**: å‡½æ•°å¼è¯­è¨€æ ¸å¿ƒ â­â­â­â­â­
**å¤æ‚åº¦**: O(n) ä¼˜ç§€ âœ“
**çŠ¶æ€**: âœ… å·²æ·»åŠ ä¸»é¢˜-å­ä¸»é¢˜è®ºè¯é€»è¾‘å…³ç³»å›¾å’Œå‚è€ƒèµ„æºç« èŠ‚
