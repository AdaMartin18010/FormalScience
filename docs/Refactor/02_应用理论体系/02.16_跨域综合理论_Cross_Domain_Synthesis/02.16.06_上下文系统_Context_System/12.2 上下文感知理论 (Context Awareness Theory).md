# 12.2 ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç†è®º (Context Awareness Theory)

## ğŸ“‹ ç›®å½•

- [1 æ ¸å¿ƒæ¦‚å¿µ (Core Concepts)](#1-æ ¸å¿ƒæ¦‚å¿µ-core-concepts)
  - [1.1 ä¸Šä¸‹æ–‡çš„åˆ†ç±» (Categories of Context)](#11-ä¸Šä¸‹æ–‡çš„åˆ†ç±»-categories-of-context)
- [2 ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿçš„æ¶æ„ (Architectures for Context-Aware Systems)](#2-ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿçš„æ¶æ„-architectures-for-context-aware-systems)
- [3 å…³é”®æŒ‘æˆ˜ (Key Challenges)](#3-å…³é”®æŒ‘æˆ˜-key-challenges)
- [4 å½¢å¼åŒ–æ¨¡å‹ (Formal Models)](#4-å½¢å¼åŒ–æ¨¡å‹-formal-models)
- [5 Rust ä»£ç ç¤ºä¾‹ï¼šæ¦‚å¿µæ€§çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥åº”ç”¨](#5-rust-ä»£ç ç¤ºä¾‹æ¦‚å¿µæ€§çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥åº”ç”¨)
- [6 ç»“è®º](#6-ç»“è®º)
- [7 æ‰¹åˆ¤æ€§åˆ†æ](#7-æ‰¹åˆ¤æ€§åˆ†æ)

---

## 1 æ ¸å¿ƒæ¦‚å¿µ (Core Concepts)

**ä¸Šä¸‹æ–‡æ„ŸçŸ¥è®¡ç®— (Context-Aware Computing)** æ˜¯æ™®é€‚è®¡ç®— (Ubiquitous Computing) çš„ä¸€ä¸ªæ ¸å¿ƒåˆ†æ”¯ï¼Œå®ƒæŒ‡çš„æ˜¯ç³»ç»Ÿèƒ½å¤Ÿè·å–ã€è§£é‡Šå’Œä½¿ç”¨å…³äºå…¶ç¯å¢ƒçš„ä¿¡æ¯ï¼ˆå³**ä¸Šä¸‹æ–‡**ï¼‰ï¼Œå¹¶æ ¹æ®è¿™äº›ä¿¡æ¯æ¥åŠ¨æ€åœ°è°ƒæ•´å…¶è¡Œä¸ºã€‚

ä¸€ä¸ªè¢«å¹¿æ³›æ¥å—çš„ä¸Šä¸‹æ–‡å®šä¹‰ç”± Anind K. Dey æå‡ºï¼š
> **ä¸Šä¸‹æ–‡ (Context)** æ˜¯æŒ‡ä»»ä½•å¯ç”¨äºæè¿°å®ä½“ï¼ˆäººã€åœ°ç‚¹æˆ–å¯¹è±¡ï¼‰æƒ…å†µçš„ä¿¡æ¯ã€‚å®ä½“è¢«è®¤ä¸ºæ˜¯ä¸ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºäº¤äº’ç›¸å…³çš„ï¼ŒåŒ…æ‹¬ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºæœ¬èº«ã€‚

ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„ç›®æ ‡æ˜¯ä½¿è®¡ç®—è®¾å¤‡æ›´åŠ æ™ºèƒ½ã€æ›´å…·é€‚åº”æ€§ï¼Œèƒ½å¤Ÿæ— ç¼åœ°èå…¥ç”¨æˆ·çš„æ—¥å¸¸ç”Ÿæ´»ï¼Œæä¾›ä¸»åŠ¨ã€ä¸ªæ€§åŒ–å’Œé«˜æ•ˆçš„æœåŠ¡ã€‚

### 1.1 ä¸Šä¸‹æ–‡çš„åˆ†ç±» (Categories of Context)

ä¸Šä¸‹æ–‡ä¿¡æ¯å¯ä»¥è¢«åˆ†ä¸ºå‡ å¤§ç±»ï¼š

1. **ç‰©ç†ä¸Šä¸‹æ–‡ (Physical Context)**:
    - **ä½ç½® (Location)**: ç»å¯¹ä½ç½®ï¼ˆGPSåæ ‡ï¼‰ã€ç›¸å¯¹ä½ç½®ï¼ˆåœ¨æŸä¸ªæˆ¿é—´å†…ï¼‰ã€é‚»è¿‘æ€§ã€‚
    - **ç¯å¢ƒ (Environment)**: å…‰ç…§ã€å™ªéŸ³æ°´å¹³ã€æ¸©åº¦ã€ç½‘ç»œè¿æ¥çŠ¶å†µã€‚
    - **èµ„æº (Resources)**: é™„è¿‘çš„è®¾å¤‡ã€å¯ç”¨çš„è®¡ç®—èµ„æºã€ç”µæ± ç”µé‡ã€‚

2. **ç”¨æˆ·ä¸Šä¸‹æ–‡ (User Context)**:
    - **èº«ä»½ (Identity)**: ç”¨æˆ·æ˜¯è°ï¼Œå…¶è§’è‰²å’Œæƒé™ã€‚
    - **æ´»åŠ¨ (Activity)**: ç”¨æˆ·æ­£åœ¨åšä»€ä¹ˆï¼ˆå¦‚å¼€è½¦ã€å¼€ä¼šã€è·‘æ­¥ï¼‰ã€‚
    - **ç”Ÿç†çŠ¶æ€ (Physiological State)**: å¿ƒç‡ã€æƒ…ç»ªã€ä½“æ¸©ã€‚
    - **ç¤¾äº¤æƒ…å¢ƒ (Social Situation)**: ç”¨æˆ·æ˜¯ç‹¬å¤„ã€ä¸æœ‹å‹åœ¨ä¸€èµ·è¿˜æ˜¯åœ¨å…¬å¼€åœºåˆã€‚

3. **ç³»ç»Ÿä¸Šä¸‹æ–‡ (System Context)**:
    - è®¾å¤‡çŠ¶æ€ã€ç½‘ç»œå¸¦å®½ã€å±å¹•å°ºå¯¸ã€ç³»ç»Ÿè´Ÿè½½ã€‚

4. **æ—¶é—´ä¸Šä¸‹æ–‡ (Temporal Context)**:
    - ä¸€å¤©ä¸­çš„æ—¶é—´ã€æ˜ŸæœŸå‡ ã€å¹´ä»½ã€å­£èŠ‚ã€‚

## 2 ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿçš„æ¶æ„ (Architectures for Context-Aware Systems)

æ„å»ºä¸€ä¸ªä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿé€šå¸¸æ¶‰åŠä»¥ä¸‹å‡ ä¸ªå…³é”®ç»„ä»¶ï¼š

1. **ä¸Šä¸‹æ–‡è·å– (Context Acquisition)**:
    - **ç‰©ç†ä¼ æ„Ÿå™¨**: GPSã€éº¦å…‹é£ã€æ‘„åƒå¤´ã€åŠ é€Ÿè®¡ã€æ¸©åº¦è®¡ã€‚
    - **è™šæ‹Ÿä¼ æ„Ÿå™¨**: æ—¥å†åº”ç”¨ã€ç”¨æˆ·ä¸ªäººèµ„æ–™ã€ç½‘ç»œæ•°æ®ã€‚
    - **é€»è¾‘ä¼ æ„Ÿå™¨**: é€šè¿‡èšåˆæ¥è‡ªå¤šä¸ªä¼ æ„Ÿå™¨çš„åŸå§‹æ•°æ®æ¥æ¨æ–­å‡ºæ›´é«˜çº§åˆ«çš„ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ï¼Œä»åŠ é€Ÿè®¡æ•°æ®æ¨æ–­å‡ºç”¨æˆ·æ­£åœ¨è·‘æ­¥ï¼‰ã€‚

2. **ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸å»ºæ¨¡ (Context Representation and Modeling)**:
    - å¦‚ä½•å­˜å‚¨å’Œç»„ç»‡ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚å¸¸ç”¨æ¨¡å‹åŒ…æ‹¬ï¼š
        - **é”®å€¼å¯¹æ¨¡å‹ (Key-Value Models)**: ç®€å•ï¼Œä½†è¡¨è¾¾èƒ½åŠ›æœ‰é™ã€‚
        - **é¢å‘å¯¹è±¡æ¨¡å‹ (Object-Oriented Models)**: å°†ä¸Šä¸‹æ–‡ä¿¡æ¯å°è£…åœ¨å¯¹è±¡ä¸­ã€‚
        - **æœ¬ä½“è®ºæ¨¡å‹ (Ontology-based Models)**: ä½¿ç”¨æœ¬ä½“ï¼ˆå¦‚ OWLï¼‰æ¥å½¢å¼åŒ–åœ°å®šä¹‰ä¸Šä¸‹æ–‡çš„è¯æ±‡ã€å±æ€§å’Œå…³ç³»ï¼Œå…·æœ‰å¾ˆå¼ºçš„è¡¨è¾¾èƒ½åŠ›å’Œæ¨ç†èƒ½åŠ›ã€‚

3. **ä¸Šä¸‹æ–‡æ¨ç† (Context Reasoning)**:
    - ä»åŸå§‹çš„ã€ä¸å®Œæ•´çš„ä¸Šä¸‹æ–‡æ•°æ®ä¸­æ¨æ–­å‡ºæ›´é«˜çº§ã€æ›´æœ‰æ„ä¹‰çš„ä¿¡æ¯ã€‚
    - **æŠ€æœ¯**: è§„åˆ™å¼•æ“ã€æ¨¡ç³Šé€»è¾‘ã€æ¦‚ç‡æ–¹æ³•ï¼ˆå¦‚è´å¶æ–¯ç½‘ç»œï¼‰ã€æœºå™¨å­¦ä¹ ã€‚

4. **ä¸Šä¸‹æ–‡åˆ†å‘ä¸ä½¿ç”¨ (Context Distribution and Usage)**:
    - å°†å¤„ç†å’Œæ¨ç†åçš„ä¸Šä¸‹æ–‡ä¿¡æ¯å®‰å…¨ã€é«˜æ•ˆåœ°ä¼ é€’ç»™éœ€è¦å®ƒçš„åº”ç”¨ç¨‹åºã€‚
    - åº”ç”¨ç¨‹åºæ ¹æ®æ¥æ”¶åˆ°çš„ä¸Šä¸‹æ–‡æ¥è°ƒæ•´å…¶è¡Œä¸ºï¼Œä¾‹å¦‚ï¼š
        - ä¸€ä¸ªåœ¨ä¼šè®®å®¤é‡Œå“èµ·çš„æ‰‹æœºä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°é™éŸ³æ¨¡å¼ã€‚
        - ä¸€ä¸ªåœ°å›¾åº”ç”¨åœ¨æ£€æµ‹åˆ°ç”¨æˆ·æ­£åœ¨é©¾é©¶æ—¶ï¼Œä¼šåˆ‡æ¢åˆ°å¯¼èˆªæ¨¡å¼ã€‚

## 3 å…³é”®æŒ‘æˆ˜ (Key Challenges)

- **ä¸Šä¸‹æ–‡çš„æ¨¡ç³Šæ€§ä¸ä¸ç¡®å®šæ€§ (Ambiguity and Uncertainty)**: ä¼ æ„Ÿå™¨æ•°æ®å¾€å¾€æ˜¯ä¸ç²¾ç¡®å’Œæœ‰å™ªå£°çš„ã€‚
- **éšç§é—®é¢˜ (Privacy Concerns)**: ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿéœ€è¦æ”¶é›†å¤§é‡ä¸ªäººæ•°æ®ï¼Œå¦‚ä½•ä¿æŠ¤ç”¨æˆ·éšç§æ˜¯ä¸€ä¸ªæ ¸å¿ƒæŒ‘æˆ˜ã€‚
- **å¯æ‰©å±•æ€§ (Scalability)**: ç³»ç»Ÿéœ€è¦èƒ½å¤„ç†æ¥è‡ªå¤§é‡ä¼ æ„Ÿå™¨å’Œç”¨æˆ·çš„æ•°æ®ã€‚
- **ä¸Šä¸‹æ–‡çš„åŠ¨æ€æ€§ (Dynamic Nature of Context)**: ä¸Šä¸‹æ–‡æ˜¯ä¸æ–­å˜åŒ–çš„ï¼Œç³»ç»Ÿå¿…é¡»èƒ½å¤Ÿå®æ—¶åœ°é€‚åº”è¿™äº›å˜åŒ–ã€‚

## 4 å½¢å¼åŒ–æ¨¡å‹ (Formal Models)

ä½¿ç”¨å½¢å¼åŒ–æ–¹æ³•ï¼Œå¦‚**æœ¬ä½“è®º (Ontology)** æˆ–**æ—¶åºé€»è¾‘ (Temporal Logic)**ï¼Œå¯ä»¥å¸®åŠ©ç²¾ç¡®åœ°å®šä¹‰ä¸Šä¸‹æ–‡åŠå…¶å…³ç³»ï¼Œå¹¶å¯¹ç³»ç»Ÿçš„è¡Œä¸ºè¿›è¡Œæ¨ç†å’ŒéªŒè¯ã€‚

ä¾‹å¦‚ï¼Œä½¿ç”¨æœ¬ä½“è®ºï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ï¼š

- **ç±» (Classes)**: `Person`, `Location`, `Activity`
- **å±æ€§ (Properties)**: `hasLocation(Person, Location)`, `isEngagedIn(Person, Activity)`
- **è§„åˆ™ (Rules)**: `isEngagedIn(p, Meeting) AND hasLocation(p, Office) -> setPhoneMode(p, Silent)`

è¿™ä¸ºä¸Šä¸‹æ–‡æ¨ç†æä¾›äº†åšå®çš„é€»è¾‘åŸºç¡€ã€‚

## 5 Rust ä»£ç ç¤ºä¾‹ï¼šæ¦‚å¿µæ€§çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥åº”ç”¨

ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†ä¸€ä¸ªéå¸¸ç®€å•çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿã€‚å®ƒæ ¹æ®ä¸€å¤©ä¸­çš„ä¸åŒæ—¶é—´ï¼ˆæ—¶é—´ä¸Šä¸‹æ–‡ï¼‰å’Œæ¨¡æ‹Ÿçš„ä½ç½®å˜åŒ–ï¼ˆä½ç½®ä¸Šä¸‹æ–‡ï¼‰æ¥æ”¹å˜å…¶è¡Œä¸ºã€‚

```rust
use std::collections::HashMap;

// 1. å®šä¹‰ä¸Šä¸‹æ–‡ç±»å‹
#[derive(Debug, PartialEq, Eq, Hash, Clone)]
pub enum ContextType {
    TimeOfDay,
    Location,
}

#[derive(Debug, Clone, PartialEq, Eq)]
pub enum ContextValue {
    Time(String),
    Location(String),
}

// 2. ä¸Šä¸‹æ–‡ç®¡ç†å™¨
pub struct ContextManager {
    context_data: HashMap<ContextType, ContextValue>,
}

impl ContextManager {
    pub fn new() -> Self {
        ContextManager {
            context_data: HashMap::new(),
        }
    }

    pub fn update_context(&mut self, c_type: ContextType, c_value: ContextValue) {
        println!("[ContextManager] ä¸Šä¸‹æ–‡æ›´æ–°: {:?} -> {:?}", c_type, c_value);
        self.context_data.insert(c_type, c_value);
    }

    pub fn get_context(&self, c_type: &ContextType) -> Option<&ContextValue> {
        self.context_data.get(c_type)
    }
}

// 3. ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„åº”ç”¨ç¨‹åº
pub struct SmartAssistant {
    name: String,
}

impl SmartAssistant {
    pub fn new(name: &str) -> Self {
        SmartAssistant { name: name.to_string() }
    }

    // åº”ç”¨æ ¹æ®ä¸Šä¸‹æ–‡åšå‡ºååº”
    pub fn perform_action(&self, context: &ContextManager) {
        println!("\n--- {} å¼€å§‹å†³ç­– ---", self.name);
        
        // åŸºäºæ—¶é—´å’Œä½ç½®çš„å†³ç­–
        let time = context.get_context(&ContextType::TimeOfDay);
        let location = context.get_context(&ContextType::Location);

        match (time, location) {
            (Some(ContextValue::Time(t)), Some(ContextValue::Location(l))) => {
                if l == "Home" {
                    if t == "Morning" {
                        println!("åŠ¨ä½œ: æ—©ä¸Šå¥½ï¼ä¸ºæ‚¨æ’­æ”¾æ™¨é—´æ–°é—»ã€‚");
                    } else if t == "Night" {
                        println!("åŠ¨ä½œ: æ™šå®‰ã€‚å°†ç¯å…‰è°ƒæš—ï¼Œå¹¶è®¾ç½®æ˜æ—©çš„é—¹é’Ÿã€‚");
                    } else {
                        println!("åŠ¨ä½œ: æ¬¢è¿å›å®¶ï¼");
                    }
                } else if l == "Office" {
                    if t == "Morning" {
                        println!("åŠ¨ä½œ: æ—©ä¸Šå¥½ï¼ä¸ºæ‚¨æ˜¾ç¤ºä»Šå¤©çš„ä¼šè®®æ—¥ç¨‹ã€‚");
                    } else {
                        println!("åŠ¨ä½œ: åŠªåŠ›å·¥ä½œä¸­ï¼å°†æ‰‹æœºè®¾ä¸ºå‹¿æ‰°æ¨¡å¼ã€‚");
                    }
                } else {
                    println!("åŠ¨ä½œ: åœ¨æœªçŸ¥åœ°ç‚¹ {}ï¼Œä¿æŒè­¦æƒ•ã€‚", l);
                }
            },
            _ => {
                println!("åŠ¨ä½œ: æ— æ³•è·å–è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ‰§è¡Œé»˜è®¤æ“ä½œã€‚");
            }
        }
    }
}


fn main() {
    let mut context_manager = ContextManager::new();
    let assistant = SmartAssistant::new("Friday");

    // åœºæ™¯1: æ—©ä¸Šåœ¨å®¶
    context_manager.update_context(ContextType::TimeOfDay, ContextValue::Time("Morning".to_string()));
    context_manager.update_context(ContextType::Location, ContextValue::Location("Home".to_string()));
    assistant.perform_action(&context_manager);

    // åœºæ™¯2: æ—©ä¸Šåœ¨åŠå…¬å®¤
    context_manager.update_context(ContextType::Location, ContextValue::Location("Office".to_string()));
    assistant.perform_action(&context_manager);
    
    // åœºæ™¯3: æ™šä¸Šå›å®¶
    context_manager.update_context(ContextType::TimeOfDay, ContextValue::Time("Night".to_string()));
    context_manager.update_context(ContextType::Location, ContextValue::Location("Home".to_string()));
    assistant.perform_action(&context_manager);
}
```

## 6 ç»“è®º

ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç†è®ºä¸ºæˆ‘ä»¬æ„å»ºä¸‹ä¸€ä»£æ™ºèƒ½åº”ç”¨å’ŒæœåŠ¡æä¾›äº†ç†è®ºæ¡†æ¶ã€‚é€šè¿‡ä½¿ç³»ç»Ÿèƒ½å¤Ÿç†è§£å…¶è¿è¡Œç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ å‡ºæ›´è‡ªç„¶ã€æ›´é«˜æ•ˆã€æ›´å…·é¢„è§æ€§çš„äººæœºäº¤äº’ä½“éªŒã€‚ç„¶è€Œï¼Œè¦å®ç°çœŸæ­£æˆç†Ÿçš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿï¼Œä»ç„¶éœ€è¦åœ¨ä¸Šä¸‹æ–‡å»ºæ¨¡ã€ä¸ç¡®å®šæ€§æ¨ç†å’Œç”¨æˆ·éšç§ä¿æŠ¤ç­‰å…³é”®æŠ€æœ¯é¢†åŸŸå–å¾—è¿›ä¸€æ­¥çš„çªç ´ã€‚

## 7 æ‰¹åˆ¤æ€§åˆ†æ

- æœ¬èŠ‚å†…å®¹å¾…è¡¥å……ï¼šè¯·ä»å¤šå…ƒç†è®ºè§†è§’ã€å±€é™æ€§ã€äº‰è®®ç‚¹ã€åº”ç”¨å‰æ™¯ç­‰æ–¹é¢è¿›è¡Œæ‰¹åˆ¤æ€§åˆ†æã€‚
