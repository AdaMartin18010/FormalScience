# 01-控制论基础 (Control Theory Foundation)

## 目录

- [01-控制论基础 (Control Theory Foundation)](#01-控制论基础-control-theory-foundation)
  - [目录](#目录)
  - [1. 线性控制理论](#1-线性控制理论)
    - [1.1 线性系统模型](#11-线性系统模型)
    - [1.2 可控性与可观性](#12-可控性与可观性)
    - [1.3 稳定性分析](#13-稳定性分析)
  - [2. 非线性控制理论](#2-非线性控制理论)
    - [2.1 非线性系统模型](#21-非线性系统模型)
    - [2.2 李雅普诺夫稳定性](#22-李雅普诺夫稳定性)
    - [2.3 反馈线性化](#23-反馈线性化)
  - [3. 最优控制理论](#3-最优控制理论)
    - [3.1 变分法](#31-变分法)
    - [3.2 动态规划](#32-动态规划)
    - [3.3 线性二次调节器](#33-线性二次调节器)
  - [4. 鲁棒控制理论](#4-鲁棒控制理论)
    - [4.1 不确定性建模](#41-不确定性建模)
    - [4.2 H∞控制](#42-h控制)
  - [5. 自适应控制理论](#5-自适应控制理论)
    - [5.1 模型参考自适应控制](#51-模型参考自适应控制)
    - [5.2 自校正控制](#52-自校正控制)
  - [6. 时变系统控制](#6-时变系统控制)
    - [6.1 时变系统模型](#61-时变系统模型)
    - [6.2 时变稳定性](#62-时变稳定性)
  - [7. 形式化证明](#7-形式化证明)
    - [7.1 稳定性证明](#71-稳定性证明)
    - [7.2 可控性证明](#72-可控性证明)
  - [8. 应用与实现](#8-应用与实现)
    - [8.1 机器人控制](#81-机器人控制)
    - [8.2 飞行控制](#82-飞行控制)
  - [总结](#总结)

## 1. 线性控制理论

### 1.1 线性系统模型

**定义 1.1.1 (线性系统)**
线性连续时间系统：
$$\dot{x}(t) = Ax(t) + Bu(t)$$
$$y(t) = Cx(t) + Du(t)$$

其中：

- $x(t) \in \mathbb{R}^n$ 是状态向量
- $u(t) \in \mathbb{R}^m$ 是控制输入
- $y(t) \in \mathbb{R}^p$ 是输出
- $A, B, C, D$ 是系统矩阵

**定义 1.1.2 (状态转移矩阵)**
状态转移矩阵 $\Phi(t) = e^{At}$ 满足：
$$x(t) = \Phi(t)x(0) + \int_0^t \Phi(t-\tau)Bu(\tau)d\tau$$

**定理 1.1.1 (线性系统解)**
线性系统的解为：
$$x(t) = e^{At}x_0 + \int_0^t e^{A(t-\tau)}Bu(\tau)d\tau$$

### 1.2 可控性与可观性

**定义 1.1.3 (可控性)**
系统 $(A, B)$ 可控当且仅当可控性矩阵 $W_c = [B \ AB \ A^2B \ \ldots \ A^{n-1}B]$ 满秩。

**定义 1.1.4 (可观性)**
系统 $(A, C)$ 可观当且仅当可观性矩阵 $W_o = [C^T \ A^TC^T \ (A^2)^TC^T \ \ldots \ (A^{n-1})^TC^T]^T$ 满秩。

**定理 1.1.2 (对偶性)**
$(A, B)$ 可控当且仅当 $(A^T, B^T)$ 可观。

### 1.3 稳定性分析

**定义 1.1.5 (李雅普诺夫稳定性)**
平衡点 $x_e$ 稳定当且仅当：
$$\forall \epsilon > 0, \exists \delta > 0 : \|x_0 - x_e\| < \delta \Rightarrow \|x(t) - x_e\| < \epsilon$$

**定理 1.1.3 (线性系统稳定性)**
线性系统稳定当且仅当 $A$ 的所有特征值实部为负。

**证明：** 通过李雅普诺夫函数 $V(x) = x^TPx$，其中 $P$ 满足 $A^TP + PA = -Q$。

## 2. 非线性控制理论

### 2.1 非线性系统模型

**定义 2.1.1 (非线性系统)**
非线性系统：
$$\dot{x} = f(x, u)$$
$$y = h(x, u)$$

其中 $f$ 和 $h$ 是非线性函数。

**定义 2.1.2 (局部线性化)**
在平衡点 $(x_e, u_e)$ 处的线性化：
$$\dot{\delta x} = A\delta x + B\delta u$$
其中 $A = \frac{\partial f}{\partial x}|_{(x_e, u_e)}$, $B = \frac{\partial f}{\partial u}|_{(x_e, u_e)}$

### 2.2 李雅普诺夫稳定性

**定义 2.1.3 (李雅普诺夫函数)**
函数 $V(x)$ 是李雅普诺夫函数当且仅当：

1. $V(0) = 0$
2. $V(x) > 0$ 对于 $x \neq 0$
3. $\dot{V}(x) \leq 0$

**定理 2.1.1 (李雅普诺夫稳定性定理)**
如果存在李雅普诺夫函数 $V(x)$ 使得 $\dot{V}(x) < 0$，则系统渐近稳定。

### 2.3 反馈线性化

**定义 2.1.4 (相对度)**
系统的相对度是满足 $L_gL_f^{r-1}h(x) \neq 0$ 的最小整数 $r$。

**定理 2.1.2 (反馈线性化)**
如果系统相对度为 $n$，则可通过反馈 $u = \alpha(x) + \beta(x)v$ 线性化。

## 3. 最优控制理论

### 3.1 变分法

**定义 3.1.1 (最优控制问题)**
最小化性能指标：
$$J = \int_0^T L(x, u, t)dt + \phi(x(T))$$

**定理 3.1.1 (欧拉-拉格朗日方程)**
最优轨迹满足：
$$\frac{d}{dt}\frac{\partial L}{\partial \dot{x}} - \frac{\partial L}{\partial x} = 0$$

### 3.2 动态规划

**定义 3.1.2 (值函数)**
值函数 $V(x, t)$ 定义为从状态 $x$ 和时间 $t$ 开始的最优成本。

**定理 3.1.2 (贝尔曼方程)**
值函数满足：
$$-\frac{\partial V}{\partial t} = \min_u \{L(x, u) + \frac{\partial V}{\partial x}f(x, u)\}$$

### 3.3 线性二次调节器

**定义 3.1.3 (LQR问题)**
最小化：
$$J = \int_0^\infty (x^TQx + u^TRu)dt$$

**定理 3.1.3 (LQR解)**
最优控制为 $u = -Kx$，其中 $K = R^{-1}B^TP$，$P$ 满足代数黎卡提方程：
$$A^TP + PA - PBR^{-1}B^TP + Q = 0$$

## 4. 鲁棒控制理论

### 4.1 不确定性建模

**定义 4.1.1 (不确定性)**
系统不确定性可表示为：
$$G(s) = G_0(s)(1 + W(s)\Delta(s))$$
其中 $|\Delta(j\omega)| \leq 1$

**定义 4.1.2 (鲁棒稳定性)**
系统鲁棒稳定当且仅当：
$$\|W(s)T(s)\|_\infty < 1$$
其中 $T(s)$ 是闭环传递函数。

### 4.2 H∞控制

**定义 4.1.3 (H∞范数)**
传递函数 $G(s)$ 的H∞范数：
$$\|G(s)\|_\infty = \sup_{\omega} \sigma_{\max}(G(j\omega))$$

**定理 4.1.1 (H∞控制)**
H∞控制器设计问题可转化为标准问题求解。

## 5. 自适应控制理论

### 5.1 模型参考自适应控制

**定义 5.1.1 (参考模型)**
参考模型：
$$\dot{x}_m = A_mx_m + B_mr$$

**定义 5.1.2 (跟踪误差)**
跟踪误差 $e = x - x_m$

**定理 5.1.1 (MRAC稳定性)**
如果参考模型稳定且系统满足匹配条件，则MRAC系统稳定。

### 5.2 自校正控制

**定义 5.2.1 (参数估计)**
参数估计器：
$$\dot{\hat{\theta}} = -\Gamma \phi e$$

**定理 5.2.1 (自校正收敛性)**
在持续激励条件下，参数估计收敛到真值。

## 6. 时变系统控制

### 6.1 时变系统模型

**定义 6.1.1 (时变系统)**
时变系统：
$$\dot{x} = A(t)x + B(t)u$$

**定义 6.1.2 (状态转移矩阵)**
时变系统的状态转移矩阵 $\Phi(t, t_0)$ 满足：
$$\frac{\partial \Phi(t, t_0)}{\partial t} = A(t)\Phi(t, t_0)$$

### 6.2 时变稳定性

**定理 6.1.1 (时变稳定性)**
如果 $A(t)$ 的特征值实部有界且为负，则系统稳定。

## 7. 形式化证明

### 7.1 稳定性证明

**定理 7.1.1 (李雅普诺夫稳定性)**
通过构造李雅普诺夫函数证明稳定性：

```haskell
-- 李雅普诺夫稳定性检查
lyapunovStability :: System -> Bool
lyapunovStability system = 
  let lyapunovFunction = constructLyapunovFunction system
      isPositiveDefinite = checkPositiveDefinite lyapunovFunction
      isNegativeDefinite = checkNegativeDefinite (derivative lyapunovFunction)
  in isPositiveDefinite && isNegativeDefinite
```

### 7.2 可控性证明

**定理 7.1.2 (可控性判据)**
通过可控性矩阵秩检查：

```haskell
-- 可控性检查
controllability :: System -> Bool
controllability system = 
  let controllabilityMatrix = constructControllabilityMatrix system
      rank = matrixRank controllabilityMatrix
      stateDimension = systemStateDimension system
  in rank == stateDimension
```

## 8. 应用与实现

### 8.1 机器人控制

**应用 8.1.1 (轨迹跟踪)**
使用LQR进行轨迹跟踪：

```haskell
-- LQR控制器
lqrController :: System -> State -> Control
lqrController system state = 
  let gainMatrix = computeLQRGain system
      control = negate (gainMatrix `multiply` state)
  in control

-- LQR增益计算
computeLQRGain :: System -> Matrix
computeLQRGain system = 
  let riccatiSolution = solveRiccatiEquation system
      gainMatrix = inverse system.B `multiply` transpose system.B `multiply` riccatiSolution
  in gainMatrix
```

### 8.2 飞行控制

**应用 8.2.1 (姿态控制)**
使用PID控制器进行姿态控制：

```haskell
-- PID控制器
pidController :: PIDGains -> Error -> Integral -> Derivative -> Control
pidController gains error integral derivative = 
  let proportional = gains.kp * error
      integralTerm = gains.ki * integral
      derivativeTerm = gains.kd * derivative
      control = proportional + integralTerm + derivativeTerm
  in control
```

## 总结

控制论基础提供了：

1. **系统建模**：线性和非线性系统模型
2. **稳定性分析**：李雅普诺夫稳定性理论
3. **最优控制**：变分法和动态规划
4. **鲁棒控制**：不确定性和H∞控制
5. **自适应控制**：参数估计和自校正
6. **实际应用**：机器人、飞行器等控制应用

该理论为自动控制系统设计提供了完整的理论基础。
