# 经典控制理论：线性系统分析与设计

## 目录

1. [理论基础](#1-理论基础)
2. [系统建模](#2-系统建模)
3. [时域分析](#3-时域分析)
4. [频域分析](#4-频域分析)
5. [稳定性分析](#5-稳定性分析)
6. [控制器设计](#6-控制器设计)
7. [根轨迹法](#7-根轨迹法)
8. [频域设计](#8-频域设计)
9. [应用案例](#9-应用案例)
10. [理论扩展](#10-理论扩展)

## 1. 理论基础

### 1.1 线性系统定义

**定义 1.1.1** (线性时不变系统)
线性时不变(LTI)系统是一个四元组 $\Sigma = (X, U, Y, f)$，其中：

- $X \subseteq \mathbb{R}^n$ 是状态空间
- $U \subseteq \mathbb{R}^m$ 是输入空间
- $Y \subseteq \mathbb{R}^p$ 是输出空间
- $f: X \times U \rightarrow X$ 是状态转移函数

系统满足线性性和时不变性：

**线性性**：
$$\forall x_1, x_2 \in X, \forall u_1, u_2 \in U, \forall \alpha, \beta \in \mathbb{R}$$
$$f(\alpha x_1 + \beta x_2, \alpha u_1 + \beta u_2) = \alpha f(x_1, u_1) + \beta f(x_2, u_2)$$

**时不变性**：
$$\forall t \in \mathbb{R}, \forall x \in X, \forall u \in U$$
$$f(x, u) = f(x, u)$$

### 1.2 状态空间表示

**定义 1.1.2** (状态空间方程)
LTI系统的状态空间表示为：

$$\dot{x}(t) = Ax(t) + Bu(t)$$
$$y(t) = Cx(t) + Du(t)$$

其中：

- $A \in \mathbb{R}^{n \times n}$ 是系统矩阵
- $B \in \mathbb{R}^{n \times m}$ 是输入矩阵
- $C \in \mathbb{R}^{p \times n}$ 是输出矩阵
- $D \in \mathbb{R}^{p \times m}$ 是直接传递矩阵

**定义 1.1.3** (传递函数)
传递函数定义为：

$$G(s) = C(sI - A)^{-1}B + D = \frac{b_n s^n + b_{n-1} s^{n-1} + \cdots + b_0}{a_n s^n + a_{n-1} s^{n-1} + \cdots + a_0}$$

### 1.3 系统性质

**定义 1.1.4** (可控性)
系统 $(A, B)$ 是可控的，如果可控性矩阵 $W_c$ 满秩：

$$W_c = [B \quad AB \quad A^2B \quad \cdots \quad A^{n-1}B]$$

**定理 1.1.1** (可控性判据)
系统 $(A, B)$ 可控当且仅当 $\text{rank}(W_c) = n$。

**证明**：

1. **必要性**：如果系统可控，则任意状态可达，需要 $n$ 个线性无关的控制方向
2. **充分性**：如果 $\text{rank}(W_c) = n$，则存在控制律使得任意状态可达

**定义 1.1.5** (可观性)
系统 $(A, C)$ 是可观的，如果可观性矩阵 $W_o$ 满秩：

$$W_o = \begin{bmatrix} C \\ CA \\ CA^2 \\ \vdots \\ CA^{n-1} \end{bmatrix}$$

**定理 1.1.2** (可观性判据)
系统 $(A, C)$ 可观当且仅当 $\text{rank}(W_o) = n$。

## 2. 系统建模

### 2.1 物理系统建模

**定义 2.1.1** (机械系统)
机械系统的基本元件包括：

- **质量**：$F = m\ddot{x}$
- **弹簧**：$F = kx$
- **阻尼器**：$F = c\dot{x}$

**示例 2.1.1** (质量-弹簧-阻尼系统)
考虑单自由度系统：

$$m\ddot{x} + c\dot{x} + kx = u(t)$$

状态变量选择：
$$x_1 = x, \quad x_2 = \dot{x}$$

状态空间表示：
$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{c}{m} \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix} u$$

### 2.2 电气系统建模

**定义 2.1.2** (电气元件)
电气系统的基本元件包括：

- **电阻**：$v = Ri$
- **电感**：$v = L\frac{di}{dt}$
- **电容**：$i = C\frac{dv}{dt}$

**示例 2.1.2** (RLC电路)
考虑RLC串联电路：

$$L\frac{di}{dt} + Ri + \frac{1}{C}\int i dt = v_{in}(t)$$

状态变量选择：
$$x_1 = i, \quad x_2 = \frac{1}{C}\int i dt$$

状态空间表示：
$$\begin{bmatrix} \dot{x}_1 \\ \dot{x}_2 \end{bmatrix} = \begin{bmatrix} -\frac{R}{L} & -\frac{1}{L} \\ \frac{1}{C} & 0 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \begin{bmatrix} \frac{1}{L} \\ 0 \end{bmatrix} v_{in}$$

## 3. 时域分析

### 3.1 状态响应

**定义 3.1.1** (状态转移矩阵)
状态转移矩阵定义为：

$$\Phi(t) = e^{At} = \sum_{k=0}^{\infty} \frac{A^k t^k}{k!}$$

**定理 3.1.1** (状态响应)
LTI系统的状态响应为：

$$x(t) = e^{At}x(0) + \int_0^t e^{A(t-\tau)}Bu(\tau)d\tau$$

**证明**：

1. 齐次解：$\dot{x} = Ax$ 的解为 $x(t) = e^{At}x(0)$
2. 特解：通过卷积积分得到
3. 全解：齐次解 + 特解

### 3.2 输出响应

**定义 3.1.2** (输出响应)
LTI系统的输出响应为：

$$y(t) = Ce^{At}x(0) + C\int_0^t e^{A(t-\tau)}Bu(\tau)d\tau + Du(t)$$

**定义 3.1.3** (脉冲响应)
脉冲响应定义为：

$$h(t) = Ce^{At}B + D\delta(t)$$

其中 $\delta(t)$ 是狄拉克脉冲函数。

### 3.3 性能指标

**定义 3.1.4** (上升时间)
上升时间 $t_r$ 是输出从10%到90%稳态值所需的时间。

**定义 3.1.5** (超调量)
超调量 $M_p$ 定义为：

$$M_p = \frac{y_{max} - y_{ss}}{y_{ss}} \times 100\%$$

**定义 3.1.6** (调节时间)
调节时间 $t_s$ 是输出进入并保持在稳态值±2%范围内所需的时间。

## 4. 频域分析

### 4.1 频率响应

**定义 4.1.1** (频率响应)
频率响应定义为传递函数在虚轴上的值：

$$G(j\omega) = C(j\omega I - A)^{-1}B + D$$

**定义 4.1.2** (幅频特性)
幅频特性定义为：

$$|G(j\omega)| = \sqrt{\text{Re}[G(j\omega)]^2 + \text{Im}[G(j\omega)]^2}$$

**定义 4.1.3** (相频特性)
相频特性定义为：

$$\angle G(j\omega) = \tan^{-1}\left(\frac{\text{Im}[G(j\omega)]}{\text{Re}[G(j\omega)]}\right)$$

### 4.2 波特图

**定义 4.1.4** (波特图)
波特图是幅频特性和相频特性的对数坐标图：

- **幅频图**：$20\log_{10}|G(j\omega)|$ vs $\log_{10}\omega$
- **相频图**：$\angle G(j\omega)$ vs $\log_{10}\omega$

**定理 4.1.1** (波特图近似)
对于一阶因子 $(s + a)$：

- 幅频特性：低频0dB，高频20dB/decade
- 相频特性：低频0°，高频90°

### 4.3 奈奎斯特图

**定义 4.1.5** (奈奎斯特图)
奈奎斯特图是 $G(j\omega)$ 在复平面上的轨迹。

**定理 4.1.2** (奈奎斯特稳定性判据)
闭环系统稳定的充分必要条件是奈奎斯特图不包围点 $(-1, 0)$。

## 5. 稳定性分析

### 5.1 李雅普诺夫稳定性

**定义 5.1.1** (李雅普诺夫稳定性)
平衡点 $x_e = 0$ 是稳定的，如果：

$$\forall \epsilon > 0, \exists \delta > 0, \forall x_0 \in B_\delta(0)$$
$$\|x(t)\| < \epsilon, \forall t \geq 0$$

**定义 5.1.2** (渐近稳定性)
平衡点 $x_e = 0$ 是渐近稳定的，如果它是稳定的且：

$$\lim_{t \rightarrow \infty} x(t) = 0$$

**定理 5.1.1** (李雅普诺夫直接法)
如果存在正定函数 $V(x)$ 使得 $\dot{V}(x) \leq 0$，则系统稳定。

**证明**：

1. $V(x) > 0$ 确保状态有界
2. $\dot{V}(x) \leq 0$ 确保状态不远离平衡点
3. 因此系统稳定

### 5.2 劳斯-赫尔维茨判据

**定义 5.1.3** (劳斯表)
对于特征多项式 $P(s) = a_n s^n + a_{n-1} s^{n-1} + \cdots + a_0$，劳斯表构造如下：

$$\begin{array}{c|cc}
s^n & a_n & a_{n-2} & a_{n-4} & \cdots \\
s^{n-1} & a_{n-1} & a_{n-3} & a_{n-5} & \cdots \\
s^{n-2} & b_1 & b_2 & b_3 & \cdots \\
s^{n-3} & c_1 & c_2 & c_3 & \cdots \\
\vdots & \vdots & \vdots & \vdots & \ddots
\end{array}$$

其中：
$$b_1 = \frac{a_{n-1}a_{n-2} - a_n a_{n-3}}{a_{n-1}}$$
$$c_1 = \frac{b_1 a_{n-3} - a_{n-1} b_2}{b_1}$$

**定理 5.1.2** (劳斯-赫尔维茨判据)
系统稳定的充分必要条件是劳斯表第一列所有元素同号。

### 5.3 根轨迹法

**定义 5.1.4** (根轨迹)
根轨迹是闭环极点随增益 $K$ 变化的轨迹。

**定理 5.1.3** (根轨迹规则)
根轨迹满足以下规则：

1. **起点**：$K = 0$ 时，根轨迹从开环极点开始
2. **终点**：$K = \infty$ 时，根轨迹趋向开环零点或无穷远
3. **分支数**：等于开环极点数
4. **对称性**：关于实轴对称

## 6. 控制器设计

### 6.1 PID控制器

**定义 6.1.1** (PID控制器)
PID控制器的传递函数为：

$$G_c(s) = K_p + \frac{K_i}{s} + K_d s$$

其中：
- $K_p$ 是比例增益
- $K_i$ 是积分增益
- $K_d$ 是微分增益

**定理 6.1.1** (PID参数整定)
对于二阶系统，PID参数可以通过以下方法整定：

1. **齐格勒-尼科尔斯方法**
2. **科恩-库恩方法**
3. **内模控制方法**

### 6.2 极点配置

**定义 6.1.2** (极点配置)
极点配置是通过状态反馈将闭环极点配置到期望位置。

**定理 6.1.2** (极点配置定理)
如果系统 $(A, B)$ 可控，则可以通过状态反馈 $u = -Kx$ 任意配置闭环极点。

**证明**：
1. 闭环系统矩阵：$A - BK$
2. 特征多项式：$\det(sI - A + BK)$
3. 通过选择 $K$ 可以任意配置特征值

### 6.3 观测器设计

**定义 6.1.3** (全维观测器)
全维观测器的状态方程为：

$$\dot{\hat{x}} = A\hat{x} + Bu + L(y - C\hat{x})$$

其中 $L$ 是观测器增益矩阵。

**定理 6.1.3** (观测器设计)
如果系统 $(A, C)$ 可观，则可以通过选择 $L$ 任意配置观测器极点。

## 7. 根轨迹法

### 7.1 根轨迹绘制

**定义 7.1.1** (根轨迹方程)
根轨迹满足方程：

$$1 + KG(s)H(s) = 0$$

其中 $G(s)$ 是前向传递函数，$H(s)$ 是反馈传递函数。

**定理 7.1.1** (根轨迹性质)
根轨迹具有以下性质：

1. **幅值条件**：$|KG(s)H(s)| = 1$
2. **相位条件**：$\angle KG(s)H(s) = 180° + 360°k$
3. **分支数**：等于开环极点数
4. **渐近线**：$n - m$ 条渐近线，角度为 $\frac{180° + 360°k}{n - m}$

### 7.2 根轨迹分析

**定义 7.1.2** (分离点)
分离点是根轨迹离开实轴的点，满足：

$$\frac{d}{ds}[G(s)H(s)] = 0$$

**定义 7.1.3** (会合点)
会合点是根轨迹进入实轴的点。

**定理 7.1.2** (根轨迹稳定性)
系统稳定的充分必要条件是所有闭环极点都在左半平面。

## 8. 频域设计

### 8.1 频域指标

**定义 8.1.1** (增益裕度)
增益裕度定义为：

$$GM = \frac{1}{|G(j\omega_p)|}$$

其中 $\omega_p$ 是相位穿越频率。

**定义 8.1.2** (相位裕度)
相位裕度定义为：

$$PM = 180° + \angle G(j\omega_c)$$

其中 $\omega_c$ 是增益穿越频率。

### 8.2 频域设计方法

**定义 8.1.3** (超前补偿器)
超前补偿器的传递函数为：

$$G_c(s) = K_c \frac{s + z}{s + p}, \quad z < p$$

**定义 8.1.4** (滞后补偿器)
滞后补偿器的传递函数为：

$$G_c(s) = K_c \frac{s + z}{s + p}, \quad z > p$$

**定理 8.1.1** (频域设计)
通过频域设计可以同时满足稳态精度和动态性能要求。

## 9. 应用案例

### 9.1 倒立摆控制

**问题描述**：
控制倒立摆保持垂直平衡。

**系统建模**：
$$\begin{bmatrix} \dot{x} \\ \dot{\theta} \\ \ddot{x} \\ \ddot{\theta} \end{bmatrix} = \begin{bmatrix} 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & -\frac{mg}{M} & 0 & 0 \\ 0 & \frac{(M+m)g}{Ml} & 0 & 0 \end{bmatrix} \begin{bmatrix} x \\ \theta \\ \dot{x} \\ \dot{\theta} \end{bmatrix} + \begin{bmatrix} 0 \\ 0 \\ \frac{1}{M} \\ -\frac{1}{Ml} \end{bmatrix} u$$

**控制器设计**：
使用LQR方法设计状态反馈控制器。

### 9.2 直流电机控制

**问题描述**：
控制直流电机的转速。

**系统建模**：
$$\frac{d\omega}{dt} = \frac{K_t}{J}i - \frac{b}{J}\omega$$
$$L\frac{di}{dt} = -Ri - K_e\omega + v$$

**控制器设计**：
使用PID控制器控制转速。

## 10. 理论扩展

### 10.1 鲁棒控制

**定义 10.1.1** (鲁棒性)
系统对参数变化和外部扰动的敏感性。

**定理 10.1.1** (小增益定理)
如果 $\|G_1\|_\infty \|G_2\|_\infty < 1$，则反馈系统稳定。

### 10.2 自适应控制

**定义 10.1.2** (自适应控制)
根据系统参数变化自动调整控制器参数。

**定理 10.1.2** (自适应律)
自适应律确保参数估计收敛到真值。

## 参考文献

1. Franklin, G. F., Powell, J. D., & Emami-Naeini, A. (2015). Feedback control of dynamic systems (7th ed.). Pearson.
2. Ogata, K. (2010). Modern control engineering (5th ed.). Prentice Hall.
3. Kuo, B. C., & Golnaraghi, F. (2003). Automatic control systems (8th ed.). Wiley.
4. Dorf, R. C., & Bishop, R. H. (2011). Modern control systems (12th ed.). Prentice Hall.
5. Nise, N. S. (2015). Control systems engineering (7th ed.). Wiley.
