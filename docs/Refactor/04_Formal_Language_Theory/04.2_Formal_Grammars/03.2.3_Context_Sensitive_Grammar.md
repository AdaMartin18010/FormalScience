# 03.2.3 ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³• (Context-Sensitive Grammar)

## ğŸ“š æ¦‚è¿°

ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•æ˜¯å½¢å¼è¯­è¨€ç†è®ºä¸­çš„é‡è¦æ–‡æ³•ç±»å‹ï¼Œå®ƒç”Ÿæˆçš„è¯­è¨€æ°å¥½æ˜¯çº¿æ€§æœ‰ç•Œè‡ªåŠ¨æœºèƒ½å¤Ÿè¯†åˆ«çš„è¯­è¨€ã€‚ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•æ˜¯ä¹”å§†æ–¯åŸºè°±ç³»ä¸­çš„1å‹æ–‡æ³•ï¼Œæ¯”ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•æ›´å¼ºå¤§ï¼Œèƒ½å¤Ÿæè¿°æ›´å¤æ‚çš„è¯­è¨€ç»“æ„ã€‚

## ğŸ” å½¢å¼å®šä¹‰

**å®šä¹‰ 3.2.3.1** (ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•)
ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•æ˜¯ä¸€ä¸ªå››å…ƒç»„ $G = (V, \Sigma, P, S)$ï¼Œå…¶ä¸­ï¼š

1. $V$ æ˜¯éç»ˆç»“ç¬¦é›†åˆ
2. $\Sigma$ æ˜¯ç»ˆç»“ç¬¦é›†åˆï¼Œä¸” $V \cap \Sigma = \emptyset$
3. $P$ æ˜¯äº§ç”Ÿå¼é›†åˆï¼Œæ¯ä¸ªäº§ç”Ÿå¼å½¢å¦‚ $\alpha A \beta \to \alpha \gamma \beta$ï¼Œå…¶ä¸­ $A \in V$ï¼Œ$\alpha, \beta \in (V \cup \Sigma)^*$ï¼Œ$\gamma \in (V \cup \Sigma)^+$
4. $S \in V$ æ˜¯èµ·å§‹ç¬¦å·

**æ³¨**: ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå…è®¸äº§ç”Ÿå¼ $S \to \varepsilon$ï¼Œå‰ææ˜¯ $S$ ä¸å‡ºç°åœ¨ä»»ä½•äº§ç”Ÿå¼çš„å³éƒ¨ã€‚

**å®šä¹‰ 3.2.3.2** (æ¨å¯¼)
å¯¹äºä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³• $G = (V, \Sigma, P, S)$ï¼Œå¦‚æœ $\alpha A \beta \to \alpha \gamma \beta \in P$ï¼Œåˆ™æœ‰ $\delta \alpha A \beta \eta \Rightarrow \delta \alpha \gamma \beta \eta$ï¼Œå…¶ä¸­ $\delta, \eta \in (V \cup \Sigma)^*$ã€‚

**å®šä¹‰ 3.2.3.3** (è¯­è¨€)
ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³• $G$ ç”Ÿæˆçš„è¯­è¨€å®šä¹‰ä¸ºï¼š
$$L(G) = \{w \in \Sigma^* \mid S \Rightarrow^* w\}$$

## ğŸ”„ ç†è®ºæ€§è´¨

### éç¼©çŸ­æ€§

**å®šç† 3.2.3.1** (éç¼©çŸ­æ€§)
ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•çš„äº§ç”Ÿå¼å…·æœ‰éç¼©çŸ­æ€§ï¼Œå³å¯¹äºä»»ä½•äº§ç”Ÿå¼ $\alpha \to \beta$ï¼Œéƒ½æœ‰ $|\alpha| \leq |\beta|$ï¼ˆé™¤äº†å¯èƒ½çš„ $S \to \varepsilon$ äº§ç”Ÿå¼ï¼‰ã€‚

**è¯æ˜**:
æ ¹æ®å®šä¹‰ï¼Œäº§ç”Ÿå¼å½¢å¦‚ $\alpha A \beta \to \alpha \gamma \beta$ï¼Œå…¶ä¸­ $\gamma \in (V \cup \Sigma)^+$ï¼Œæ‰€ä»¥ $|\gamma| \geq 1$ï¼Œå› æ­¤ $|\alpha A \beta| \leq |\alpha \gamma \beta|$ã€‚

### ä¸çº¿æ€§æœ‰ç•Œè‡ªåŠ¨æœºçš„ç­‰ä»·æ€§

**å®šç† 3.2.3.2** (ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•ä¸çº¿æ€§æœ‰ç•Œè‡ªåŠ¨æœºçš„ç­‰ä»·æ€§)
ä¸€ä¸ªè¯­è¨€æ˜¯ä¸Šä¸‹æ–‡ç›¸å…³çš„å½“ä¸”ä»…å½“å®ƒèƒ½è¢«æŸä¸ªçº¿æ€§æœ‰ç•Œè‡ªåŠ¨æœºæ¥å—ã€‚

**è¯æ˜æ¦‚è¦**:

1. ä»ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•æ„é€ çº¿æ€§æœ‰ç•Œè‡ªåŠ¨æœºï¼š
   - ä½¿ç”¨è‡ªåŠ¨æœºæ¨¡æ‹Ÿæ–‡æ³•çš„æ¨å¯¼è¿‡ç¨‹
   - åˆ©ç”¨éç¼©çŸ­æ€§ç¡®ä¿ç©ºé—´çº¿æ€§æœ‰ç•Œ

2. ä»çº¿æ€§æœ‰ç•Œè‡ªåŠ¨æœºæ„é€ ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•ï¼š
   - ä½¿ç”¨æ–‡æ³•æ¨¡æ‹Ÿè‡ªåŠ¨æœºçš„è®¡ç®—è¿‡ç¨‹
   - ä¸ºæ¯ä¸ªé…ç½®åˆ›å»ºå¯¹åº”çš„éç»ˆç»“ç¬¦

### é—­åŒ…æ€§è´¨

**å®šç† 3.2.3.3** (ä¸Šä¸‹æ–‡ç›¸å…³è¯­è¨€çš„é—­åŒ…æ€§è´¨)
ä¸Šä¸‹æ–‡ç›¸å…³è¯­è¨€ç±»å¯¹ä»¥ä¸‹è¿ç®—å°é—­ï¼š

1. å¹¶é›†
2. äº¤é›†
3. è¿æ¥
4. å…‹æ—é—­åŒ…
5. åŒæ€æ˜ å°„
6. é€†åŒæ€æ˜ å°„

ä½†å¯¹è¡¥è¿ç®—ä¸å°é—­ã€‚

### åˆ¤å®šé—®é¢˜

**å®šç† 3.2.3.4** (åˆ¤å®šé—®é¢˜)
å¯¹äºä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•ï¼Œä»¥ä¸‹é—®é¢˜æ˜¯å¯åˆ¤å®šçš„ï¼š

1. æˆå‘˜èµ„æ ¼é—®é¢˜ï¼šç»™å®šå­—ç¬¦ä¸² $w$ æ˜¯å¦å±äº $L(G)$
2. ç©ºæ€§é—®é¢˜ï¼š$L(G)$ æ˜¯å¦ä¸ºç©º

ä½†ç­‰ä»·æ€§é—®é¢˜æ˜¯ä¸å¯åˆ¤å®šçš„ã€‚

## ğŸ› ï¸ åº”ç”¨ç¤ºä¾‹

### å¤åˆ¶è¯­è¨€

```text
S â†’ aSb | ab
```

æ­¤æ–‡æ³•ç”Ÿæˆè¯­è¨€ $L = \{a^n b^n \mid n \geq 1\}$ï¼Œæ˜¯ä¸Šä¸‹æ–‡æ— å…³è¯­è¨€ã€‚

```text
S â†’ aSBC | aBC
CB â†’ BC
aB â†’ ab
bB â†’ bb
bC â†’ bc
cC â†’ cc
```

æ­¤æ–‡æ³•ç”Ÿæˆè¯­è¨€ $L = \{a^n b^n c^n \mid n \geq 1\}$ï¼Œæ˜¯ä¸Šä¸‹æ–‡ç›¸å…³è¯­è¨€ä½†ä¸æ˜¯ä¸Šä¸‹æ–‡æ— å…³è¯­è¨€ã€‚

### è®¡æ•°è¯­è¨€

```text
S â†’ ABC
AB â†’ ABc
BC â†’ BcC
A â†’ a
B â†’ b
C â†’ c
```

æ­¤æ–‡æ³•ç”Ÿæˆè¯­è¨€ $L = \{a^n b^n c^n \mid n \geq 1\}$ï¼Œå±•ç¤ºäº†ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•å¤„ç†å¤šé‡ä¾èµ–çš„èƒ½åŠ›ã€‚

## ğŸ”— å®ç°ç¤ºä¾‹

```python
class CSG:
    def __init__(self, variables, terminals, productions, start_symbol):
        self.variables = variables          # éç»ˆç»“ç¬¦é›†åˆ
        self.terminals = terminals          # ç»ˆç»“ç¬¦é›†åˆ
        self.productions = productions      # äº§ç”Ÿå¼è§„åˆ™
        self.start_symbol = start_symbol    # èµ·å§‹ç¬¦å·
    
    def is_context_sensitive(self):
        """æ£€æŸ¥æ–‡æ³•æ˜¯å¦ä¸ºä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•"""
        for lhs, rhs_list in self.productions.items():
            for rhs in rhs_list:
                # æ£€æŸ¥ç‰¹æ®Šè§„åˆ™ S â†’ Îµ
                if lhs == self.start_symbol and rhs == "":
                    continue
                
                # æ£€æŸ¥éç¼©çŸ­æ€§
                if len(lhs) > len(rhs):
                    return False
                
                # æ£€æŸ¥ä¸Šä¸‹æ–‡ç›¸å…³å½¢å¼
                # è¿™é‡Œç®€åŒ–äº†æ£€æŸ¥ï¼Œå®Œæ•´æ£€æŸ¥éœ€è¦åˆ†æäº§ç”Ÿå¼ç»“æ„
                
        return True
    
    def derive(self, string, max_steps=1000):
        """æ¨¡æ‹Ÿæ¨å¯¼è¿‡ç¨‹"""
        current = self.start_symbol
        steps = 0
        
        while steps < max_steps and current != string:
            steps += 1
            # å°è¯•åº”ç”¨äº§ç”Ÿå¼è§„åˆ™
            applied = False
            
            for lhs, rhs_list in self.productions.items():
                for rhs in rhs_list:
                    # æŸ¥æ‰¾å¹¶æ›¿æ¢
                    if lhs in current:
                        current = current.replace(lhs, rhs, 1)
                        applied = True
                        break
                
                if applied:
                    break
            
            if not applied:
                return False  # æ— æ³•ç»§ç»­æ¨å¯¼
        
        return current == string
```

## ğŸ”— ç›¸å…³å†…å®¹

- [03.1.3 çº¿æ€§æœ‰ç•Œè‡ªåŠ¨æœº](../03.1_Automata_Theory/03.1.3_Linear_Bounded_Automata.md) - ä¸ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•ç­‰ä»·çš„è®¡ç®—æ¨¡å‹
- [03.2.2 ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•](03.2.2_Context_Free_Grammar.md) - æ¯”ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•æ›´å—é™çš„æ–‡æ³•
- [03.2.4 æ— é™åˆ¶æ–‡æ³•](03.2.4_Unrestricted_Grammar.md) - æ¯”ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•æ›´å¼ºå¤§çš„æ–‡æ³•
- [03.3.1 ä¹”å§†æ–¯åŸºè°±ç³»](../03.3_Language_Hierarchy/03.3.1_Chomsky_Hierarchy.md) - ä¸Šä¸‹æ–‡ç›¸å…³æ–‡æ³•åœ¨è¯­è¨€å±‚æ¬¡ä¸­çš„ä½ç½®

---

**æ›´æ–°æ—¶é—´**: 2024-12-26  
**ç‰ˆæœ¬**: 1.0  
**çŠ¶æ€**: å·²å®Œæˆ


## æ‰¹åˆ¤æ€§åˆ†æ

- æœ¬èŠ‚å†…å®¹å¾…è¡¥å……ï¼šè¯·ä»å¤šå…ƒç†è®ºè§†è§’ã€å±€é™æ€§ã€äº‰è®®ç‚¹ã€åº”ç”¨å‰æ™¯ç­‰æ–¹é¢è¿›è¡Œæ‰¹åˆ¤æ€§åˆ†æã€‚
