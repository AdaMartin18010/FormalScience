# 线性逻辑 (Linear Logic)

## 1. 概述

### 1.1 基本概念

线性逻辑是Jean-Yves Girard在1987年提出的逻辑系统，它通过引入资源敏感的概念，为并发计算和资源管理提供了强大的理论基础。

### 1.2 核心特征

- **资源敏感**：每个假设必须恰好使用一次
- **并发友好**：支持真正的并发推理
- **资源管理**：精确控制资源的使用和释放
- **双线性**：同时处理加法和乘法连接词

## 2. 语法定义

### 2.1 命题语法

```latex
A, B ::= p                    -- 原子命题
        | A ⊗ B              -- 张量积（乘法合取）
        | A & B              -- 与积（加法合取）
        | A ⊕ B              -- 直和（加法析取）
        | A ⅋ B              -- 张量和（乘法析取）
        | A → B              -- 线性蕴含
        | !A                 -- 指数（必然性）
        | ?A                 -- 指数（可能性）
        | 1                  -- 单位（乘法真）
        | ⊤                  -- 单位（加法真）
        | 0                  -- 零（加法假）
        | ⊥                  -- 零（乘法假）
```

### 2.2 序列语法

```latex
Γ, Δ ::= ∅                   -- 空序列
        | Γ, A               -- 单命题
        | Γ, Δ               -- 序列连接
```

### 2.3 判断语法

```latex
⊢ Γ                          -- 序列Γ可证明
```

## 3. 推理规则

### 3.1 结构规则

**交换规则 (Exchange)**

```latex
Γ, A, B, Δ ⊢ C
───────────────
Γ, B, A, Δ ⊢ C
```

**弱化规则 (Weakening) - 仅对指数类型**

```latex
Γ ⊢ C
─────────
Γ, !A ⊢ C
```

**收缩规则 (Contraction) - 仅对指数类型**

```latex
Γ, !A, !A ⊢ C
─────────────
Γ, !A ⊢ C
```

### 3.2 逻辑规则

**单位规则**

**左单位 (1L)**

```latex
Γ ⊢ C
─────────
Γ, 1 ⊢ C
```

**右单位 (1R)**

```latex
─────────
⊢ 1
```

**张量积规则**

**左张量积 (⊗L)**

```latex
Γ, A, B ⊢ C
─────────────
Γ, A ⊗ B ⊢ C
```

**右张量积 (⊗R)**

```latex
Γ ⊢ A    Δ ⊢ B
───────────────
Γ, Δ ⊢ A ⊗ B
```

**线性蕴含规则**

**左蕴含 (→L)**

```latex
Γ ⊢ A    Δ, B ⊢ C
─────────────────
Δ, Γ, A → B ⊢ C
```

**右蕴含 (→R)**

```latex
Γ, A ⊢ B
─────────
Γ ⊢ A → B
```

**指数规则**

**左指数 (!L)**

```latex
Γ, A ⊢ C
─────────
Γ, !A ⊢ C
```

**右指数 (!R)**

```latex
!Γ ⊢ A
───────
!Γ ⊢ !A
```

**左指数复制 (!L_copy)**

```latex
Γ, !A, !A ⊢ C
─────────────
Γ, !A ⊢ C
```

## 4. 核心定理

### 4.1 切割消除定理

**定理 4.1 (切割消除)**：如果存在包含切割规则的证明，则存在不包含切割规则的证明。

**证明**：通过双重归纳法证明。

**基础情况**：

- 原子切割：直接消除
- 单位切割：通过单位规则消除

**归纳情况**：

1. **张量积切割**：

   ```
   Γ ⊢ A    Δ ⊢ B    Λ, A, B ⊢ C
   ──────────────────────────────
   Λ, Γ, Δ ⊢ C
   ```

   转换为：

   ```
   Δ ⊢ B    Λ, A, B ⊢ C
   ──────────────────
   Λ, A, Δ ⊢ C    Γ ⊢ A
   ──────────────────
   Λ, Γ, Δ ⊢ C
   ```

2. **线性蕴含切割**：

   ```
   Γ, A ⊢ B    Δ, B ⊢ C
   ──────────────────
   Δ, Γ, A → B ⊢ C
   ```

   转换为：

   ```
   Γ, A ⊢ B    Δ, B ⊢ C
   ──────────────────
   Δ, Γ, A ⊢ C
   ```

**证毕**

### 4.2 一致性定理

**定理 4.2 (一致性)**：线性逻辑是一致的，即不能同时证明A和¬A。

**证明**：通过切割消除和子公式性质证明。

1. 如果存在A和¬A的证明，则存在切割证明
2. 通过切割消除，得到不包含切割的证明
3. 通过子公式性质，证明不可能同时包含A和¬A

**证毕**

### 4.3 子公式性质

**定理 4.3 (子公式性质)**：在切割消除后的证明中，每个公式都是原始公式的子公式。

**证明**：通过结构归纳法证明。

**基础情况**：公理规则直接满足子公式性质

**归纳情况**：每个推理规则都保持子公式性质

**证毕**

## 5. 语义解释

### 5.1 指称语义

**定义 5.1 (线性函数空间)**
线性函数空间 $A \multimap B$ 的语义：
$$\llbracket A \multimap B \rrbracket = \llbracket A \rrbracket \rightarrow \llbracket B \rrbracket$$

**定义 5.2 (张量积语义)**
张量积 $A \otimes B$ 的语义：
$$\llbracket A \otimes B \rrbracket = \llbracket A \rrbracket \times \llbracket B \rrbracket$$

**定义 5.3 (指数语义)**
指数 $!A$ 的语义：
$$\llbracket !A \rrbracket = \text{Comonad}(\llbracket A \rrbracket)$$

### 5.2 游戏语义

**定义 5.4 (游戏)**
游戏 $G$ 是一个三元组 $(M_G, P_G, \lambda_G)$：

- $M_G$：移动集合
- $P_G$：位置集合
- $\lambda_G$：标签函数

**定义 5.5 (策略)**
策略 $\sigma$ 是位置到移动的部分函数，满足：

1. 单调性：如果 $s \sqsubseteq t$，则 $\sigma(s) \sqsubseteq \sigma(t)$
2. 确定性：每个位置最多一个移动

### 5.3 证明网语义

**定义 5.6 (证明网)**
证明网是一个有向图，其中：

- 节点表示逻辑连接词
- 边表示公式连接
- 满足特定的几何条件

**定理 5.1 (证明网正确性)**
证明网表示有效的线性逻辑证明当且仅当它是正确的。

## 6. 计算解释

### 6.1 λ演算扩展

**定义 6.1 (线性λ演算)**
线性λ演算的语法：

```latex
e ::= x                    -- 变量
    | λx.e                 -- 线性抽象
    | e₁ e₂                -- 线性应用
    | (e₁, e₂)             -- 对构造
    | let (x, y) = e₁ in e₂ -- 对分解
    | !e                   -- 提升
    | let !x = e₁ in e₂    -- 提升分解
```

**归约规则**：

```latex
(λx.e₁) e₂ → e₁[x↦e₂]
let (x, y) = (e₁, e₂) in e₃ → e₃[x↦e₁, y↦e₂]
let !x = !e₁ in e₂ → e₂[x↦e₁]
```

### 6.2 类型系统

**定义 6.2 (线性类型判断)**

```latex
Γ ⊢ e : A
```

**类型规则**：

```latex
x:A ∈ Γ
────────
Γ ⊢ x : A

Γ, x:A ⊢ e : B
──────────────
Γ ⊢ λx.e : A → B

Γ ⊢ e₁ : A → B    Δ ⊢ e₂ : A
────────────────────────────
Γ, Δ ⊢ e₁ e₂ : B
```

## 7. 实际应用

### 7.1 资源管理

**定义 7.1 (资源类型)**

```haskell
data Resource a where
  FileHandle :: FilePath -> Resource FileHandle
  MemoryRef :: a -> Resource (MemoryRef a)
  NetworkConn :: Host -> Port -> Resource NetworkConn
```

**定理 7.1 (资源安全)**
线性类型系统保证资源不会被重复释放或遗忘。

**证明**：通过线性性约束，每个资源变量必须恰好使用一次。

### 7.2 并发编程

**定义 7.2 (并发进程)**

```haskell
data Process a where
  Send :: Chan a -> a -> Process ()
  Receive :: Chan a -> Process a
  Fork :: Process a -> Process (ThreadId a)
```

**定理 7.2 (并发安全)**
线性类型系统保证并发程序的数据竞争自由。

**证明**：通过线性性约束，确保共享资源不会被多个进程同时访问。

### 7.3 量子计算

**定义 7.3 (量子比特)**

```haskell
data Qubit where
  Qubit :: Complex Double -> Qubit
  Entangled :: Qubit -> Qubit -> Qubit
```

**定理 7.3 (量子安全)**
线性类型系统保证量子比特不会被克隆。

**证明**：通过线性性约束，每个量子比特最多使用一次。

## 8. 扩展与变体

### 8.1 仿射逻辑

- 允许弱化但不允许收缩
- 对应仿射类型系统
- 应用：Rust的所有权系统

### 8.2 相关逻辑

- 允许收缩但不允许弱化
- 对应相关类型系统
- 应用：必须使用的资源

### 8.3 直觉线性逻辑

- 限制为直觉主义片段
- 对应函数式编程
- 应用：Haskell的线性类型

## 9. 结论

线性逻辑为现代计算提供了强大的理论基础：

1. **资源管理**：精确控制资源的使用和释放
2. **并发安全**：保证并发程序的数据竞争自由
3. **类型安全**：为编程语言提供类型安全保证
4. **计算模型**：为量子计算等新兴领域提供模型

通过深入理解线性逻辑，我们可以：

- 设计更安全的编程语言
- 实现更可靠的资源管理系统
- 开发更安全的并发程序
- 建立更严谨的计算理论

---

**上级目录**：[线性类型理论索引](../00_Index.md)  
**相关文档**：[资源管理](02_Resource_Management.md) | [内存安全](03_Memory_Safety.md)  
**维护者**：FormalScience团队  
**状态**：✅ 已完成
