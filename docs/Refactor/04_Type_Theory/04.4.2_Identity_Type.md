# 04.4.2 身份/等同性类型（Identity/Equality Type）

## 📋 概述

身份类型 `Id_A(a,b)`（或 `a =_A b`）刻画“a 与 b 在 A 中相等”的证据，以路径消解（path induction）作为核心推理原则，是依类型与 HoTT 的关键连接点。

## 规则（轮廓）

- 形成：`Γ ⊢ A:Type, Γ ⊢ a:A, Γ ⊢ b:A ⇒ Γ ⊢ Id_A(a,b):Type`
- 引入：`refl_a : Id_A(a,a)`
- 消解/归纳：路径消解（J/Path induction）
- 计算：`J` 对 `refl` 的计算等式

## 示例（占位）

```coq
(* 等同性传递 *)
Definition eq_trans {A} {a b c : A} (p : a = b) (q : b = c) : a = c :=
  eq_ind b (fun x => a = x) p c q.
```

```lean
-- 基于 rfl 的重写与传递示意
```

## 参考文献

- Coq/Agda/Lean 核心手册；HoTT Book（路径/等价）

## 批判性分析

- 多元理论视角：
  - 证据化相等：相等不再是公理化谓词，而是可操纵的证据对象，支持重写与运输（transport）。
  - 与 HoTT：在路径语义下，`Id` 即路径空间，统一“证明—几何—程序”。
- 局限性分析：
  - 相等判定的复杂性：内建/外延相等、可计算/不可计算相等的取舍影响类型检查与工程体验。
  - 库与自动化：复杂等式推理需要重写策略、同余引理与自动化支持。
- 争议与分歧：
  - 命题外延、函数外延与一价性等公理的采纳边界；证明无关性与提取策略的工程影响。
- 应用前景：
  - 证明重写与不变量维护、抽象等价的安全替换、协议与数据结构的行为等价刻画。
- 改进建议：
  - 建立“等式工具箱”（重写、传输、同余与同伦补丁）与模板化策略；在 CI 中产出重写证据与回归检测。
