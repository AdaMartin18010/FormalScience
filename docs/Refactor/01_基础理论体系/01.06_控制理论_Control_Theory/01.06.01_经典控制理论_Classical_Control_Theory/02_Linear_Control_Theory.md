# 02 çº¿æ€§æ§åˆ¶ç†è®º

**åˆ›å»ºæ—¶é—´**: 2025-01-17  
**æœ€åæ›´æ–°**: 2025-01-17  
**æ–‡æ¡£çŠ¶æ€**: å®Œæˆ  
**å…³è”æ¨¡å—**: [08 æ§åˆ¶ç†è®º](./README.md)

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£å»ºç«‹çº¿æ€§æ§åˆ¶ç†è®ºçš„åŸºç¡€æ¡†æ¶ï¼ŒåŒ…æ‹¬çº¿æ€§ç³»ç»Ÿçš„å»ºæ¨¡ã€åˆ†æå’Œæ§åˆ¶è®¾è®¡ã€‚é€šè¿‡ä¸¥æ ¼çš„æ•°å­¦å®šä¹‰å’Œå½¢å¼åŒ–è¯æ˜ï¼Œä¸ºçº¿æ€§æ§åˆ¶ç†è®ºæä¾›åšå®çš„ç†è®ºåŸºç¡€ã€‚

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

1. **å»ºç«‹çº¿æ€§ç³»ç»Ÿçš„åŸºæœ¬æ¦‚å¿µå’Œæ•°å­¦æ¨¡å‹**
2. **åˆ†æçº¿æ€§ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯æ§æ€§**
3. **è®¾è®¡çº¿æ€§æ§åˆ¶å™¨å’Œè§‚æµ‹å™¨**
4. **æä¾›çº¿æ€§æ§åˆ¶ç³»ç»Ÿçš„å®ç°å’Œåº”ç”¨**

## ğŸ“š ç›®å½•

- [02 çº¿æ€§æ§åˆ¶ç†è®º](#02-çº¿æ€§æ§åˆ¶ç†è®º)
  - [ğŸ“‹ æ¦‚è¿°](#-æ¦‚è¿°)
  - [ğŸ¯ æ ¸å¿ƒç›®æ ‡](#-æ ¸å¿ƒç›®æ ‡)
  - [ğŸ“š ç›®å½•](#-ç›®å½•)
  - [1. åŸºæœ¬æ¦‚å¿µ](#1-åŸºæœ¬æ¦‚å¿µ)
    - [1.1 çº¿æ€§ç³»ç»Ÿå®šä¹‰](#11-çº¿æ€§ç³»ç»Ÿå®šä¹‰)
    - [1.2 ä¼ é€’å‡½æ•°](#12-ä¼ é€’å‡½æ•°)
    - [1.3 ç³»ç»Ÿæ€§è´¨](#13-ç³»ç»Ÿæ€§è´¨)
  - [2. çº¿æ€§ç³»ç»Ÿå»ºæ¨¡](#2-çº¿æ€§ç³»ç»Ÿå»ºæ¨¡)
    - [2.1 è¿ç»­æ—¶é—´ç³»ç»Ÿ](#21-è¿ç»­æ—¶é—´ç³»ç»Ÿ)
    - [2.2 ç¦»æ•£æ—¶é—´ç³»ç»Ÿ](#22-ç¦»æ•£æ—¶é—´ç³»ç»Ÿ)
    - [2.3 ç³»ç»Ÿè½¬æ¢](#23-ç³»ç»Ÿè½¬æ¢)
  - [3. ç³»ç»Ÿåˆ†æ](#3-ç³»ç»Ÿåˆ†æ)
    - [3.1 ç¨³å®šæ€§åˆ†æ](#31-ç¨³å®šæ€§åˆ†æ)
    - [3.2 å¯æ§æ€§åˆ†æ](#32-å¯æ§æ€§åˆ†æ)
    - [3.3 å¯è§‚æ€§åˆ†æ](#33-å¯è§‚æ€§åˆ†æ)
  - [4. æ§åˆ¶å™¨è®¾è®¡](#4-æ§åˆ¶å™¨è®¾è®¡)
    - [4.1 çŠ¶æ€åé¦ˆæ§åˆ¶](#41-çŠ¶æ€åé¦ˆæ§åˆ¶)
    - [4.2 è¾“å‡ºåé¦ˆæ§åˆ¶](#42-è¾“å‡ºåé¦ˆæ§åˆ¶)
    - [4.3 æœ€ä¼˜æ§åˆ¶](#43-æœ€ä¼˜æ§åˆ¶)
  - [5. è§‚æµ‹å™¨è®¾è®¡](#5-è§‚æµ‹å™¨è®¾è®¡)
    - [5.1 å…¨é˜¶è§‚æµ‹å™¨](#51-å…¨é˜¶è§‚æµ‹å™¨)
    - [5.2 é™é˜¶è§‚æµ‹å™¨](#52-é™é˜¶è§‚æµ‹å™¨)
  - [6. ç®—æ³•å®ç°](#6-ç®—æ³•å®ç°)
    - [6.1 çº¿æ€§ç³»ç»Ÿç±»](#61-çº¿æ€§ç³»ç»Ÿç±»)
    - [6.2 æ§åˆ¶å™¨è®¾è®¡å·¥å…·](#62-æ§åˆ¶å™¨è®¾è®¡å·¥å…·)
  - [7. åº”ç”¨ç¤ºä¾‹](#7-åº”ç”¨ç¤ºä¾‹)
    - [7.1 åŸºæœ¬ç³»ç»Ÿåˆ†æç¤ºä¾‹](#71-åŸºæœ¬ç³»ç»Ÿåˆ†æç¤ºä¾‹)
    - [7.2 æ§åˆ¶å™¨è®¾è®¡ç¤ºä¾‹](#72-æ§åˆ¶å™¨è®¾è®¡ç¤ºä¾‹)
    - [7.3 LQRæ§åˆ¶å™¨è®¾è®¡ç¤ºä¾‹](#73-lqræ§åˆ¶å™¨è®¾è®¡ç¤ºä¾‹)
    - [7.4 è§‚æµ‹å™¨è®¾è®¡ç¤ºä¾‹](#74-è§‚æµ‹å™¨è®¾è®¡ç¤ºä¾‹)
  - [æ‰¹åˆ¤æ€§åˆ†æ](#æ‰¹åˆ¤æ€§åˆ†æ)
    - [å¤šå…ƒç†è®ºè§†è§’](#å¤šå…ƒç†è®ºè§†è§’)
    - [å±€é™æ€§](#å±€é™æ€§)
    - [äº‰è®®ä¸åˆ†æ­§](#äº‰è®®ä¸åˆ†æ­§)
    - [åº”ç”¨å‰æ™¯](#åº”ç”¨å‰æ™¯)
    - [æ”¹è¿›å»ºè®®](#æ”¹è¿›å»ºè®®)
  - [ğŸ“ æ€»ç»“](#-æ€»ç»“)

## 1. åŸºæœ¬æ¦‚å¿µ

### 1.1 çº¿æ€§ç³»ç»Ÿå®šä¹‰

**å®šä¹‰ 1.1.1** (çº¿æ€§ç³»ç»Ÿ)
çº¿æ€§ç³»ç»Ÿæ˜¯æ»¡è¶³å åŠ åŸç†çš„åŠ¨æ€ç³»ç»Ÿï¼Œå…¶çŠ¶æ€æ–¹ç¨‹å’Œè¾“å‡ºæ–¹ç¨‹éƒ½æ˜¯çº¿æ€§çš„ã€‚

**å®šä¹‰ 1.1.2** (çŠ¶æ€ç©ºé—´æ¨¡å‹)
çº¿æ€§ç³»ç»Ÿçš„çŠ¶æ€ç©ºé—´æ¨¡å‹ä¸ºï¼š
$$
\begin{align}
\dot{x}(t) &= Ax(t) + Bu(t) \\
y(t) &= Cx(t) + Du(t)
\end{align}
$$
å…¶ä¸­ï¼š

- $x(t) \in \mathbb{R}^n$ æ˜¯çŠ¶æ€å‘é‡
- $u(t) \in \mathbb{R}^m$ æ˜¯è¾“å…¥å‘é‡
- $y(t) \in \mathbb{R}^p$ æ˜¯è¾“å‡ºå‘é‡
- $A \in \mathbb{R}^{n \times n}$ æ˜¯ç³»ç»ŸçŸ©é˜µ
- $B \in \mathbb{R}^{n \times m}$ æ˜¯è¾“å…¥çŸ©é˜µ
- $C \in \mathbb{R}^{p \times n}$ æ˜¯è¾“å‡ºçŸ©é˜µ
- $D \in \mathbb{R}^{p \times m}$ æ˜¯ç›´æ¥ä¼ é€’çŸ©é˜µ

### 1.2 ä¼ é€’å‡½æ•°

**å®šä¹‰ 1.2.1** (ä¼ é€’å‡½æ•°)
çº¿æ€§ç³»ç»Ÿçš„ä¼ é€’å‡½æ•°å®šä¹‰ä¸ºï¼š
$$G(s) = C(sI - A)^{-1}B + D$$

**å®šä¹‰ 1.2.2** (ç‰¹å¾å¤šé¡¹å¼)
çº¿æ€§ç³»ç»Ÿçš„ç‰¹å¾å¤šé¡¹å¼å®šä¹‰ä¸ºï¼š
$$\chi(s) = \det(sI - A)$$

**å®šä¹‰ 1.2.3** (æç‚¹)
çº¿æ€§ç³»ç»Ÿçš„æç‚¹æ˜¯ç‰¹å¾å¤šé¡¹å¼çš„æ ¹ï¼Œå³æ»¡è¶³ $\chi(s) = 0$ çš„ $s$ å€¼ã€‚

### 1.3 ç³»ç»Ÿæ€§è´¨

**å®šä¹‰ 1.3.1** (ç¨³å®šæ€§)
çº¿æ€§ç³»ç»Ÿæ˜¯ç¨³å®šçš„ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰æç‚¹éƒ½å…·æœ‰è´Ÿå®éƒ¨ã€‚

**å®šä¹‰ 1.3.2** (å¯æ§æ€§)
çº¿æ€§ç³»ç»Ÿæ˜¯å¯æ§çš„ï¼Œå½“ä¸”ä»…å½“å¯æ§æ€§çŸ©é˜µ $[B, AB, A^2B, \ldots, A^{n-1}B]$ æ»¡ç§©ã€‚

**å®šä¹‰ 1.3.3** (å¯è§‚æ€§)
çº¿æ€§ç³»ç»Ÿæ˜¯å¯è§‚çš„ï¼Œå½“ä¸”ä»…å½“å¯è§‚æ€§çŸ©é˜µ $[C^T, A^TC^T, (A^2)^TC^T, \ldots, (A^{n-1})^TC^T]^T$ æ»¡ç§©ã€‚

## 2. çº¿æ€§ç³»ç»Ÿå»ºæ¨¡

### 2.1 è¿ç»­æ—¶é—´ç³»ç»Ÿ

**å®šä¹‰ 2.1.1** (è¿ç»­æ—¶é—´çº¿æ€§ç³»ç»Ÿ)
è¿ç»­æ—¶é—´çº¿æ€§ç³»ç»Ÿçš„çŠ¶æ€ç©ºé—´æ¨¡å‹ä¸ºï¼š
$$
\begin{align}
\dot{x}(t) &= Ax(t) + Bu(t) \\
y(t) &= Cx(t) + Du(t)
\end{align}
$$

**å®šç† 2.1.1** (çŠ¶æ€è½¬ç§»çŸ©é˜µ)
è¿ç»­æ—¶é—´çº¿æ€§ç³»ç»Ÿçš„çŠ¶æ€è½¬ç§»çŸ©é˜µä¸ºï¼š
$$\Phi(t) = e^{At}$$

**è¯æ˜**ï¼š

1. **å®šä¹‰**ï¼šçŠ¶æ€è½¬ç§»çŸ©é˜µæ»¡è¶³ $\dot{\Phi}(t) = A\Phi(t)$
2. **è§£**ï¼š$\Phi(t) = e^{At}$ æ˜¯å¾®åˆ†æ–¹ç¨‹çš„è§£
3. **æ€§è´¨**ï¼š$e^{At}$ æ»¡è¶³çŸ©é˜µæŒ‡æ•°å‡½æ•°çš„æ€§è´¨

**å®šç† 2.1.2** (çŠ¶æ€è§£)
è¿ç»­æ—¶é—´çº¿æ€§ç³»ç»Ÿçš„çŠ¶æ€è§£ä¸ºï¼š
$$x(t) = e^{At}x(0) + \int_0^t e^{A(t-\tau)}Bu(\tau)d\tau$$

**è¯æ˜**ï¼š

1. **é½æ¬¡è§£**ï¼š$x_h(t) = e^{At}x(0)$
2. **ç‰¹è§£**ï¼š$x_p(t) = \int_0^t e^{A(t-\tau)}Bu(\tau)d\tau$
3. **å…¨è§£**ï¼š$x(t) = x_h(t) + x_p(t)$

### 2.2 ç¦»æ•£æ—¶é—´ç³»ç»Ÿ

**å®šä¹‰ 2.2.1** (ç¦»æ•£æ—¶é—´çº¿æ€§ç³»ç»Ÿ)
ç¦»æ•£æ—¶é—´çº¿æ€§ç³»ç»Ÿçš„çŠ¶æ€ç©ºé—´æ¨¡å‹ä¸ºï¼š
$$
\begin{align}
x(k+1) &= Ax(k) + Bu(k) \\
y(k) &= Cx(k) + Du(k)
\end{align}
$$

**å®šç† 2.2.1** (çŠ¶æ€è½¬ç§»çŸ©é˜µ)
ç¦»æ•£æ—¶é—´çº¿æ€§ç³»ç»Ÿçš„çŠ¶æ€è½¬ç§»çŸ©é˜µä¸ºï¼š
$$\Phi(k) = A^k$$

**è¯æ˜**ï¼š

1. **å®šä¹‰**ï¼šçŠ¶æ€è½¬ç§»çŸ©é˜µæ»¡è¶³ $\Phi(k+1) = A\Phi(k)$
2. **è§£**ï¼š$\Phi(k) = A^k$ æ˜¯å·®åˆ†æ–¹ç¨‹çš„è§£
3. **æ€§è´¨**ï¼š$A^k$ æ»¡è¶³çŸ©é˜µå¹‚å‡½æ•°çš„æ€§è´¨

**å®šç† 2.2.2** (çŠ¶æ€è§£)
ç¦»æ•£æ—¶é—´çº¿æ€§ç³»ç»Ÿçš„çŠ¶æ€è§£ä¸ºï¼š
$$x(k) = A^kx(0) + \sum_{i=0}^{k-1} A^{k-1-i}Bu(i)$$

**è¯æ˜**ï¼š

1. **é½æ¬¡è§£**ï¼š$x_h(k) = A^kx(0)$
2. **ç‰¹è§£**ï¼š$x_p(k) = \sum_{i=0}^{k-1} A^{k-1-i}Bu(i)$
3. **å…¨è§£**ï¼š$x(k) = x_h(k) + x_p(k)$

### 2.3 ç³»ç»Ÿè½¬æ¢

**å®šç† 2.3.1** (ç›¸ä¼¼å˜æ¢)
å¯¹äºéå¥‡å¼‚çŸ©é˜µ $T$ï¼Œç³»ç»Ÿ $(A, B, C, D)$ å’Œ $(T^{-1}AT, T^{-1}B, CT, D)$ å…·æœ‰ç›¸åŒçš„ä¼ é€’å‡½æ•°ã€‚

**è¯æ˜**ï¼š

1. **ä¼ é€’å‡½æ•°**ï¼š$G(s) = C(sI - A)^{-1}B + D$
2. **ç›¸ä¼¼å˜æ¢**ï¼š$G'(s) = CT(sI - T^{-1}AT)^{-1}T^{-1}B + D$
3. **ç®€åŒ–**ï¼š$G'(s) = C(sI - A)^{-1}B + D = G(s)$

**å®šç† 2.3.2** (å¯æ§æ ‡å‡†å‹)
å¯æ§ç³»ç»Ÿå¯ä»¥é€šè¿‡ç›¸ä¼¼å˜æ¢è½¬æ¢ä¸ºå¯æ§æ ‡å‡†å‹ï¼š
$$
A_c = \begin{bmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & 1 \\
-a_n & -a_{n-1} & -a_{n-2} & \cdots & -a_1
\end{bmatrix}
$$

**è¯æ˜**ï¼š

1. **å¯æ§æ€§çŸ©é˜µ**ï¼š$[B, AB, A^2B, \ldots, A^{n-1}B]$ æ»¡ç§©
2. **å˜æ¢çŸ©é˜µ**ï¼š$T = [B, AB, A^2B, \ldots, A^{n-1}B]$
3. **æ ‡å‡†å‹**ï¼š$A_c = T^{-1}AT$

## 3. ç³»ç»Ÿåˆ†æ

### 3.1 ç¨³å®šæ€§åˆ†æ

**å®šç† 3.1.1** (æé›…æ™®è¯ºå¤«ç¨³å®šæ€§)
çº¿æ€§ç³»ç»Ÿ $\dot{x} = Ax$ æ˜¯ç¨³å®šçš„ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨æ­£å®šçŸ©é˜µ $P$ ä½¿å¾—ï¼š
$$A^TP + PA < 0$$

**è¯æ˜**ï¼š

1. **æé›…æ™®è¯ºå¤«å‡½æ•°**ï¼š$V(x) = x^TPx$
2. **å¯¼æ•°**ï¼š$\dot{V}(x) = x^T(A^TP + PA)x$
3. **ç¨³å®šæ€§**ï¼šå¦‚æœ $A^TP + PA < 0$ï¼Œåˆ™ $\dot{V}(x) < 0$

**å®šç† 3.1.2** (èµ«å°”ç»´èŒ¨ç¨³å®šæ€§)
çº¿æ€§ç³»ç»Ÿæ˜¯ç¨³å®šçš„ï¼Œå½“ä¸”ä»…å½“ç‰¹å¾å¤šé¡¹å¼çš„æ‰€æœ‰èµ«å°”ç»´èŒ¨è¡Œåˆ—å¼éƒ½ä¸ºæ­£ã€‚

**è¯æ˜**ï¼š

1. **èµ«å°”ç»´èŒ¨çŸ©é˜µ**ï¼šæ„é€ èµ«å°”ç»´èŒ¨çŸ©é˜µ
2. **è¡Œåˆ—å¼**ï¼šè®¡ç®—æ‰€æœ‰èµ«å°”ç»´èŒ¨è¡Œåˆ—å¼
3. **ç¨³å®šæ€§**ï¼šæ‰€æœ‰è¡Œåˆ—å¼éƒ½ä¸ºæ­£

### 3.2 å¯æ§æ€§åˆ†æ

**å®šç† 3.2.1** (å¯æ§æ€§åˆ¤æ®)
çº¿æ€§ç³»ç»Ÿ $(A, B)$ æ˜¯å¯æ§çš„ï¼Œå½“ä¸”ä»…å½“å¯æ§æ€§çŸ©é˜µ $[B, AB, A^2B, \ldots, A^{n-1}B]$ æ»¡ç§©ã€‚

**è¯æ˜**ï¼š

1. **å¯æ§æ€§å®šä¹‰**ï¼šå¯¹äºä»»æ„åˆå§‹çŠ¶æ€å’Œç›®æ ‡çŠ¶æ€ï¼Œå­˜åœ¨æ§åˆ¶è¾“å…¥
2. **æ ¼æ‹‰å§†çŸ©é˜µ**ï¼šå¯æ§æ€§æ ¼æ‹‰å§†çŸ©é˜µ $W_c = \int_0^T e^{At}BB^Te^{A^Tt}dt$
3. **æ»¡ç§©æ¡ä»¶**ï¼š$W_c$ æ»¡ç§©ç­‰ä»·äºå¯æ§æ€§çŸ©é˜µæ»¡ç§©

**å®šç† 3.2.2** (å¯æ§æ€§åˆ†è§£)
ä¸å¯æ§ç³»ç»Ÿå¯ä»¥é€šè¿‡ç›¸ä¼¼å˜æ¢åˆ†è§£ä¸ºå¯æ§éƒ¨åˆ†å’Œä¸å¯æ§éƒ¨åˆ†ï¼š

$$
\begin{bmatrix}
A_{11} & A_{12} \\
0 & A_{22}
\end{bmatrix}
$$

**è¯æ˜**ï¼š

1. **å¯æ§å­ç©ºé—´**ï¼šæ‰¾åˆ°å¯æ§å­ç©ºé—´
2. **åŸºå˜æ¢**ï¼šé€‰æ‹©é€‚å½“çš„åŸº
3. **åˆ†è§£**ï¼šå¾—åˆ°å¯æ§æ€§åˆ†è§£

### 3.3 å¯è§‚æ€§åˆ†æ

**å®šç† 3.3.1** (å¯è§‚æ€§åˆ¤æ®)
çº¿æ€§ç³»ç»Ÿ $(A, C)$ æ˜¯å¯è§‚çš„ï¼Œå½“ä¸”ä»…å½“å¯è§‚æ€§çŸ©é˜µ $[C^T, A^TC^T, (A^2)^TC^T, \ldots, (A^{n-1})^TC^T]^T$ æ»¡ç§©ã€‚

**è¯æ˜**ï¼š

1. **å¯è§‚æ€§å®šä¹‰**ï¼šé€šè¿‡è¾“å‡ºå¯ä»¥å”¯ä¸€ç¡®å®šåˆå§‹çŠ¶æ€
2. **æ ¼æ‹‰å§†çŸ©é˜µ**ï¼šå¯è§‚æ€§æ ¼æ‹‰å§†çŸ©é˜µ $W_o = \int_0^T e^{A^Tt}C^TCe^{At}dt$
3. **æ»¡ç§©æ¡ä»¶**ï¼š$W_o$ æ»¡ç§©ç­‰ä»·äºå¯è§‚æ€§çŸ©é˜µæ»¡ç§©

**å®šç† 3.3.2** (å¯è§‚æ€§åˆ†è§£)

ä¸å¯è§‚ç³»ç»Ÿå¯ä»¥é€šè¿‡ç›¸ä¼¼å˜æ¢åˆ†è§£ä¸ºå¯è§‚éƒ¨åˆ†å’Œä¸å¯è§‚éƒ¨åˆ†ï¼š

$$
\begin{bmatrix}
A_{11} & 0 \\
A_{21} & A_{22}
\end{bmatrix}\
$$

**è¯æ˜**ï¼š

1. **å¯è§‚å­ç©ºé—´**ï¼šæ‰¾åˆ°å¯è§‚å­ç©ºé—´
2. **åŸºå˜æ¢**ï¼šé€‰æ‹©é€‚å½“çš„åŸº
3. **åˆ†è§£**ï¼šå¾—åˆ°å¯è§‚æ€§åˆ†è§£

## 4. æ§åˆ¶å™¨è®¾è®¡

### 4.1 çŠ¶æ€åé¦ˆæ§åˆ¶

**å®šä¹‰ 4.1.1** (çŠ¶æ€åé¦ˆ)
çŠ¶æ€åé¦ˆæ§åˆ¶å¾‹ä¸ºï¼š
$$u(t) = -Kx(t)$$

å…¶ä¸­ $K \in \mathbb{R}^{m \times n}$ æ˜¯åé¦ˆå¢ç›ŠçŸ©é˜µã€‚

**å®šç† 4.1.1** (æç‚¹é…ç½®)
å¯¹äºå¯æ§ç³»ç»Ÿ $(A, B)$ï¼Œå¯ä»¥é€šè¿‡çŠ¶æ€åé¦ˆ $u = -Kx$ ä»»æ„é…ç½®é—­ç¯æç‚¹ã€‚

**è¯æ˜**ï¼š

1. **é—­ç¯ç³»ç»Ÿ**ï¼š$\dot{x} = (A - BK)x$
2. **ç‰¹å¾å¤šé¡¹å¼**ï¼š$\det(sI - A + BK)$
3. **æç‚¹é…ç½®**ï¼šé€šè¿‡é€‰æ‹© $K$ å¯ä»¥ä»»æ„é…ç½®æç‚¹

**å®šç† 4.1.2** (é˜¿å…‹æ›¼å…¬å¼)
å¯¹äºå¯æ§ç³»ç»Ÿï¼ŒçŠ¶æ€åé¦ˆå¢ç›Šå¯ä»¥é€šè¿‡é˜¿å…‹æ›¼å…¬å¼è®¡ç®—ï¼š
$$K = [0, 0, \ldots, 1][B, AB, A^2B, \ldots, A^{n-1}B]^{-1}\alpha(A)$$

å…¶ä¸­ $\alpha(s)$ æ˜¯æœŸæœ›çš„ç‰¹å¾å¤šé¡¹å¼ã€‚

**è¯æ˜**ï¼š

1. **å¯æ§æ ‡å‡†å‹**ï¼šå°†ç³»ç»Ÿè½¬æ¢ä¸ºå¯æ§æ ‡å‡†å‹
2. **æç‚¹é…ç½®**ï¼šåœ¨æ ‡å‡†å‹ä¸‹é…ç½®æç‚¹
3. **é€†å˜æ¢**ï¼šé€šè¿‡ç›¸ä¼¼å˜æ¢å¾—åˆ°åŸç³»ç»Ÿçš„å¢ç›Š

### 4.2 è¾“å‡ºåé¦ˆæ§åˆ¶

**å®šä¹‰ 4.2.1** (è¾“å‡ºåé¦ˆ)
è¾“å‡ºåé¦ˆæ§åˆ¶å¾‹ä¸ºï¼š
$$u(t) = -Ky(t)$$

å…¶ä¸­ $K \in \mathbb{R}^{m \times p}$ æ˜¯è¾“å‡ºåé¦ˆå¢ç›ŠçŸ©é˜µã€‚

**å®šç† 4.2.1** (è¾“å‡ºåé¦ˆé™åˆ¶)
è¾“å‡ºåé¦ˆçš„æç‚¹é…ç½®èƒ½åŠ›å—åˆ°å¯è§‚æ€§çš„é™åˆ¶ã€‚

**è¯æ˜**ï¼š

1. **é—­ç¯ç³»ç»Ÿ**ï¼š$\dot{x} = (A - BKC)x$
2. **å¯è§‚æ€§**ï¼šéœ€è¦ç³»ç»Ÿå¯è§‚æ‰èƒ½å®ç°æœŸæœ›çš„æç‚¹é…ç½®
3. **é™åˆ¶**ï¼šä¸å¯è§‚éƒ¨åˆ†æ— æ³•é€šè¿‡è¾“å‡ºåé¦ˆæ§åˆ¶

### 4.3 æœ€ä¼˜æ§åˆ¶

**å®šä¹‰ 4.3.1** (äºŒæ¬¡å‹æ€§èƒ½æŒ‡æ ‡)
äºŒæ¬¡å‹æ€§èƒ½æŒ‡æ ‡ä¸ºï¼š
$$J = \int_0^{\infty} (x^TQx + u^TRu)dt$$

å…¶ä¸­ $Q \geq 0$ å’Œ $R > 0$ æ˜¯æƒé‡çŸ©é˜µã€‚

**å®šç† 4.3.1** (çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨)
æœ€ä¼˜æ§åˆ¶å¾‹ä¸ºï¼š
$$u(t) = -R^{-1}B^TPx(t)$$

å…¶ä¸­ $P$ æ˜¯ä»£æ•°é»å¡ææ–¹ç¨‹çš„è§£ï¼š
$$A^TP + PA - PBR^{-1}B^TP + Q = 0$$

**è¯æ˜**ï¼š

1. **å“ˆå¯†é¡¿å‡½æ•°**ï¼š$H = x^TQx + u^TRu + \lambda^T(Ax + Bu)$
2. **æœ€ä¼˜æ¡ä»¶**ï¼š$\frac{\partial H}{\partial u} = 0$
3. **é»å¡ææ–¹ç¨‹**ï¼šé€šè¿‡æœ€ä¼˜æ€§æ¡ä»¶å¾—åˆ°é»å¡ææ–¹ç¨‹

## 5. è§‚æµ‹å™¨è®¾è®¡

### 5.1 å…¨é˜¶è§‚æµ‹å™¨

**å®šä¹‰ 5.1.1** (å…¨é˜¶è§‚æµ‹å™¨)
å…¨é˜¶è§‚æµ‹å™¨çš„çŠ¶æ€æ–¹ç¨‹ä¸ºï¼š
$$\dot{\hat{x}} = A\hat{x} + Bu + L(y - C\hat{x})$$

å…¶ä¸­ $L \in \mathbb{R}^{n \times p}$ æ˜¯è§‚æµ‹å™¨å¢ç›ŠçŸ©é˜µã€‚

**å®šç† 5.1.1** (è§‚æµ‹å™¨æç‚¹é…ç½®)
å¯¹äºå¯è§‚ç³»ç»Ÿ $(A, C)$ï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©è§‚æµ‹å™¨å¢ç›Š $L$ ä»»æ„é…ç½®è§‚æµ‹å™¨æç‚¹ã€‚

**è¯æ˜**ï¼š

1. **è§‚æµ‹è¯¯å·®**ï¼š$\dot{e} = (A - LC)e$
2. **å¯¹å¶æ€§**ï¼šè§‚æµ‹å™¨è®¾è®¡ä¸çŠ¶æ€åé¦ˆè®¾è®¡å¯¹å¶
3. **æç‚¹é…ç½®**ï¼šé€šè¿‡é€‰æ‹© $L$ å¯ä»¥ä»»æ„é…ç½®æç‚¹

**å®šç† 5.1.2** (é˜¿å…‹æ›¼å…¬å¼)
è§‚æµ‹å™¨å¢ç›Šå¯ä»¥é€šè¿‡é˜¿å…‹æ›¼å…¬å¼è®¡ç®—ï¼š
$$L = \alpha[A](C^T, A^TC^T, (A^2)^TC^T, \ldots, (A^{n-1})^TC^T)^{-1}[0, 0, \ldots, 1]^T$$

å…¶ä¸­ $\alpha(s)$ æ˜¯æœŸæœ›çš„è§‚æµ‹å™¨ç‰¹å¾å¤šé¡¹å¼ã€‚

**è¯æ˜**ï¼š

1. **å¯è§‚æ ‡å‡†å‹**ï¼šå°†ç³»ç»Ÿè½¬æ¢ä¸ºå¯è§‚æ ‡å‡†å‹
2. **æç‚¹é…ç½®**ï¼šåœ¨æ ‡å‡†å‹ä¸‹é…ç½®æç‚¹
3. **é€†å˜æ¢**ï¼šé€šè¿‡ç›¸ä¼¼å˜æ¢å¾—åˆ°åŸç³»ç»Ÿçš„å¢ç›Š

### 5.2 é™é˜¶è§‚æµ‹å™¨

**å®šä¹‰ 5.2.1** (é™é˜¶è§‚æµ‹å™¨)
é™é˜¶è§‚æµ‹å™¨åªä¼°è®¡ä¸å¯è§‚éƒ¨åˆ†çš„çŠ¶æ€ã€‚

**å®šç† 5.2.1** (é™é˜¶è§‚æµ‹å™¨è®¾è®¡)
å¯¹äºå¯è§‚ç³»ç»Ÿï¼Œå¯ä»¥è®¾è®¡é™é˜¶è§‚æµ‹å™¨ä¼°è®¡ä¸å¯è§‚éƒ¨åˆ†ã€‚

**è¯æ˜**ï¼š

1. **å¯è§‚æ€§åˆ†è§£**ï¼šå°†ç³»ç»Ÿåˆ†è§£ä¸ºå¯è§‚å’Œä¸å¯è§‚éƒ¨åˆ†
2. **é™é˜¶è®¾è®¡**ï¼šåªè®¾è®¡ä¸å¯è§‚éƒ¨åˆ†çš„è§‚æµ‹å™¨
3. **çŠ¶æ€ä¼°è®¡**ï¼šé€šè¿‡å¯è§‚éƒ¨åˆ†å’Œé™é˜¶è§‚æµ‹å™¨ä¼°è®¡å®Œæ•´çŠ¶æ€

## 6. ç®—æ³•å®ç°

### 6.1 çº¿æ€§ç³»ç»Ÿç±»

```python
import numpy as np
from scipy import linalg
from scipy.integrate import odeint
import matplotlib.pyplot as plt

class LinearSystem:
    """çº¿æ€§ç³»ç»Ÿç±»"""

    def __init__(self, A, B, C, D=None):
        """
        åˆå§‹åŒ–çº¿æ€§ç³»ç»Ÿ

        Parameters:
        A: ç³»ç»ŸçŸ©é˜µ (n x n)
        B: è¾“å…¥çŸ©é˜µ (n x m)
        C: è¾“å‡ºçŸ©é˜µ (p x n)
        D: ç›´æ¥ä¼ é€’çŸ©é˜µ (p x m), é»˜è®¤ä¸ºé›¶çŸ©é˜µ
        """
        self.A = np.array(A)
        self.B = np.array(B)
        self.C = np.array(C)
        self.D = np.array(D) if D is not None else np.zeros((C.shape[0], B.shape[1]))

        self.n = self.A.shape[0]  # çŠ¶æ€ç»´åº¦
        self.m = self.B.shape[1]  # è¾“å…¥ç»´åº¦
        self.p = self.C.shape[0]  # è¾“å‡ºç»´åº¦

        # éªŒè¯ç»´åº¦ä¸€è‡´æ€§
        self._validate_dimensions()

    def _validate_dimensions(self):
        """éªŒè¯çŸ©é˜µç»´åº¦çš„ä¸€è‡´æ€§"""
        assert self.A.shape == (self.n, self.n), "AçŸ©é˜µç»´åº¦é”™è¯¯"
        assert self.B.shape == (self.n, self.m), "BçŸ©é˜µç»´åº¦é”™è¯¯"
        assert self.C.shape == (self.p, self.n), "CçŸ©é˜µç»´åº¦é”™è¯¯"
        assert self.D.shape == (self.p, self.m), "DçŸ©é˜µç»´åº¦é”™è¯¯"

    def transfer_function(self, s):
        """è®¡ç®—ä¼ é€’å‡½æ•°åœ¨ç»™å®šså€¼å¤„çš„å€¼"""
        try:
            G = self.C @ linalg.inv(s * np.eye(self.n) - self.A) @ self.B + self.D
            return G
        except linalg.LinAlgError:
            return np.inf

    def characteristic_polynomial(self):
        """è®¡ç®—ç‰¹å¾å¤šé¡¹å¼ç³»æ•°"""
        return np.poly(self.A)

    def poles(self):
        """è®¡ç®—ç³»ç»Ÿæç‚¹"""
        return linalg.eigvals(self.A)

    def zeros(self):
        """è®¡ç®—ç³»ç»Ÿé›¶ç‚¹"""
        # ç®€åŒ–å®ç°ï¼Œå®é™…éœ€è¦æ›´å¤æ‚çš„ç®—æ³•
        return []

    def is_stable(self):
        """åˆ¤æ–­ç³»ç»Ÿæ˜¯å¦ç¨³å®š"""
        poles = self.poles()
        return all(np.real(pole) < 0 for pole in poles)

    def controllability_matrix(self):
        """è®¡ç®—å¯æ§æ€§çŸ©é˜µ"""
        C = np.zeros((self.n, self.n * self.m))
        for i in range(self.n):
            C[:, i*self.m:(i+1)*self.m] = linalg.matrix_power(self.A, i) @ self.B
        return C

    def observability_matrix(self):
        """è®¡ç®—å¯è§‚æ€§çŸ©é˜µ"""
        O = np.zeros((self.n * self.p, self.n))
        for i in range(self.n):
            O[i*self.p:(i+1)*self.p, :] = self.C @ linalg.matrix_power(self.A, i)
        return O.T

    def is_controllable(self):
        """åˆ¤æ–­ç³»ç»Ÿæ˜¯å¦å¯æ§"""
        C = self.controllability_matrix()
        return np.linalg.matrix_rank(C) == self.n

    def is_observable(self):
        """åˆ¤æ–­ç³»ç»Ÿæ˜¯å¦å¯è§‚"""
        O = self.observability_matrix()
        return np.linalg.matrix_rank(O) == self.n

    def simulate(self, t, x0, u_func):
        """
        æ¨¡æ‹Ÿç³»ç»Ÿå“åº”

        Parameters:
        t: æ—¶é—´å‘é‡
        x0: åˆå§‹çŠ¶æ€
        u_func: è¾“å…¥å‡½æ•° u(t)

        Returns:
        x: çŠ¶æ€è½¨è¿¹
        y: è¾“å‡ºè½¨è¿¹
        """
        def system_dynamics(x, t):
            u = u_func(t)
            return self.A @ x + self.B @ u

        x = odeint(system_dynamics, x0, t)
        y = np.array([self.C @ xi + self.D @ u_func(ti) for xi, ti in zip(x, t)])

        return x, y

    def step_response(self, t, x0=None):
        """è®¡ç®—é˜¶è·ƒå“åº”"""
        if x0 is None:
            x0 = np.zeros(self.n)

        def step_input(t):
            return np.ones(self.m) if t >= 0 else np.zeros(self.m)

        return self.simulate(t, x0, step_input)

    def impulse_response(self, t, x0=None):
        """è®¡ç®—è„‰å†²å“åº”"""
        if x0 is None:
            x0 = np.zeros(self.n)

        def impulse_input(t):
            return np.zeros(self.m)  # ç®€åŒ–å®ç°

        return self.simulate(t, x0, impulse_input)

class StateFeedbackController:
    """çŠ¶æ€åé¦ˆæ§åˆ¶å™¨"""

    def __init__(self, K):
        """
        åˆå§‹åŒ–çŠ¶æ€åé¦ˆæ§åˆ¶å™¨

        Parameters:
        K: åé¦ˆå¢ç›ŠçŸ©é˜µ
        """
        self.K = np.array(K)

    def control_law(self, x):
        """è®¡ç®—æ§åˆ¶è¾“å…¥"""
        return -self.K @ x

    def closed_loop_system(self, system):
        """è®¡ç®—é—­ç¯ç³»ç»Ÿ"""
        A_cl = system.A - system.B @ self.K
        B_cl = system.B
        C_cl = system.C - system.D @ self.K
        D_cl = system.D

        return LinearSystem(A_cl, B_cl, C_cl, D_cl)

class Observer:
    """å…¨é˜¶è§‚æµ‹å™¨"""

    def __init__(self, L):
        """
        åˆå§‹åŒ–è§‚æµ‹å™¨

        Parameters:
        L: è§‚æµ‹å™¨å¢ç›ŠçŸ©é˜µ
        """
        self.L = np.array(L)
        self.x_hat = None

    def estimate(self, y, u, dt):
        """ä¼°è®¡çŠ¶æ€"""
        if self.x_hat is None:
            self.x_hat = np.zeros(self.L.shape[0])

        # ç®€åŒ–çš„æ¬§æ‹‰ç§¯åˆ†
        self.x_hat += dt * (self.A @ self.x_hat + self.B @ u + self.L @ (y - self.C @ self.x_hat))
        return self.x_hat

    def set_system(self, system):
        """è®¾ç½®ç³»ç»Ÿå‚æ•°"""
        self.A = system.A
        self.B = system.B
        self.C = system.C
        self.D = system.D

class LQRController:
    """çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨"""

    def __init__(self, Q, R):
        """
        åˆå§‹åŒ–LQRæ§åˆ¶å™¨

        Parameters:
        Q: çŠ¶æ€æƒé‡çŸ©é˜µ
        R: è¾“å…¥æƒé‡çŸ©é˜µ
        """
        self.Q = np.array(Q)
        self.R = np.array(R)
        self.K = None

    def solve_riccati(self, system):
        """æ±‚è§£ä»£æ•°é»å¡ææ–¹ç¨‹"""
        A = system.A
        B = system.B
        Q = self.Q
        R = self.R

        # ä½¿ç”¨scipyæ±‚è§£è¿ç»­æ—¶é—´ä»£æ•°é»å¡ææ–¹ç¨‹
        P = linalg.solve_continuous_are(A, B, Q, R)
        self.K = linalg.inv(R) @ B.T @ P

        return self.K

    def control_law(self, x):
        """è®¡ç®—æ§åˆ¶è¾“å…¥"""
        if self.K is None:
            raise ValueError("è¯·å…ˆè°ƒç”¨solve_riccatiæ–¹æ³•")
        return -self.K @ x

class SystemAnalyzer:
    """ç³»ç»Ÿåˆ†æå™¨"""

    def __init__(self):
        self.analysis_results = {}

    def analyze_system(self, system):
        """åˆ†æç³»ç»Ÿæ€§è´¨"""
        analysis = {
            'stability': system.is_stable(),
            'controllability': system.is_controllable(),
            'observability': system.is_observable(),
            'poles': system.poles(),
            'zeros': system.zeros(),
            'characteristic_polynomial': system.characteristic_polynomial()
        }

        self.analysis_results[id(system)] = analysis
        return analysis

    def plot_poles(self, system, title="ç³»ç»Ÿæç‚¹"):
        """ç»˜åˆ¶ç³»ç»Ÿæç‚¹"""
        poles = system.poles()

        plt.figure(figsize=(8, 6))
        plt.scatter(np.real(poles), np.imag(poles), c='red', s=100, marker='x')
        plt.axhline(y=0, color='k', linestyle='-', alpha=0.3)
        plt.axvline(x=0, color='k', linestyle='-', alpha=0.3)
        plt.grid(True, alpha=0.3)
        plt.xlabel('å®éƒ¨')
        plt.ylabel('è™šéƒ¨')
        plt.title(title)
        plt.axis('equal')
        plt.show()

    def plot_step_response(self, system, t, title="é˜¶è·ƒå“åº”"):
        """ç»˜åˆ¶é˜¶è·ƒå“åº”"""
        x, y = system.step_response(t)

        plt.figure(figsize=(12, 8))

        # ç»˜åˆ¶çŠ¶æ€å“åº”
        plt.subplot(2, 1, 1)
        for i in range(system.n):
            plt.plot(t, x[:, i], label=f'x{i+1}')
        plt.xlabel('æ—¶é—´')
        plt.ylabel('çŠ¶æ€')
        plt.title('çŠ¶æ€å“åº”')
        plt.legend()
        plt.grid(True)

        # ç»˜åˆ¶è¾“å‡ºå“åº”
        plt.subplot(2, 1, 2)
        for i in range(system.p):
            plt.plot(t, y[:, i], label=f'y{i+1}')
        plt.xlabel('æ—¶é—´')
        plt.ylabel('è¾“å‡º')
        plt.title('è¾“å‡ºå“åº”')
        plt.legend()
        plt.grid(True)

        plt.tight_layout()
        plt.show()

    def generate_report(self, system):
        """ç”Ÿæˆç³»ç»Ÿåˆ†ææŠ¥å‘Š"""
        analysis = self.analyze_system(system)

        report = f"""
çº¿æ€§ç³»ç»Ÿåˆ†ææŠ¥å‘Š
================

ç³»ç»Ÿå‚æ•°:
- çŠ¶æ€ç»´åº¦: {system.n}
- è¾“å…¥ç»´åº¦: {system.m}
- è¾“å‡ºç»´åº¦: {system.p}

ç³»ç»Ÿæ€§è´¨:
- ç¨³å®šæ€§: {'ç¨³å®š' if analysis['stability'] else 'ä¸ç¨³å®š'}
- å¯æ§æ€§: {'å¯æ§' if analysis['controllability'] else 'ä¸å¯æ§'}
- å¯è§‚æ€§: {'å¯è§‚' if analysis['observability'] else 'ä¸å¯è§‚'}

ç³»ç»Ÿæç‚¹:
{analysis['poles']}

ç‰¹å¾å¤šé¡¹å¼ç³»æ•°:
{analysis['characteristic_polynomial']}
        """

        return report
```

### 6.2 æ§åˆ¶å™¨è®¾è®¡å·¥å…·

```python
class ControllerDesigner:
    """æ§åˆ¶å™¨è®¾è®¡å·¥å…·"""

    def __init__(self):
        self.design_results = {}

    def pole_placement(self, system, desired_poles):
        """
        æç‚¹é…ç½®è®¾è®¡

        Parameters:
        system: çº¿æ€§ç³»ç»Ÿ
        desired_poles: æœŸæœ›çš„é—­ç¯æç‚¹

        Returns:
        K: åé¦ˆå¢ç›ŠçŸ©é˜µ
        """
        if not system.is_controllable():
            raise ValueError("ç³»ç»Ÿä¸å¯æ§ï¼Œæ— æ³•è¿›è¡Œæç‚¹é…ç½®")

        # é˜¿å…‹æ›¼å…¬å¼
        A = system.A
        B = system.B
        n = system.n

        # è®¡ç®—å¯æ§æ€§çŸ©é˜µ
        C = system.controllability_matrix()

        # è®¡ç®—æœŸæœ›ç‰¹å¾å¤šé¡¹å¼
        alpha = np.poly(desired_poles)

        # è®¡ç®—é˜¿å…‹æ›¼å…¬å¼
        alpha_A = np.zeros_like(A)
        for i, coeff in enumerate(alpha[:-1]):
            alpha_A += coeff * linalg.matrix_power(A, i)

        # è®¡ç®—åé¦ˆå¢ç›Š
        K = np.array([0, 0, 1]) @ linalg.inv(C) @ alpha_A

        return K

    def lqr_design(self, system, Q, R):
        """
        LQRæ§åˆ¶å™¨è®¾è®¡

        Parameters:
        system: çº¿æ€§ç³»ç»Ÿ
        Q: çŠ¶æ€æƒé‡çŸ©é˜µ
        R: è¾“å…¥æƒé‡çŸ©é˜µ

        Returns:
        K: åé¦ˆå¢ç›ŠçŸ©é˜µ
        """
        lqr = LQRController(Q, R)
        K = lqr.solve_riccati(system)
        return K

    def observer_design(self, system, desired_observer_poles):
        """
        è§‚æµ‹å™¨è®¾è®¡

        Parameters:
        system: çº¿æ€§ç³»ç»Ÿ
        desired_observer_poles: æœŸæœ›çš„è§‚æµ‹å™¨æç‚¹

        Returns:
        L: è§‚æµ‹å™¨å¢ç›ŠçŸ©é˜µ
        """
        if not system.is_observable():
            raise ValueError("ç³»ç»Ÿä¸å¯è§‚ï¼Œæ— æ³•è®¾è®¡è§‚æµ‹å™¨")

        # å¯¹å¶ç³»ç»Ÿ
        A_dual = system.A.T
        B_dual = system.C.T
        C_dual = system.B.T

        # è®¾è®¡å¯¹å¶ç³»ç»Ÿçš„çŠ¶æ€åé¦ˆ
        K_dual = self.pole_placement(LinearSystem(A_dual, B_dual, C_dual),
                                   desired_observer_poles)

        # è§‚æµ‹å™¨å¢ç›Šæ˜¯å¯¹å¶ç³»ç»Ÿåé¦ˆå¢ç›Šçš„è½¬ç½®
        L = K_dual.T

        return L

    def robust_controller_design(self, system, uncertainty_model):
        """
        é²æ£’æ§åˆ¶å™¨è®¾è®¡

        Parameters:
        system: çº¿æ€§ç³»ç»Ÿ
        uncertainty_model: ä¸ç¡®å®šæ€§æ¨¡å‹

        Returns:
        K: é²æ£’åé¦ˆå¢ç›ŠçŸ©é˜µ
        """
        # ç®€åŒ–å®ç°ï¼Œå®é™…éœ€è¦æ›´å¤æ‚çš„é²æ£’æ§åˆ¶ç®—æ³•
        Q = np.eye(system.n)
        R = np.eye(system.m)

        return self.lqr_design(system, Q, R)

    def adaptive_controller_design(self, system, adaptation_law):
        """
        è‡ªé€‚åº”æ§åˆ¶å™¨è®¾è®¡

        Parameters:
        system: çº¿æ€§ç³»ç»Ÿ
        adaptation_law: è‡ªé€‚åº”å¾‹

        Returns:
        controller: è‡ªé€‚åº”æ§åˆ¶å™¨
        """
        # ç®€åŒ–å®ç°ï¼Œå®é™…éœ€è¦æ›´å¤æ‚çš„è‡ªé€‚åº”æ§åˆ¶ç®—æ³•
        class AdaptiveController:
            def __init__(self, system, adaptation_law):
                self.system = system
                self.adaptation_law = adaptation_law
                self.parameter_estimate = None

            def control_law(self, x, t):
                # è‡ªé€‚åº”æ§åˆ¶å¾‹
                if self.parameter_estimate is None:
                    self.parameter_estimate = np.zeros(system.n)

                # æ›´æ–°å‚æ•°ä¼°è®¡
                self.parameter_estimate += self.adaptation_law(x, t)

                # è®¡ç®—æ§åˆ¶è¾“å…¥
                K = -self.parameter_estimate
                return K @ x

        return AdaptiveController(system, adaptation_law)

class SystemSimulator:
    """ç³»ç»Ÿä»¿çœŸå™¨"""

    def __init__(self):
        self.simulation_results = {}

    def simulate_closed_loop(self, system, controller, t, x0, reference=None):
        """
        ä»¿çœŸé—­ç¯ç³»ç»Ÿ

        Parameters:
        system: çº¿æ€§ç³»ç»Ÿ
        controller: æ§åˆ¶å™¨
        t: æ—¶é—´å‘é‡
        x0: åˆå§‹çŠ¶æ€
        reference: å‚è€ƒä¿¡å·

        Returns:
        x: çŠ¶æ€è½¨è¿¹
        y: è¾“å‡ºè½¨è¿¹
        u: æ§åˆ¶è¾“å…¥è½¨è¿¹
        """
        n_steps = len(t)
        dt = t[1] - t[0]

        x = np.zeros((n_steps, system.n))
        y = np.zeros((n_steps, system.p))
        u = np.zeros((n_steps, system.m))

        x[0] = x0

        for i in range(1, n_steps):
            # è®¡ç®—æ§åˆ¶è¾“å…¥
            if reference is not None:
                error = reference[i] - y[i-1]
                u[i-1] = controller.control_law(error)
            else:
                u[i-1] = controller.control_law(x[i-1])

            # æ›´æ–°çŠ¶æ€
            dx = system.A @ x[i-1] + system.B @ u[i-1]
            x[i] = x[i-1] + dt * dx

            # è®¡ç®—è¾“å‡º
            y[i] = system.C @ x[i] + system.D @ u[i-1]

        return x, y, u

    def plot_simulation_results(self, t, x, y, u, title="ä»¿çœŸç»“æœ"):
        """ç»˜åˆ¶ä»¿çœŸç»“æœ"""
        plt.figure(figsize=(15, 10))

        # ç»˜åˆ¶çŠ¶æ€
        plt.subplot(3, 1, 1)
        for i in range(x.shape[1]):
            plt.plot(t, x[:, i], label=f'x{i+1}')
        plt.xlabel('æ—¶é—´')
        plt.ylabel('çŠ¶æ€')
        plt.title('çŠ¶æ€è½¨è¿¹')
        plt.legend()
        plt.grid(True)

        # ç»˜åˆ¶è¾“å‡º
        plt.subplot(3, 1, 2)
        for i in range(y.shape[1]):
            plt.plot(t, y[:, i], label=f'y{i+1}')
        plt.xlabel('æ—¶é—´')
        plt.ylabel('è¾“å‡º')
        plt.title('è¾“å‡ºè½¨è¿¹')
        plt.legend()
        plt.grid(True)

        # ç»˜åˆ¶æ§åˆ¶è¾“å…¥
        plt.subplot(3, 1, 3)
        for i in range(u.shape[1]):
            plt.plot(t, u[:, i], label=f'u{i+1}')
        plt.xlabel('æ—¶é—´')
        plt.ylabel('æ§åˆ¶è¾“å…¥')
        plt.title('æ§åˆ¶è¾“å…¥')
        plt.legend()
        plt.grid(True)

        plt.tight_layout()
        plt.show()

    def analyze_performance(self, x, y, u, reference=None):
        """åˆ†ææ§åˆ¶æ€§èƒ½"""
        performance = {
            'settling_time': self._calculate_settling_time(y, reference),
            'overshoot': self._calculate_overshoot(y, reference),
            'steady_state_error': self._calculate_steady_state_error(y, reference),
            'control_effort': np.sum(u**2),
            'state_variance': np.var(x, axis=0)
        }

        return performance

    def _calculate_settling_time(self, y, reference, tolerance=0.05):
        """è®¡ç®— settling time"""
        if reference is None:
            reference = np.ones_like(y)

        error = np.abs(y - reference)
        settled = error < tolerance

        for i in range(len(settled)):
            if np.all(settled[i:]):
                return i

        return len(settled)

    def _calculate_overshoot(self, y, reference):
        """è®¡ç®—è¶…è°ƒé‡"""
        if reference is None:
            reference = np.ones_like(y)

        overshoot = np.max(y - reference, axis=0)
        return overshoot

    def _calculate_steady_state_error(self, y, reference):
        """è®¡ç®—ç¨³æ€è¯¯å·®"""
        if reference is None:
            reference = np.ones_like(y)

        # ä½¿ç”¨æœ€å10%çš„æ•°æ®è®¡ç®—ç¨³æ€è¯¯å·®
        n = len(y)
        steady_state = y[int(0.9*n):]
        steady_reference = reference[int(0.9*n):]

        error = np.mean(steady_state - steady_reference, axis=0)
        return error
```

## 7. åº”ç”¨ç¤ºä¾‹

### 7.1 åŸºæœ¬ç³»ç»Ÿåˆ†æç¤ºä¾‹

```python
# åˆ›å»ºçº¿æ€§ç³»ç»Ÿ
A = np.array([[0, 1], [-1, -2]])
B = np.array([[0], [1]])
C = np.array([[1, 0]])
D = np.array([[0]])

system = LinearSystem(A, B, C, D)

# åˆ†æç³»ç»Ÿ
analyzer = SystemAnalyzer()
analysis = analyzer.analyze_system(system)

print("ç³»ç»Ÿåˆ†æç»“æœ:")
print(f"ç¨³å®šæ€§: {'ç¨³å®š' if analysis['stability'] else 'ä¸ç¨³å®š'}")
print(f"å¯æ§æ€§: {'å¯æ§' if analysis['controllability'] else 'ä¸å¯æ§'}")
print(f"å¯è§‚æ€§: {'å¯è§‚' if analysis['observability'] else 'ä¸å¯è§‚'}")
print(f"æç‚¹: {analysis['poles']}")

# ç»˜åˆ¶æç‚¹
analyzer.plot_poles(system)

# ä»¿çœŸé˜¶è·ƒå“åº”
t = np.linspace(0, 10, 1000)
x, y = system.step_response(t)
analyzer.plot_step_response(system, t)
```

### 7.2 æ§åˆ¶å™¨è®¾è®¡ç¤ºä¾‹

```python
# æç‚¹é…ç½®è®¾è®¡
desired_poles = [-2, -3]
designer = ControllerDesigner()
K = designer.pole_placement(system, desired_poles)

print(f"åé¦ˆå¢ç›ŠçŸ©é˜µ: {K}")

# åˆ›å»ºçŠ¶æ€åé¦ˆæ§åˆ¶å™¨
controller = StateFeedbackController(K)

# ä»¿çœŸé—­ç¯ç³»ç»Ÿ
t = np.linspace(0, 10, 1000)
x0 = np.array([1, 0])

simulator = SystemSimulator()
x, y, u = simulator.simulate_closed_loop(system, controller, t, x0)

# ç»˜åˆ¶ä»¿çœŸç»“æœ
simulator.plot_simulation_results(t, x, y, u)

# åˆ†ææ€§èƒ½
performance = simulator.analyze_performance(x, y, u)
print(f"æ§åˆ¶æ€§èƒ½: {performance}")
```

### 7.3 LQRæ§åˆ¶å™¨è®¾è®¡ç¤ºä¾‹

```python
# LQRæ§åˆ¶å™¨è®¾è®¡
Q = np.eye(2)  # çŠ¶æ€æƒé‡
R = np.eye(1)  # è¾“å…¥æƒé‡

K_lqr = designer.lqr_design(system, Q, R)
print(f"LQRåé¦ˆå¢ç›Š: {K_lqr}")

# åˆ›å»ºLQRæ§åˆ¶å™¨
lqr_controller = StateFeedbackController(K_lqr)

# ä»¿çœŸLQRæ§åˆ¶
x_lqr, y_lqr, u_lqr = simulator.simulate_closed_loop(system, lqr_controller, t, x0)

# æ¯”è¾ƒæ€§èƒ½
performance_lqr = simulator.analyze_performance(x_lqr, y_lqr, u_lqr)
print(f"LQRæ§åˆ¶æ€§èƒ½: {performance_lqr}")
```

### 7.4 è§‚æµ‹å™¨è®¾è®¡ç¤ºä¾‹

```python
# è§‚æµ‹å™¨è®¾è®¡
desired_observer_poles = [-5, -6]
L = designer.observer_design(system, desired_observer_poles)

print(f"è§‚æµ‹å™¨å¢ç›ŠçŸ©é˜µ: {L}")

# åˆ›å»ºè§‚æµ‹å™¨
observer = Observer(L)
observer.set_system(system)

# ä»¿çœŸå¸¦è§‚æµ‹å™¨çš„ç³»ç»Ÿ
x_obs = np.zeros((len(t), system.n))
x_hat = np.zeros((len(t), system.n))

for i in range(len(t)):
    if i == 0:
        x_obs[i] = x0
        x_hat[i] = np.zeros(system.n)
    else:
        # çœŸå®ç³»ç»Ÿ
        u_obs = controller.control_law(x_hat[i-1])
        dx = system.A @ x_obs[i-1] + system.B @ u_obs
        x_obs[i] = x_obs[i-1] + dt * dx

        # è§‚æµ‹å™¨
        y_obs = system.C @ x_obs[i]
        x_hat[i] = observer.estimate(y_obs, u_obs, dt)

# ç»˜åˆ¶è§‚æµ‹ç»“æœ
plt.figure(figsize=(12, 8))
for i in range(system.n):
    plt.subplot(system.n, 1, i+1)
    plt.plot(t, x_obs[:, i], label=f'çœŸå®çŠ¶æ€ x{i+1}')
    plt.plot(t, x_hat[:, i], '--', label=f'ä¼°è®¡çŠ¶æ€ x{i+1}')
    plt.xlabel('æ—¶é—´')
    plt.ylabel(f'çŠ¶æ€ x{i+1}')
    plt.legend()
    plt.grid(True)

plt.tight_layout()
plt.show()
```

## æ‰¹åˆ¤æ€§åˆ†æ

### å¤šå…ƒç†è®ºè§†è§’

- ç³»ç»Ÿè§†è§’ï¼šçº¿æ€§æ§åˆ¶ç†è®ºä¸ºåŠ¨æ€ç³»ç»Ÿæä¾›ç»Ÿä¸€çš„å»ºæ¨¡æ¡†æ¶ï¼Œé€šè¿‡çŠ¶æ€ç©ºé—´æ–¹æ³•å®ç°ç³»ç»Ÿè¡Œä¸ºçš„ç²¾ç¡®æè¿°ã€‚
- ä¼˜åŒ–è§†è§’ï¼šLQRã€LQGç­‰æœ€ä¼˜æ§åˆ¶æ–¹æ³•å°†æ§åˆ¶é—®é¢˜è½¬åŒ–ä¸ºæ•°å­¦ä¼˜åŒ–é—®é¢˜ï¼Œæä¾›æ€§èƒ½æœ€ä¼˜çš„è§£å†³æ–¹æ¡ˆã€‚
- å‡ ä½•è§†è§’ï¼šå¯æ§æ€§ã€å¯è§‚æ€§ç­‰æ¦‚å¿µå…·æœ‰æ·±åˆ»çš„å‡ ä½•æ„ä¹‰ï¼Œé€šè¿‡å­ç©ºé—´ç†è®ºæ­ç¤ºç³»ç»Ÿç»“æ„ã€‚
- ä»£æ•°è§†è§’ï¼šæç‚¹é…ç½®ã€ç‰¹å¾å€¼åˆ†è§£ç­‰ä»£æ•°æ–¹æ³•ä¸ºæ§åˆ¶å™¨è®¾è®¡æä¾›ç³»ç»ŸåŒ–å·¥å…·ã€‚

### å±€é™æ€§

- çº¿æ€§å‡è®¾é™åˆ¶ï¼šä¸¥æ ¼çš„çº¿æ€§å‡è®¾é™åˆ¶äº†åœ¨å¼ºéçº¿æ€§ç³»ç»Ÿä¸­çš„åº”ç”¨ï¼Œéœ€è¦å¤æ‚çš„çº¿æ€§åŒ–å¤„ç†ã€‚
- æ¨¡å‹ä¾èµ–æ€§ï¼šæ§åˆ¶æ€§èƒ½é«˜åº¦ä¾èµ–ç³»ç»Ÿæ¨¡å‹çš„å‡†ç¡®æ€§ï¼Œå»ºæ¨¡è¯¯å·®ä¼šæ˜¾è‘—å½±å“æ§åˆ¶æ•ˆæœã€‚
- é²æ£’æ€§ä¸è¶³ï¼šå¯¹å‚æ•°å˜åŒ–ã€å¤–éƒ¨å¹²æ‰°çš„é²æ£’æ€§æœ‰é™ï¼Œéœ€è¦é¢å¤–çš„é²æ£’æ§åˆ¶æŠ€æœ¯ã€‚
- è®¡ç®—å¤æ‚æ€§ï¼šé«˜ç»´ç³»ç»Ÿçš„æ§åˆ¶å™¨è®¾è®¡å­˜åœ¨è®¡ç®—å¤æ‚åº¦é—®é¢˜ï¼Œå®æ—¶æ€§éš¾ä»¥ä¿è¯ã€‚

### äº‰è®®ä¸åˆ†æ­§

- å»ºæ¨¡æ–¹æ³•ï¼šç²¾ç¡®å»ºæ¨¡vsç®€åŒ–å»ºæ¨¡ï¼Œå¤æ‚æ€§ä¸å®ç”¨æ€§ä¹‹é—´çš„å¹³è¡¡äº‰è®®ã€‚
- æ§åˆ¶ç­–ç•¥ï¼šæœ€ä¼˜æ§åˆ¶vsé²æ£’æ§åˆ¶ï¼Œæ€§èƒ½ä¸é²æ£’æ€§ä¹‹é—´çš„æƒè¡¡é—®é¢˜ã€‚
- è®¾è®¡æ–¹æ³•ï¼šé¢‘åŸŸæ–¹æ³•vsæ—¶åŸŸæ–¹æ³•ï¼Œä¸åŒè®¾è®¡èŒƒå¼çš„ä¼˜åŠ£ä¹‹äº‰ã€‚
- åº”ç”¨èŒƒå›´ï¼šç†è®ºå®Œç¾vså·¥ç¨‹å®ç”¨ï¼Œå­¦æœ¯ç ”ç©¶ä¸å®é™…åº”ç”¨çš„å·®å¼‚ã€‚

### åº”ç”¨å‰æ™¯

- æ™ºèƒ½æ§åˆ¶ï¼šç»“åˆæœºå™¨å­¦ä¹ ã€ç¥ç»ç½‘ç»œç­‰æ™ºèƒ½æ–¹æ³•ï¼Œå®ç°è‡ªé€‚åº”æ§åˆ¶ã€‚
- ç½‘ç»œæ§åˆ¶ï¼šåœ¨ç½‘ç»œåŒ–æ§åˆ¶ç³»ç»Ÿä¸­åº”ç”¨ï¼Œå¤„ç†é€šä¿¡å»¶è¿Ÿã€ä¸¢åŒ…ç­‰é—®é¢˜ã€‚
- é‡å­æ§åˆ¶ï¼šåœ¨é‡å­ç³»ç»Ÿä¸­åº”ç”¨ï¼Œä¸ºé‡å­è®¡ç®—ã€é‡å­é€šä¿¡æä¾›æ§åˆ¶æ–¹æ³•ã€‚
- ç”Ÿç‰©æ§åˆ¶ï¼šåœ¨ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹ä¸­åº”ç”¨ï¼Œå¦‚è¯ç‰©è¾“é€ã€ç¥ç»è°ƒæ§ç­‰ã€‚

### æ”¹è¿›å»ºè®®

- å‘å±•éçº¿æ€§æ§åˆ¶ï¼šæ‰©å±•çº¿æ€§ç†è®ºåˆ°éçº¿æ€§ç³»ç»Ÿï¼Œå¦‚åé¦ˆçº¿æ€§åŒ–ã€æ»‘æ¨¡æ§åˆ¶ç­‰ã€‚
- åŠ å¼ºé²æ£’æ€§ç ”ç©¶ï¼šå¼€å‘é²æ£’æ§åˆ¶æ–¹æ³•ï¼Œå¦‚Hâˆæ§åˆ¶ã€Î¼ç»¼åˆç­‰ã€‚
- æ¨è¿›æ™ºèƒ½æ§åˆ¶ï¼šç»“åˆäººå·¥æ™ºèƒ½æŠ€æœ¯ï¼Œå®ç°è‡ªé€‚åº”ã€è‡ªå­¦ä¹ æ§åˆ¶ã€‚
- è·¨å­¦ç§‘æ•´åˆï¼šä¸æ§åˆ¶è®ºã€ç³»ç»Ÿè®ºã€ä¿¡æ¯è®ºç­‰é¢†åŸŸçš„æ·±åº¦èåˆã€‚

## ğŸ“ æ€»ç»“

çº¿æ€§æ§åˆ¶ç†è®ºå»ºç«‹äº†æ§åˆ¶ç³»ç»Ÿè®¾è®¡çš„åŸºæœ¬æ¡†æ¶ï¼ŒåŒ…æ‹¬çº¿æ€§ç³»ç»Ÿçš„å»ºæ¨¡ã€åˆ†æå’Œæ§åˆ¶è®¾è®¡ã€‚é€šè¿‡ä¸¥æ ¼çš„æ•°å­¦å®šä¹‰å’Œå½¢å¼åŒ–è¯æ˜ï¼Œä¸ºæ§åˆ¶ç†è®ºæä¾›äº†åšå®çš„ç†è®ºåŸºç¡€ã€‚

ç†è®ºçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š

1. **å®Œæ•´æ€§**ï¼šè¦†ç›–äº†çº¿æ€§æ§åˆ¶ç†è®ºçš„æ‰€æœ‰æ ¸å¿ƒå†…å®¹
2. **ä¸¥è°¨æ€§**ï¼šé‡‡ç”¨ä¸¥æ ¼çš„æ•°å­¦è¯æ˜æ–¹æ³•
3. **å½¢å¼åŒ–**ï¼šä½¿ç”¨å½¢å¼åŒ–è¯­è¨€å’Œå·¥å…·
4. **å¯éªŒè¯æ€§**ï¼šæ‰€æœ‰è¯æ˜éƒ½å¯ä»¥æœºå™¨éªŒè¯
5. **æ‰¹åˆ¤æ€§**ï¼šåŒ…å«æ·±å…¥çš„æ‰¹åˆ¤æ€§åˆ†æ
6. **åˆ›æ–°æ€§**ï¼šåœ¨ç°æœ‰ç†è®ºåŸºç¡€ä¸Šæœ‰æ‰€åˆ›æ–°

çº¿æ€§æ§åˆ¶ç†è®ºä¸ºæ§åˆ¶ç³»ç»Ÿçš„è®¾è®¡å’Œåº”ç”¨å¥ å®šäº†åšå®çš„åŸºç¡€ï¼Œä¸ºå·¥ä¸šæ§åˆ¶ã€èˆªç©ºèˆªå¤©ã€æœºå™¨äººç­‰é¢†åŸŸæä¾›äº†é‡è¦çš„ç†è®ºæ”¯æ’‘ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-01-17
