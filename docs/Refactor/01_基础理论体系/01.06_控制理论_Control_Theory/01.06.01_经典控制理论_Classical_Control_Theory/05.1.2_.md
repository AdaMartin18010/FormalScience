# 05.1.2 çº¿æ€§ç³»ç»Ÿç†è®º

## ğŸ“‹ ç›®å½•

- [05.1.2 çº¿æ€§ç³»ç»Ÿç†è®º](#0512-çº¿æ€§ç³»ç»Ÿç†è®º)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1 æ¦‚è¿°](#1-æ¦‚è¿°)
  - [2 æ ¸å¿ƒç›®æ ‡](#2-æ ¸å¿ƒç›®æ ‡)
  - [ğŸ“š ç›®å½•](#-ç›®å½•-1)
  - [3 åŸºæœ¬æ¦‚å¿µ](#3-åŸºæœ¬æ¦‚å¿µ)
    - [3.1 çº¿æ€§ç³»ç»Ÿå®šä¹‰](#31-çº¿æ€§ç³»ç»Ÿå®šä¹‰)
    - [3.2 æ—¶ä¸å˜ç³»ç»Ÿ](#32-æ—¶ä¸å˜ç³»ç»Ÿ)
    - [3.3 çº¿æ€§æ—¶ä¸å˜ç³»ç»Ÿ](#33-çº¿æ€§æ—¶ä¸å˜ç³»ç»Ÿ)
  - [4 çŠ¶æ€ç©ºé—´è¡¨ç¤º](#4-çŠ¶æ€ç©ºé—´è¡¨ç¤º)
    - [4.1 è¿ç»­æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹](#41-è¿ç»­æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹)
    - [4.2 ç¦»æ•£æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹](#42-ç¦»æ•£æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹)
    - [4.3 çŠ¶æ€è½¬ç§»çŸ©é˜µ](#43-çŠ¶æ€è½¬ç§»çŸ©é˜µ)
  - [5 ä¼ é€’å‡½æ•°](#5-ä¼ é€’å‡½æ•°)
    - [5.1 ä¼ é€’å‡½æ•°å®šä¹‰](#51-ä¼ é€’å‡½æ•°å®šä¹‰)
    - [5.2 ä¼ é€’å‡½æ•°æ€§è´¨](#52-ä¼ é€’å‡½æ•°æ€§è´¨)
    - [5.3 çŠ¶æ€ç©ºé—´åˆ°ä¼ é€’å‡½æ•°çš„è½¬æ¢](#53-çŠ¶æ€ç©ºé—´åˆ°ä¼ é€’å‡½æ•°çš„è½¬æ¢)
  - [6 ç³»ç»Ÿç¨³å®šæ€§](#6-ç³»ç»Ÿç¨³å®šæ€§)
    - [6.1 æé›…æ™®è¯ºå¤«ç¨³å®šæ€§](#61-æé›…æ™®è¯ºå¤«ç¨³å®šæ€§)
    - [6.2 çº¿æ€§ç³»ç»Ÿç¨³å®šæ€§åˆ¤æ®](#62-çº¿æ€§ç³»ç»Ÿç¨³å®šæ€§åˆ¤æ®)
    - [6.3 åŠ³æ–¯-èµ«å°”ç»´èŒ¨åˆ¤æ®](#63-åŠ³æ–¯-èµ«å°”ç»´èŒ¨åˆ¤æ®)
  - [7 å¯æ§æ€§ä¸å¯è§‚æ€§](#7-å¯æ§æ€§ä¸å¯è§‚æ€§)
    - [7.1 å¯æ§æ€§](#71-å¯æ§æ€§)
    - [7.2 å¯è§‚æ€§](#72-å¯è§‚æ€§)
  - [8 æç‚¹é…ç½®](#8-æç‚¹é…ç½®)
    - [8.1 çŠ¶æ€åé¦ˆ](#81-çŠ¶æ€åé¦ˆ)
    - [8.2 æç‚¹é…ç½®å®šç†](#82-æç‚¹é…ç½®å®šç†)
  - [9 è§‚æµ‹å™¨è®¾è®¡](#9-è§‚æµ‹å™¨è®¾è®¡)
    - [9.1 å…¨ç»´è§‚æµ‹å™¨](#91-å…¨ç»´è§‚æµ‹å™¨)
    - [9.2 è§‚æµ‹å™¨è®¾è®¡å®šç†](#92-è§‚æµ‹å™¨è®¾è®¡å®šç†)
  - [10 æœ€ä¼˜æ§åˆ¶](#10-æœ€ä¼˜æ§åˆ¶)
    - [10.1 çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨(LQR)](#101-çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨lqr)
    - [10.2 LQRè§£](#102-lqrè§£)
  - [11 ä»£ç å®ç°](#11-ä»£ç å®ç°)
    - [11.1 çº¿æ€§ç³»ç»Ÿç±»](#111-çº¿æ€§ç³»ç»Ÿç±»)
    - [11.2 æµ‹è¯•ä»£ç ](#112-æµ‹è¯•ä»£ç )
  - [12 åº”ç”¨ç¤ºä¾‹](#12-åº”ç”¨ç¤ºä¾‹)
    - [12.1 å€’ç«‹æ‘†ç³»ç»Ÿ](#121-å€’ç«‹æ‘†ç³»ç»Ÿ)
    - [12.2 é£è¡Œå™¨å§¿æ€æ§åˆ¶](#122-é£è¡Œå™¨å§¿æ€æ§åˆ¶)
  - [13 ç›¸å…³ç†è®º](#13-ç›¸å…³ç†è®º)
    - [13.1 éçº¿æ€§ç³»ç»Ÿç†è®º](#131-éçº¿æ€§ç³»ç»Ÿç†è®º)
    - [13.2 æœ€ä¼˜æ§åˆ¶ç†è®º](#132-æœ€ä¼˜æ§åˆ¶ç†è®º)
    - [13.3 é²æ£’æ§åˆ¶ç†è®º](#133-é²æ£’æ§åˆ¶ç†è®º)
    - [13.4 è‡ªé€‚åº”æ§åˆ¶ç†è®º](#134-è‡ªé€‚åº”æ§åˆ¶ç†è®º)
  - [12. å‚è€ƒæ–‡çŒ®](#12-å‚è€ƒæ–‡çŒ®)
  - [14 æ‰¹åˆ¤æ€§åˆ†æ](#14-æ‰¹åˆ¤æ€§åˆ†æ)
    - [14.1 å¤šå…ƒç†è®ºè§†è§’](#141-å¤šå…ƒç†è®ºè§†è§’)
    - [14.2 å±€é™æ€§åˆ†æ](#142-å±€é™æ€§åˆ†æ)
    - [14.3 äº‰è®®ä¸åˆ†æ­§](#143-äº‰è®®ä¸åˆ†æ­§)
    - [14.4 åº”ç”¨å‰æ™¯](#144-åº”ç”¨å‰æ™¯)
    - [14.5 æ”¹è¿›å»ºè®®](#145-æ”¹è¿›å»ºè®®)

---

## 1 æ¦‚è¿°

çº¿æ€§ç³»ç»Ÿç†è®ºæ˜¯æ§åˆ¶ç†è®ºçš„åŸºç¡€ï¼Œç ”ç©¶çº¿æ€§æ—¶ä¸å˜ç³»ç»Ÿçš„æ•°å­¦æè¿°ã€åˆ†æå’Œè®¾è®¡æ–¹æ³•ã€‚çº¿æ€§ç³»ç»Ÿå…·æœ‰å åŠ æ€§å’Œé½æ¬¡æ€§ï¼Œä¸ºæ§åˆ¶ç³»ç»Ÿè®¾è®¡æä¾›äº†å¼ºå¤§çš„æ•°å­¦å·¥å…·ã€‚

## 2 æ ¸å¿ƒç›®æ ‡

1. **å»ºç«‹çº¿æ€§ç³»ç»Ÿçš„æ•°å­¦æ¡†æ¶**
2. **ç ”ç©¶ç³»ç»Ÿç¨³å®šæ€§ç†è®º**
3. **å‘å±•ç³»ç»Ÿåˆ†æå’Œè®¾è®¡æ–¹æ³•**
4. **æä¾›å½¢å¼åŒ–è¯æ˜å’Œä»£ç å®ç°**

## ğŸ“š ç›®å½•

- [05.1.2 çº¿æ€§ç³»ç»Ÿç†è®º](#0512-çº¿æ€§ç³»ç»Ÿç†è®º)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1 æ¦‚è¿°](#1-æ¦‚è¿°)
  - [2 æ ¸å¿ƒç›®æ ‡](#2-æ ¸å¿ƒç›®æ ‡)
  - [ğŸ“š ç›®å½•](#-ç›®å½•-1)
  - [3 åŸºæœ¬æ¦‚å¿µ](#3-åŸºæœ¬æ¦‚å¿µ)
    - [3.1 çº¿æ€§ç³»ç»Ÿå®šä¹‰](#31-çº¿æ€§ç³»ç»Ÿå®šä¹‰)
    - [3.2 æ—¶ä¸å˜ç³»ç»Ÿ](#32-æ—¶ä¸å˜ç³»ç»Ÿ)
    - [3.3 çº¿æ€§æ—¶ä¸å˜ç³»ç»Ÿ](#33-çº¿æ€§æ—¶ä¸å˜ç³»ç»Ÿ)
  - [4 çŠ¶æ€ç©ºé—´è¡¨ç¤º](#4-çŠ¶æ€ç©ºé—´è¡¨ç¤º)
    - [4.1 è¿ç»­æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹](#41-è¿ç»­æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹)
    - [4.2 ç¦»æ•£æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹](#42-ç¦»æ•£æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹)
    - [4.3 çŠ¶æ€è½¬ç§»çŸ©é˜µ](#43-çŠ¶æ€è½¬ç§»çŸ©é˜µ)
  - [5 ä¼ é€’å‡½æ•°](#5-ä¼ é€’å‡½æ•°)
    - [5.1 ä¼ é€’å‡½æ•°å®šä¹‰](#51-ä¼ é€’å‡½æ•°å®šä¹‰)
    - [5.2 ä¼ é€’å‡½æ•°æ€§è´¨](#52-ä¼ é€’å‡½æ•°æ€§è´¨)
    - [5.3 çŠ¶æ€ç©ºé—´åˆ°ä¼ é€’å‡½æ•°çš„è½¬æ¢](#53-çŠ¶æ€ç©ºé—´åˆ°ä¼ é€’å‡½æ•°çš„è½¬æ¢)
  - [6 ç³»ç»Ÿç¨³å®šæ€§](#6-ç³»ç»Ÿç¨³å®šæ€§)
    - [6.1 æé›…æ™®è¯ºå¤«ç¨³å®šæ€§](#61-æé›…æ™®è¯ºå¤«ç¨³å®šæ€§)
    - [6.2 çº¿æ€§ç³»ç»Ÿç¨³å®šæ€§åˆ¤æ®](#62-çº¿æ€§ç³»ç»Ÿç¨³å®šæ€§åˆ¤æ®)
    - [6.3 åŠ³æ–¯-èµ«å°”ç»´èŒ¨åˆ¤æ®](#63-åŠ³æ–¯-èµ«å°”ç»´èŒ¨åˆ¤æ®)
  - [7 å¯æ§æ€§ä¸å¯è§‚æ€§](#7-å¯æ§æ€§ä¸å¯è§‚æ€§)
    - [7.1 å¯æ§æ€§](#71-å¯æ§æ€§)
    - [7.2 å¯è§‚æ€§](#72-å¯è§‚æ€§)
  - [8 æç‚¹é…ç½®](#8-æç‚¹é…ç½®)
    - [8.1 çŠ¶æ€åé¦ˆ](#81-çŠ¶æ€åé¦ˆ)
    - [8.2 æç‚¹é…ç½®å®šç†](#82-æç‚¹é…ç½®å®šç†)
  - [9 è§‚æµ‹å™¨è®¾è®¡](#9-è§‚æµ‹å™¨è®¾è®¡)
    - [9.1 å…¨ç»´è§‚æµ‹å™¨](#91-å…¨ç»´è§‚æµ‹å™¨)
    - [9.2 è§‚æµ‹å™¨è®¾è®¡å®šç†](#92-è§‚æµ‹å™¨è®¾è®¡å®šç†)
  - [10 æœ€ä¼˜æ§åˆ¶](#10-æœ€ä¼˜æ§åˆ¶)
    - [10.1 çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨(LQR)](#101-çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨lqr)
    - [10.2 LQRè§£](#102-lqrè§£)
  - [11 ä»£ç å®ç°](#11-ä»£ç å®ç°)
    - [11.1 çº¿æ€§ç³»ç»Ÿç±»](#111-çº¿æ€§ç³»ç»Ÿç±»)
    - [11.2 æµ‹è¯•ä»£ç ](#112-æµ‹è¯•ä»£ç )
  - [12 åº”ç”¨ç¤ºä¾‹](#12-åº”ç”¨ç¤ºä¾‹)
    - [12.1 å€’ç«‹æ‘†ç³»ç»Ÿ](#121-å€’ç«‹æ‘†ç³»ç»Ÿ)
    - [12.2 é£è¡Œå™¨å§¿æ€æ§åˆ¶](#122-é£è¡Œå™¨å§¿æ€æ§åˆ¶)
  - [13 ç›¸å…³ç†è®º](#13-ç›¸å…³ç†è®º)
    - [13.1 éçº¿æ€§ç³»ç»Ÿç†è®º](#131-éçº¿æ€§ç³»ç»Ÿç†è®º)
    - [13.2 æœ€ä¼˜æ§åˆ¶ç†è®º](#132-æœ€ä¼˜æ§åˆ¶ç†è®º)
    - [13.3 é²æ£’æ§åˆ¶ç†è®º](#133-é²æ£’æ§åˆ¶ç†è®º)
    - [13.4 è‡ªé€‚åº”æ§åˆ¶ç†è®º](#134-è‡ªé€‚åº”æ§åˆ¶ç†è®º)
  - [12. å‚è€ƒæ–‡çŒ®](#12-å‚è€ƒæ–‡çŒ®)
  - [14 æ‰¹åˆ¤æ€§åˆ†æ](#14-æ‰¹åˆ¤æ€§åˆ†æ)
    - [14.1 å¤šå…ƒç†è®ºè§†è§’](#141-å¤šå…ƒç†è®ºè§†è§’)
    - [14.2 å±€é™æ€§åˆ†æ](#142-å±€é™æ€§åˆ†æ)
    - [14.3 äº‰è®®ä¸åˆ†æ­§](#143-äº‰è®®ä¸åˆ†æ­§)
    - [14.4 åº”ç”¨å‰æ™¯](#144-åº”ç”¨å‰æ™¯)
    - [14.5 æ”¹è¿›å»ºè®®](#145-æ”¹è¿›å»ºè®®)

## 3 åŸºæœ¬æ¦‚å¿µ

### 3.1 çº¿æ€§ç³»ç»Ÿå®šä¹‰

**å®šä¹‰ 1.1.1** (çº¿æ€§ç³»ç»Ÿ)
ä¸€ä¸ªç³»ç»Ÿç§°ä¸ºçº¿æ€§ç³»ç»Ÿï¼Œå¦‚æœå®ƒæ»¡è¶³å åŠ æ€§å’Œé½æ¬¡æ€§ï¼š

å¯¹äºä»»æ„è¾“å…¥ $u_1(t), u_2(t)$ å’Œä»»æ„å¸¸æ•° $\alpha, \beta$ï¼Œæœ‰ï¼š
$$y(t) = T[\alpha u_1(t) + \beta u_2(t)] = \alpha T[u_1(t)] + \beta T[u_2(t)]$$

å…¶ä¸­ $T[\cdot]$ è¡¨ç¤ºç³»ç»Ÿç®—å­ã€‚

### 3.2 æ—¶ä¸å˜ç³»ç»Ÿ

**å®šä¹‰ 1.1.2** (æ—¶ä¸å˜ç³»ç»Ÿ)
ä¸€ä¸ªç³»ç»Ÿç§°ä¸ºæ—¶ä¸å˜ç³»ç»Ÿï¼Œå¦‚æœå¯¹äºä»»æ„æ—¶é—´å»¶è¿Ÿ $\tau$ï¼Œæœ‰ï¼š
$$y(t - \tau) = T[u(t - \tau)]$$

### 3.3 çº¿æ€§æ—¶ä¸å˜ç³»ç»Ÿ

**å®šä¹‰ 1.1.3** (LTIç³»ç»Ÿ)
åŒæ—¶æ»¡è¶³çº¿æ€§å’Œæ—¶ä¸å˜æ€§çš„ç³»ç»Ÿç§°ä¸ºçº¿æ€§æ—¶ä¸å˜(LTI)ç³»ç»Ÿã€‚

## 4 çŠ¶æ€ç©ºé—´è¡¨ç¤º

### 4.1 è¿ç»­æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹

**å®šä¹‰ 2.1.1** (è¿ç»­æ—¶é—´çŠ¶æ€ç©ºé—´)
è¿ç»­æ—¶é—´LTIç³»ç»Ÿçš„çŠ¶æ€ç©ºé—´è¡¨ç¤ºä¸ºï¼š
$$
\begin{align}
\dot{x}(t) &= Ax(t) + Bu(t) \\
y(t) &= Cx(t) + Du(t)
\end{align}
$$

å…¶ä¸­ï¼š

- $x(t) \in \mathbb{R}^n$ æ˜¯çŠ¶æ€å‘é‡
- $u(t) \in \mathbb{R}^m$ æ˜¯è¾“å…¥å‘é‡
- $y(t) \in \mathbb{R}^p$ æ˜¯è¾“å‡ºå‘é‡
- $A \in \mathbb{R}^{n \times n}$ æ˜¯ç³»ç»ŸçŸ©é˜µ
- $B \in \mathbb{R}^{n \times m}$ æ˜¯è¾“å…¥çŸ©é˜µ
- $C \in \mathbb{R}^{p \times n}$ æ˜¯è¾“å‡ºçŸ©é˜µ
- $D \in \mathbb{R}^{p \times m}$ æ˜¯ç›´æ¥ä¼ é€’çŸ©é˜µ

### 4.2 ç¦»æ•£æ—¶é—´çŠ¶æ€ç©ºé—´æ¨¡å‹

**å®šä¹‰ 2.1.2** (ç¦»æ•£æ—¶é—´çŠ¶æ€ç©ºé—´)
ç¦»æ•£æ—¶é—´LTIç³»ç»Ÿçš„çŠ¶æ€ç©ºé—´è¡¨ç¤ºä¸ºï¼š
$$
\begin{align}
x(k+1) &= Ax(k) + Bu(k) \\
y(k) &= Cx(k) + Du(k)
\end{align}
$$

### 4.3 çŠ¶æ€è½¬ç§»çŸ©é˜µ

**å®šä¹‰ 2.1.3** (çŠ¶æ€è½¬ç§»çŸ©é˜µ)
è¿ç»­æ—¶é—´ç³»ç»Ÿçš„çŠ¶æ€è½¬ç§»çŸ©é˜µå®šä¹‰ä¸ºï¼š
$$\Phi(t) = e^{At} = \sum_{k=0}^{\infty} \frac{(At)^k}{k!}$$

**å®šç† 2.1.1** (çŠ¶æ€è½¬ç§»æ€§è´¨)
å¯¹äºè¿ç»­æ—¶é—´LTIç³»ç»Ÿï¼ŒçŠ¶æ€è½¬ç§»çŸ©é˜µæ»¡è¶³ï¼š

1. $\Phi(0) = I$
2. $\Phi(t_1 + t_2) = \Phi(t_1)\Phi(t_2)$
3. $\Phi^{-1}(t) = \Phi(-t)$

**è¯æ˜**ï¼š

1. å½“ $t = 0$ æ—¶ï¼Œ$e^{A \cdot 0} = I$
2. $e^{A(t_1 + t_2)} = e^{At_1}e^{At_2}$ (çŸ©é˜µæŒ‡æ•°æ€§è´¨)
3. $e^{At}e^{-At} = e^{A(t-t)} = I$ï¼Œå› æ­¤ $e^{-At} = (e^{At})^{-1}$

## 5 ä¼ é€’å‡½æ•°

### 5.1 ä¼ é€’å‡½æ•°å®šä¹‰

**å®šä¹‰ 3.1.1** (ä¼ é€’å‡½æ•°)
å¯¹äºå•è¾“å…¥å•è¾“å‡º(SISO)ç³»ç»Ÿï¼Œä¼ é€’å‡½æ•°å®šä¹‰ä¸ºï¼š
$$G(s) = \frac{Y(s)}{U(s)} = C(sI - A)^{-1}B + D$$

å…¶ä¸­ $s$ æ˜¯æ‹‰æ™®æ‹‰æ–¯å˜æ¢å˜é‡ã€‚

### 5.2 ä¼ é€’å‡½æ•°æ€§è´¨

**å®šç† 3.1.1** (ä¼ é€’å‡½æ•°æ€§è´¨)
ä¼ é€’å‡½æ•° $G(s)$ å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š

1. $G(s)$ æ˜¯ $s$ çš„æœ‰ç†å‡½æ•°
2. åˆ†æ¯å¤šé¡¹å¼çš„æ ¹æ˜¯ç³»ç»Ÿçš„æç‚¹
3. åˆ†å­å¤šé¡¹å¼çš„æ ¹æ˜¯ç³»ç»Ÿçš„é›¶ç‚¹

### 5.3 çŠ¶æ€ç©ºé—´åˆ°ä¼ é€’å‡½æ•°çš„è½¬æ¢

**ç®—æ³• 3.1.1** (çŠ¶æ€ç©ºé—´åˆ°ä¼ é€’å‡½æ•°è½¬æ¢)
ç»™å®šçŠ¶æ€ç©ºé—´æ¨¡å‹ $(A, B, C, D)$ï¼Œä¼ é€’å‡½æ•°è®¡ç®—ä¸ºï¼š
$$G(s) = C(sI - A)^{-1}B + D = \frac{C \text{adj}(sI - A)B + D \det(sI - A)}{\det(sI - A)}$$

## 6 ç³»ç»Ÿç¨³å®šæ€§

### 6.1 æé›…æ™®è¯ºå¤«ç¨³å®šæ€§

**å®šä¹‰ 4.1.1** (æé›…æ™®è¯ºå¤«ç¨³å®šæ€§)
ç³»ç»Ÿ $\dot{x} = f(x)$ çš„å¹³è¡¡ç‚¹ $x_e$ æ˜¯æé›…æ™®è¯ºå¤«ç¨³å®šçš„ï¼Œå¦‚æœå¯¹äºä»»æ„ $\epsilon > 0$ï¼Œå­˜åœ¨ $\delta > 0$ï¼Œä½¿å¾—ï¼š
$$\|x(0) - x_e\| < \delta \Rightarrow \|x(t) - x_e\| < \epsilon, \quad \forall t \geq 0$$

### 6.2 çº¿æ€§ç³»ç»Ÿç¨³å®šæ€§åˆ¤æ®

**å®šç† 4.1.1** (çº¿æ€§ç³»ç»Ÿç¨³å®šæ€§)
çº¿æ€§ç³»ç»Ÿ $\dot{x} = Ax$ çš„é›¶å¹³è¡¡ç‚¹æ˜¯æ¸è¿‘ç¨³å®šçš„ï¼Œå½“ä¸”ä»…å½“ $A$ çš„æ‰€æœ‰ç‰¹å¾å€¼éƒ½å…·æœ‰è´Ÿå®éƒ¨ã€‚

**è¯æ˜**ï¼š
ç³»ç»Ÿè§£ä¸º $x(t) = e^{At}x(0)$ã€‚å½“ $A$ çš„æ‰€æœ‰ç‰¹å¾å€¼éƒ½å…·æœ‰è´Ÿå®éƒ¨æ—¶ï¼Œ$e^{At} \to 0$ å½“ $t \to \infty$ï¼Œå› æ­¤ç³»ç»Ÿæ¸è¿‘ç¨³å®šã€‚

### 6.3 åŠ³æ–¯-èµ«å°”ç»´èŒ¨åˆ¤æ®

**å®šç† 4.1.2** (åŠ³æ–¯-èµ«å°”ç»´èŒ¨åˆ¤æ®)
å¤šé¡¹å¼ $P(s) = a_ns^n + a_{n-1}s^{n-1} + \cdots + a_0$ çš„æ‰€æœ‰æ ¹éƒ½å…·æœ‰è´Ÿå®éƒ¨ï¼Œå½“ä¸”ä»…å½“ï¼š

1. æ‰€æœ‰ç³»æ•° $a_i > 0$
2. åŠ³æ–¯é˜µåˆ—çš„ç¬¬ä¸€åˆ—æ‰€æœ‰å…ƒç´ éƒ½ä¸ºæ­£

## 7 å¯æ§æ€§ä¸å¯è§‚æ€§

### 7.1 å¯æ§æ€§

**å®šä¹‰ 5.1.1** (å¯æ§æ€§)
ç³»ç»Ÿ $(A, B)$ ç§°ä¸ºå¯æ§çš„ï¼Œå¦‚æœå¯¹äºä»»æ„åˆå§‹çŠ¶æ€ $x_0$ å’Œä»»æ„ç›®æ ‡çŠ¶æ€ $x_f$ï¼Œå­˜åœ¨æœ‰é™æ—¶é—´ $T$ å’Œæ§åˆ¶è¾“å…¥ $u(t)$ï¼Œä½¿å¾— $x(T) = x_f$ã€‚

**å®šç† 5.1.1** (å¯æ§æ€§åˆ¤æ®)
ç³»ç»Ÿ $(A, B)$ å¯æ§çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯å¯æ§æ€§çŸ©é˜µæ»¡ç§©ï¼š
$$\text{rank}[B \quad AB \quad A^2B \quad \cdots \quad A^{n-1}B] = n$$

### 7.2 å¯è§‚æ€§

**å®šä¹‰ 5.1.2** (å¯è§‚æ€§)
ç³»ç»Ÿ $(A, C)$ ç§°ä¸ºå¯è§‚çš„ï¼Œå¦‚æœä»»æ„åˆå§‹çŠ¶æ€ $x_0$ éƒ½å¯ä»¥é€šè¿‡æœ‰é™æ—¶é—´çš„è¾“å‡ºè§‚æµ‹å”¯ä¸€ç¡®å®šã€‚

**å®šç† 5.1.2** (å¯è§‚æ€§åˆ¤æ®)
ç³»ç»Ÿ $(A, C)$ å¯è§‚çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯å¯è§‚æ€§çŸ©é˜µæ»¡ç§©ï¼š
$$\text{rank}\begin{bmatrix} C \\ CA \\ CA^2 \\ \vdots \\ CA^{n-1} \end{bmatrix} = n$$

## 8 æç‚¹é…ç½®

### 8.1 çŠ¶æ€åé¦ˆ

**å®šä¹‰ 6.1.1** (çŠ¶æ€åé¦ˆ)
çŠ¶æ€åé¦ˆæ§åˆ¶å¾‹ä¸ºï¼š
$$u(t) = -Kx(t) + r(t)$$

å…¶ä¸­ $K$ æ˜¯åé¦ˆå¢ç›ŠçŸ©é˜µï¼Œ$r(t)$ æ˜¯å‚è€ƒè¾“å…¥ã€‚

### 8.2 æç‚¹é…ç½®å®šç†

**å®šç† 6.1.1** (æç‚¹é…ç½®)
å¯¹äºå¯æ§ç³»ç»Ÿ $(A, B)$ï¼Œå¯ä»¥é€šè¿‡çŠ¶æ€åé¦ˆ $u = -Kx$ å°†é—­ç¯ç³»ç»Ÿ $A - BK$ çš„æç‚¹é…ç½®åˆ°ä»»æ„ä½ç½®ã€‚

**ç®—æ³• 6.1.1** (é˜¿å…‹æ›¼å…¬å¼)
å¯¹äºå•è¾“å…¥ç³»ç»Ÿï¼Œåé¦ˆå¢ç›Šä¸ºï¼š
$$K = [0 \quad 0 \quad \cdots \quad 1][B \quad AB \quad \cdots \quad A^{n-1}B]^{-1}P(A)$$

å…¶ä¸­ $P(s)$ æ˜¯æœŸæœ›çš„é—­ç¯ç‰¹å¾å¤šé¡¹å¼ã€‚

## 9 è§‚æµ‹å™¨è®¾è®¡

### 9.1 å…¨ç»´è§‚æµ‹å™¨

**å®šä¹‰ 7.1.1** (å…¨ç»´è§‚æµ‹å™¨)
å…¨ç»´è§‚æµ‹å™¨æ–¹ç¨‹ä¸ºï¼š
$$\dot{\hat{x}} = A\hat{x} + Bu + L(y - C\hat{x})$$

å…¶ä¸­ $L$ æ˜¯è§‚æµ‹å™¨å¢ç›ŠçŸ©é˜µã€‚

### 9.2 è§‚æµ‹å™¨è®¾è®¡å®šç†

**å®šç† 7.1.1** (è§‚æµ‹å™¨è®¾è®¡)
å¯¹äºå¯è§‚ç³»ç»Ÿ $(A, C)$ï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©è§‚æµ‹å™¨å¢ç›Š $L$ ä½¿è§‚æµ‹å™¨è¯¯å·®åŠ¨æ€ $A - LC$ çš„æç‚¹é…ç½®åˆ°ä»»æ„ä½ç½®ã€‚

## 10 æœ€ä¼˜æ§åˆ¶

### 10.1 çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨(LQR)

**å®šä¹‰ 8.1.1** (LQRé—®é¢˜)
å¯»æ‰¾æ§åˆ¶è¾“å…¥ $u(t)$ æœ€å°åŒ–æ€§èƒ½æŒ‡æ ‡ï¼š
$$J = \int_0^{\infty} (x^T Q x + u^T R u) dt$$

å…¶ä¸­ $Q \geq 0$ å’Œ $R > 0$ æ˜¯æƒé‡çŸ©é˜µã€‚

### 10.2 LQRè§£

**å®šç† 8.1.1** (LQRè§£)
LQRé—®é¢˜çš„æœ€ä¼˜æ§åˆ¶å¾‹ä¸ºï¼š
$$u(t) = -R^{-1}B^T P x(t)$$

å…¶ä¸­ $P$ æ˜¯ä»£æ•°é»å¡ææ–¹ç¨‹çš„è§£ï¼š
$$A^T P + PA - PBR^{-1}B^T P + Q = 0$$

## 11 ä»£ç å®ç°

### 11.1 çº¿æ€§ç³»ç»Ÿç±»

```rust
use nalgebra::{DMatrix, DVector, Matrix, Vector};
use std::f64::consts::PI;

/// çº¿æ€§æ—¶ä¸å˜ç³»ç»Ÿ
# [derive(Debug, Clone)]
pub struct LinearSystem {
    /// ç³»ç»ŸçŸ©é˜µ A
    pub a: DMatrix<f64>,
    /// è¾“å…¥çŸ©é˜µ B
    pub b: DMatrix<f64>,
    /// è¾“å‡ºçŸ©é˜µ C
    pub c: DMatrix<f64>,
    /// ç›´æ¥ä¼ é€’çŸ©é˜µ D
    pub d: DMatrix<f64>,
    /// çŠ¶æ€ç»´åº¦
    pub n: usize,
    /// è¾“å…¥ç»´åº¦
    pub m: usize,
    /// è¾“å‡ºç»´åº¦
    pub p: usize,
}

impl LinearSystem {
    /// åˆ›å»ºæ–°çš„çº¿æ€§ç³»ç»Ÿ
    pub fn new(a: DMatrix<f64>, b: DMatrix<f64>, c: DMatrix<f64>, d: DMatrix<f64>) -> Self {
        let n = a.nrows();
        let m = b.ncols();
        let p = c.nrows();

        assert_eq!(a.ncols(), n, "AçŸ©é˜µå¿…é¡»æ˜¯æ–¹é˜µ");
        assert_eq!(b.nrows(), n, "BçŸ©é˜µè¡Œæ•°å¿…é¡»ä¸AçŸ©é˜µä¸€è‡´");
        assert_eq!(c.ncols(), n, "CçŸ©é˜µåˆ—æ•°å¿…é¡»ä¸AçŸ©é˜µä¸€è‡´");
        assert_eq!(d.nrows(), p, "DçŸ©é˜µè¡Œæ•°å¿…é¡»ä¸CçŸ©é˜µä¸€è‡´");
        assert_eq!(d.ncols(), m, "DçŸ©é˜µåˆ—æ•°å¿…é¡»ä¸BçŸ©é˜µä¸€è‡´");

        Self { a, b, c, d, n, m, p }
    }

    /// è®¡ç®—çŠ¶æ€è½¬ç§»çŸ©é˜µ
    pub fn state_transition_matrix(&self, t: f64) -> DMatrix<f64> {
        // ä½¿ç”¨æ³°å‹’çº§æ•°è¿‘ä¼¼è®¡ç®— e^{At}
        let mut phi = DMatrix::identity(self.n, self.n);
        let mut term = DMatrix::identity(self.n, self.n);
        let mut factorial = 1.0;

        for k in 1..=10 {
            factorial *= k as f64;
            term = &term * &self.a * (t / k as f64);
            phi += &term;
        }

        phi
    }

    /// è®¡ç®—ä¼ é€’å‡½æ•°
    pub fn transfer_function(&self, s: f64) -> f64 {
        let s_i = DMatrix::identity(self.n, self.n) * s;
        let denominator = (s_i - &self.a).determinant();

        if denominator.abs() < 1e-10 {
            return f64::INFINITY;
        }

        let adjoint = (s_i - &self.a).adjoint();
        let numerator = [&self.c * &adjoint * &self.b]((0, 0));
        let direct = [&self.d * denominator]((0, 0));

        (numerator + direct) / denominator
    }

    /// æ£€æŸ¥ç³»ç»Ÿç¨³å®šæ€§
    pub fn is_stable(&self) -> bool {
        let eigenvals = self.a.eigenvalues();
        eigenvals.iter().all(|&lambda| lambda.re < 0.0)
    }

    /// æ£€æŸ¥å¯æ§æ€§
    pub fn is_controllable(&self) -> bool {
        let mut controllability_matrix = DMatrix::zeros(self.n, self.n * self.m);

        for i in 0..self.n {
            let power = self.a.pow(i as u32);
            let col_start = i * self.m;
            for j in 0..self.m {
                controllability_matrix.set_column(col_start + j, &(&power * self.b.column(j)));
            }
        }

        controllability_matrix.rank() == self.n
    }

    /// æ£€æŸ¥å¯è§‚æ€§
    pub fn is_observable(&self) -> bool {
        let mut observability_matrix = DMatrix::zeros(self.n * self.p, self.n);

        for i in 0..self.n {
            let power = self.a.pow(i as u32);
            let row_start = i * self.p;
            for j in 0..self.p {
                observability_matrix.set_row(row_start + j, &(self.c.row(j) * &power));
            }
        }

        observability_matrix.rank() == self.n
    }

    /// æç‚¹é…ç½®
    pub fn pole_placement(&self, desired_poles: &[f64]) -> Option<DMatrix<f64>> {
        if !self.is_controllable() || desired_poles.len() != self.n {
            return None;
        }

        // é˜¿å…‹æ›¼å…¬å¼å®ç°
        let controllability_matrix = self.build_controllability_matrix();
        let controllability_inv = controllability_matrix.try_inverse()?;

        // è®¡ç®—æœŸæœ›ç‰¹å¾å¤šé¡¹å¼
        let mut desired_poly = vec![1.0];
        for &pole in desired_poles {
            let mut new_poly = vec![0.0; desired_poly.len() + 1];
            for (i, &coeff) in desired_poly.iter().enumerate() {
                new_poly[i] += coeff;
                new_poly[i + 1] -= coeff * pole;
            }
            desired_poly = new_poly;
        }

        // è®¡ç®— P(A)
        let mut p_a = DMatrix::zeros(self.n, self.n);
        for (i, &coeff) in desired_poly.iter().enumerate() {
            if i == 0 {
                p_a += DMatrix::identity(self.n, self.n) * coeff;
            } else {
                p_a += self.a.pow(i as u32) * coeff;
            }
        }

        // è®¡ç®—åé¦ˆå¢ç›Š
        let mut k_row = DVector::zeros(self.n);
        k_row[self.n - 1] = 1.0;
        let k = k_row.transpose() * controllability_inv * p_a;

        Some(k)
    }

    /// æ„å»ºå¯æ§æ€§çŸ©é˜µ
    fn build_controllability_matrix(&self) -> DMatrix<f64> {
        let mut matrix = DMatrix::zeros(self.n, self.n * self.m);

        for i in 0..self.n {
            let power = self.a.pow(i as u32);
            let col_start = i * self.m;
            for j in 0..self.m {
                matrix.set_column(col_start + j, &(&power * self.b.column(j)));
            }
        }

        matrix
    }

    /// ç³»ç»Ÿä»¿çœŸ
    pub fn simulate(&self, x0: &DVector<f64>, u: &[f64], dt: f64, t_final: f64) -> Vec<DVector<f64>> {
        let steps = (t_final / dt) as usize;
        let mut states = Vec::with_capacity(steps);
        let mut x = x0.clone();

        for k in 0..steps {
            let t = k as f64 * dt;
            let u_t = if k < u.len() { u[k] } else { 0.0 };
            let u_vec = DVector::from_vec(vec![u_t]);

            // æ¬§æ‹‰æ–¹æ³•ç§¯åˆ†
            let dx = &self.a * &x + &self.b * u_vec;
            x += dx * dt;

            states.push(x.clone());
        }

        states
    }
}

/// è§‚æµ‹å™¨è®¾è®¡
pub struct Observer {
    pub l: DMatrix<f64>,
}

impl Observer {
    /// è®¾è®¡å…¨ç»´è§‚æµ‹å™¨
    pub fn design_full_order(system: &LinearSystem, desired_poles: &[f64]) -> Option<Self> {
        if !system.is_observable() || desired_poles.len() != system.n {
            return None;
        }

        // å¯¹å¶ç³»ç»Ÿæ–¹æ³•ï¼šè®¾è®¡è§‚æµ‹å™¨ç­‰ä»·äºè®¾è®¡å¯¹å¶ç³»ç»Ÿçš„çŠ¶æ€åé¦ˆ
        let dual_a = system.a.transpose();
        let dual_b = system.c.transpose();

        let dual_system = LinearSystem::new(dual_a, dual_b, system.b.transpose(), system.d.transpose());
        let l_transpose = dual_system.pole_placement(desired_poles)?;

        Some(Observer {
            l: l_transpose.transpose(),
        })
    }

    /// è§‚æµ‹å™¨çŠ¶æ€ä¼°è®¡
    pub fn estimate(&self, system: &LinearSystem, y: &DVector<f64>, u: &DVector<f64>, x_hat: &DVector<f64>, dt: f64) -> DVector<f64> {
        let y_hat = &system.c * x_hat + &system.d * u;
        let error = y - y_hat;
        let correction = &self.l * error;

        let dx_hat = &system.a * x_hat + &system.b * u + correction;
        x_hat + dx_hat * dt
    }
}

/// LQRæ§åˆ¶å™¨
pub struct LQRController {
    pub k: DMatrix<f64>,
}

impl LQRController {
    /// è®¾è®¡LQRæ§åˆ¶å™¨
    pub fn design(system: &LinearSystem, q: &DMatrix<f64>, r: &DMatrix<f64>) -> Option<Self> {
        // ç®€åŒ–çš„é»å¡ææ–¹ç¨‹æ±‚è§£ï¼ˆå®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨æ›´ç¨³å®šçš„ç®—æ³•ï¼‰
        let n = system.n;
        let mut p = DMatrix::identity(n, n);

        // è¿­ä»£æ±‚è§£é»å¡ææ–¹ç¨‹
        for _ in 0..100 {
            let p_new = system.a.transpose() * &p + &p * &system.a
                       - &p * &system.b * r.try_inverse()? * system.b.transpose() * &p + q;

            if (&p_new - &p).norm() < 1e-6 {
                p = p_new;
                break;
            }
            p = p_new;
        }

        let k = r.try_inverse()? * system.b.transpose() * &p;

        Some(LQRController { k })
    }

    /// LQRæ§åˆ¶å¾‹
    pub fn control(&self, x: &DVector<f64>, r: &DVector<f64>) -> DVector<f64> {
        -&self.k * x + r
    }
}
```

### 11.2 æµ‹è¯•ä»£ç 

```rust
# [cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_linear_system_creation() {
        let a = DMatrix::from_row_slice(2, 2, &[0.0, 1.0, -1.0, -2.0]);
        let b = DMatrix::from_row_slice(2, 1, &[0.0, 1.0]);
        let c = DMatrix::from_row_slice(1, 2, &[1.0, 0.0]);
        let d = DMatrix::from_row_slice(1, 1, &[0.0]);

        let system = LinearSystem::new(a, b, c, d);

        assert_eq!(system.n, 2);
        assert_eq!(system.m, 1);
        assert_eq!(system.p, 1);
    }

    #[test]
    fn test_system_stability() {
        // ç¨³å®šç³»ç»Ÿ
        let a_stable = DMatrix::from_row_slice(2, 2, &[-1.0, 0.0, 0.0, -2.0]);
        let b = DMatrix::from_row_slice(2, 1, &[0.0, 1.0]);
        let c = DMatrix::from_row_slice(1, 2, &[1.0, 0.0]);
        let d = DMatrix::from_row_slice(1, 1, &[0.0]);

        let system = LinearSystem::new(a_stable, b, c, d);
        assert!(system.is_stable());

        // ä¸ç¨³å®šç³»ç»Ÿ
        let a_unstable = DMatrix::from_row_slice(2, 2, &[1.0, 0.0, 0.0, 2.0]);
        let system_unstable = LinearSystem::new(a_unstable, b, c, d);
        assert!(!system_unstable.is_stable());
    }

    #[test]
    fn test_controllability() {
        let a = DMatrix::from_row_slice(2, 2, &[0.0, 1.0, 0.0, 0.0]);
        let b = DMatrix::from_row_slice(2, 1, &[0.0, 1.0]);
        let c = DMatrix::from_row_slice(1, 2, &[1.0, 0.0]);
        let d = DMatrix::from_row_slice(1, 1, &[0.0]);

        let system = LinearSystem::new(a, b, c, d);
        assert!(system.is_controllable());
    }

    #[test]
    fn test_pole_placement() {
        let a = DMatrix::from_row_slice(2, 2, &[0.0, 1.0, 0.0, 0.0]);
        let b = DMatrix::from_row_slice(2, 1, &[0.0, 1.0]);
        let c = DMatrix::from_row_slice(1, 2, &[1.0, 0.0]);
        let d = DMatrix::from_row_slice(1, 1, &[0.0]);

        let system = LinearSystem::new(a, b, c, d);
        let desired_poles = vec![-2.0, -3.0];

        let k = system.pole_placement(&desired_poles);
        assert!(k.is_some());

        let k = k.unwrap();
        let closed_loop_a = &system.a - &system.b * &k;
        let eigenvals = closed_loop_a.eigenvalues();

        // æ£€æŸ¥æç‚¹æ˜¯å¦æ¥è¿‘æœŸæœ›å€¼
        for (i, &desired_pole) in desired_poles.iter().enumerate() {
            assert!((eigenvals[i].re - desired_pole).abs() < 0.1);
        }
    }
}
```

## 12 åº”ç”¨ç¤ºä¾‹

### 12.1 å€’ç«‹æ‘†ç³»ç»Ÿ

```rust
/// å€’ç«‹æ‘†ç³»ç»Ÿç¤ºä¾‹
pub fn inverted_pendulum_example() {
    // å€’ç«‹æ‘†ç³»ç»Ÿå‚æ•°
    let m = 0.1; // æ‘†è´¨é‡
    let M = 0.5; // å°è½¦è´¨é‡
    let l = 0.3; // æ‘†é•¿
    let g = 9.81; // é‡åŠ›åŠ é€Ÿåº¦

    // çº¿æ€§åŒ–åçš„ç³»ç»ŸçŸ©é˜µï¼ˆåœ¨å¹³è¡¡ç‚¹é™„è¿‘ï¼‰
    let a = DMatrix::from_row_slice(4, 4, &[
        0.0, 1.0, 0.0, 0.0,
        0.0, 0.0, -m*g/(M+m), 0.0,
        0.0, 0.0, 0.0, 1.0,
        0.0, 0.0, (M+m)*g/(l*(M+m)), 0.0
    ]);

    let b = DMatrix::from_row_slice(4, 1, &[0.0, 1.0/(M+m), 0.0, -1.0/(l*(M+m))]);
    let c = DMatrix::from_row_slice(2, 4, &[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]);
    let d = DMatrix::from_row_slice(2, 1, &[0.0, 0.0]);

    let system = LinearSystem::new(a, b, c, d);

    println!("å€’ç«‹æ‘†ç³»ç»Ÿ:");
    println!("ç³»ç»ŸçŸ©é˜µ A:\n{}", system.a);
    println!("è¾“å…¥çŸ©é˜µ B:\n{}", system.b);
    println!("è¾“å‡ºçŸ©é˜µ C:\n{}", system.c);

    // æ£€æŸ¥ç³»ç»Ÿæ€§è´¨
    println!("ç³»ç»Ÿç¨³å®šæ€§: {}", system.is_stable());
    println!("ç³»ç»Ÿå¯æ§æ€§: {}", system.is_controllable());
    println!("ç³»ç»Ÿå¯è§‚æ€§: {}", system.is_observable());

    // è®¾è®¡LQRæ§åˆ¶å™¨
    let q = DMatrix::identity(4, 4);
    let r = DMatrix::from_row_slice(1, 1, &[0.1]);

    if let Some(lqr) = LQRController::design(&system, &q, &r) {
        println!("LQRå¢ç›ŠçŸ©é˜µ K:\n{}", lqr.k);

        // ä»¿çœŸ
        let x0 = DVector::from_vec(vec![0.1, 0.0, 0.1, 0.0]); // åˆå§‹çŠ¶æ€
        let r = DVector::from_vec(vec![0.0]); // å‚è€ƒè¾“å…¥
        let dt = 0.01;
        let t_final = 5.0;

        let mut x = x0.clone();
        let mut t = 0.0;

        println!("\nä»¿çœŸç»“æœ:");
        println!("æ—¶é—´(s) | ä½ç½®(m) | é€Ÿåº¦(m/s) | è§’åº¦(rad) | è§’é€Ÿåº¦(rad/s)");

        while t <= t_final {
            let u = lqr.control(&x, &r);
            let dx = &system.a * &x + &system.b * &u;
            x += dx * dt;
            t += dt;

            if (t * 100.0).round() as i32 % 10 == 0 {
                println!("{:.2} | {:.4} | {:.4} | {:.4} | {:.4}",
                         t, x[0], x[1], x[2], x[3]);
            }
        }
    }
}
```

### 12.2 é£è¡Œå™¨å§¿æ€æ§åˆ¶

```rust
/// é£è¡Œå™¨å§¿æ€æ§åˆ¶ç³»ç»Ÿ
pub fn aircraft_attitude_control() {
    // ç®€åŒ–çš„é£è¡Œå™¨å§¿æ€æ¨¡å‹
    let a = DMatrix::from_row_slice(3, 3, &[
        0.0, 1.0, 0.0,
        0.0, 0.0, 1.0,
        -1.0, -2.0, -3.0
    ]);

    let b = DMatrix::from_row_slice(3, 1, &[0.0, 0.0, 1.0]);
    let c = DMatrix::from_row_slice(1, 3, &[1.0, 0.0, 0.0]);
    let d = DMatrix::from_row_slice(1, 1, &[0.0]);

    let system = LinearSystem::new(a, b, c, d);

    // è®¾è®¡è§‚æµ‹å™¨
    let observer_poles = vec![-5.0, -6.0, -7.0];
    if let Some(observer) = Observer::design_full_order(&system, &observer_poles) {
        println!("è§‚æµ‹å™¨å¢ç›ŠçŸ©é˜µ L:\n{}", observer.l);

        // è®¾è®¡çŠ¶æ€åé¦ˆæ§åˆ¶å™¨
        let controller_poles = vec![-2.0, -3.0, -4.0];
        if let Some(k) = system.pole_placement(&controller_poles) {
            println!("çŠ¶æ€åé¦ˆå¢ç›ŠçŸ©é˜µ K:\n{}", k);

            // ä»¿çœŸå¸¦è§‚æµ‹å™¨çš„æ§åˆ¶ç³»ç»Ÿ
            let mut x = DVector::from_vec(vec![1.0, 0.0, 0.0]); // çœŸå®çŠ¶æ€
            let mut x_hat = DVector::from_vec(vec![0.0, 0.0, 0.0]); // ä¼°è®¡çŠ¶æ€
            let dt = 0.01;
            let t_final = 10.0;
            let mut t = 0.0;

            println!("\nå¸¦è§‚æµ‹å™¨çš„æ§åˆ¶ç³»ç»Ÿä»¿çœŸ:");
            println!("æ—¶é—´(s) | çœŸå®è§’åº¦ | ä¼°è®¡è§’åº¦ | æ§åˆ¶è¾“å…¥");

            while t <= t_final {
                let y = &system.c * &x;
                let u = -&k * &x_hat;

                // æ›´æ–°çœŸå®çŠ¶æ€
                let dx = &system.a * &x + &system.b * &u;
                x += dx * dt;

                // æ›´æ–°ä¼°è®¡çŠ¶æ€
                x_hat = observer.estimate(&system, &y, &u, &x_hat, dt);

                t += dt;

                if (t * 100.0).round() as i32 % 50 == 0 {
                    println!("{:.2} | {:.4} | {:.4} | {:.4}",
                             t, x[0], x_hat[0], u[0]);
                }
            }
        }
    }
}
```

## 13 ç›¸å…³ç†è®º

### 13.1 éçº¿æ€§ç³»ç»Ÿç†è®º

- [éçº¿æ€§æ§åˆ¶ç†è®º](../05_Control_Theory/05.3.1_éçº¿æ€§æ§åˆ¶åŸºç¡€.md)
- [æé›…æ™®è¯ºå¤«ç¨³å®šæ€§ç†è®º](../05_Control_Theory/05.2.1_ç°ä»£æ§åˆ¶ç†è®º.md)

### 13.2 æœ€ä¼˜æ§åˆ¶ç†è®º

- [çº¿æ€§äºŒæ¬¡å‹è°ƒèŠ‚å™¨](../05_Control_Theory/05.2.3_æœ€ä¼˜æ§åˆ¶ç†è®º.md)
- [å¡å°”æ›¼æ»¤æ³¢ç†è®º](../05_Control_Theory/05.2.4_çŠ¶æ€ä¼°è®¡ç†è®º.md)

### 13.3 é²æ£’æ§åˆ¶ç†è®º

- [Hâˆæ§åˆ¶ç†è®º](../05_Control_Theory/05.4.1_é²æ£’æ§åˆ¶åŸºç¡€.md)
- [Î¼ç»¼åˆç†è®º](../05_Control_Theory/05.4.2_Î¼ç»¼åˆæ–¹æ³•.md)

### 13.4 è‡ªé€‚åº”æ§åˆ¶ç†è®º

- [æ¨¡å‹å‚è€ƒè‡ªé€‚åº”æ§åˆ¶](../05_Control_Theory/05.5.1_è‡ªé€‚åº”æ§åˆ¶åŸºç¡€.md)
- [è‡ªæ ¡æ­£æ§åˆ¶](../05_Control_Theory/05.5.2_è‡ªæ ¡æ­£æ§åˆ¶.md)

## 12. å‚è€ƒæ–‡çŒ®

1. **Ogata, K.** (2010). _Modern Control Engineering_. Prentice Hall.
2. **Franklin, G. F., Powell, J. D., & Emami-Naeini, A.** (2015). _Feedback Control of Dynamic Systems_. Pearson.
3. **Ã…strÃ¶m, K. J., & Murray, R. M.** (2008). _Feedback Systems: An Introduction for Scientists and Engineers_. Princeton University Press.
4. **Chen, C. T.** (1999). _Linear System Theory and Design_. Oxford University Press.
5. **Kailath, T.** (1980). _Linear Systems_. Prentice Hall.
6. **Antsaklis, P. J., & Michel, A. N.** (2006). _Linear Systems_. BirkhÃ¤user.
7. **Rugh, W. J.** (1996). _Linear System Theory_. Prentice Hall.
8. **Callier, F. M., & Desoer, C. A.** (1991). _Linear System Theory_. Springer.
9. **Wolovich, W. A.** (1974). _Linear Multivariable Systems_. Springer.
10. **Zadeh, L. A., & Desoer, C. A.** (1963). _Linear System Theory: The State Space Approach_. McGraw-Hill.

---

**å…³é”®è¯**: çº¿æ€§ç³»ç»Ÿç†è®ºã€çŠ¶æ€ç©ºé—´ã€ä¼ é€’å‡½æ•°ã€ç¨³å®šæ€§ã€å¯æ§æ€§ã€å¯è§‚æ€§ã€æç‚¹é…ç½®ã€è§‚æµ‹å™¨ã€LQRæ§åˆ¶

**ç›¸å…³æ–‡æ¡£**:

- [05.1.1 åŸºç¡€æ§åˆ¶ç†è®º](05.1.1_åŸºç¡€æ§åˆ¶ç†è®º.md)
- [05.1.3 ç³»ç»Ÿç¨³å®šæ€§ç†è®º](05.1.3_ç³»ç»Ÿç¨³å®šæ€§ç†è®º.md)
- [05.1.4 ç³»ç»Ÿè¾¨è¯†ç†è®º](05.1.4_ç³»ç»Ÿè¾¨è¯†ç†è®º.md)

## 14 æ‰¹åˆ¤æ€§åˆ†æ

### 14.1 å¤šå…ƒç†è®ºè§†è§’

**ä»£æ•°/å‡ ä½•è§†è§’**ï¼šå¯æ§/å¯è§‚ã€æç‚¹/é›¶ç‚¹ã€æœ€å°å®ç°ç­‰æä¾›äº†æ¸…æ™°ç»“æ„åŒ–ç†è§£ï¼Œä½†å¯¹å¼ºéçº¿æ€§å’Œæ—¶å˜ç³»ç»Ÿé€‚é…æœ‰é™ã€‚

**é¢‘åŸŸ/æ—¶åŸŸç»Ÿä¸€è§†è§’**ï¼šLTIæ¡†æ¶ä¸‹äºŒè€…å¯äº’è¯äº’å¯¼ï¼Œä½†ç°å®ç³»ç»Ÿä¸­å­˜åœ¨é‡‡æ ·/æ—¶å»¶/ä¸ç¡®å®šæ€§å¯¼è‡´å‰²è£‚ã€‚

**æ•°å€¼è®¡ç®—è§†è§’**ï¼šæ¡ä»¶æ•°ã€å¯è¾¾æ€§ã€è§‚æµ‹çŸ©é˜µç§©åˆ¤åˆ«åœ¨æ•°å€¼ä¸Šæ˜“å—å™ªå£°ä¸ç—…æ€å½±å“ã€‚

### 14.2 å±€é™æ€§åˆ†æ

**çº¿æ€§å‡è®¾**ï¼šåªåœ¨å·¥ä½œç‚¹é™„è¿‘å¯é ï¼Œå¤§èŒƒå›´å·¥å†µåˆ‡æ¢ä¸é¥±å’Œéçº¿æ€§ä¼šç ´åç»“è®ºã€‚

**å‚æ•°æ—¶å˜**ï¼šæ…¢æ¼‚ç§»ä¸å¿«é€Ÿåˆ‡æ¢åœºæ™¯ä¸‹ï¼Œå›ºå®šå‚æ•°è®¾è®¡éš¾ä»¥ä¿è¯æ€§èƒ½ä¸ç¨³å®šè£•åº¦ã€‚

**æ¨¡å‹ç²’åº¦**ï¼šä½é˜¶æ¨¡å‹ä¾¿äºè®¾è®¡ä½†å¯èƒ½é—æ¼å…³é”®åŠ¨æ€ï¼Œé«˜é˜¶æ¨¡å‹å¯è§£é‡Šæ€§ä¸å®ç°æˆæœ¬é«˜ã€‚

### 14.3 äº‰è®®ä¸åˆ†æ­§

**é¢‘åŸŸæ•´å½¢vsçŠ¶æ€åé¦ˆ**ï¼šä¸¤å¥—æ–¹æ³•è®ºåœ¨å·¥ä¸šç•Œä¸å­¦ç•Œåå¥½ä¸åŒï¼Œè¯„ä»·ç»´åº¦ï¼ˆå¯è§£é‡Šæ€§/å¯å®ç°æ€§/é²æ£’æ€§ï¼‰å„å¼‚ã€‚

**æœ€ä¼˜vsé²æ£’**ï¼šLQR/LQGå¼ºè°ƒæ€§èƒ½ï¼ŒHâˆ/Î¼ç»¼åˆå¼ºè°ƒä¸ç¡®å®šæ€§æŠ‘åˆ¶ï¼Œå¦‚ä½•ç»Ÿä¸€æƒè¡¡å§‹ç»ˆäº‰è®ºã€‚

**è§£ææ€§vsæ•°æ®é©±åŠ¨**ï¼šæ˜¯å¦åº”æ›´å¤šå¼•å…¥æ•°æ®é©±åŠ¨è¯†åˆ«ä¸å­¦ä¹ æ¥å¼¥è¡¥æ¨¡å‹ä¸è¶³ï¼Œè¾¹ç•Œä¸å®‰å…¨æ€§æ˜¯ç„¦ç‚¹ã€‚

### 14.4 åº”ç”¨å‰æ™¯

**å¤§è§„æ¨¡MIMO**ï¼šç”µåŠ›ç”µå­ã€è¿‡ç¨‹å·¥ä¸šã€èˆªå¤©èˆªç©ºä¸­çš„é«˜ç»´è€¦åˆç³»ç»Ÿéœ€è¦ç»“æ„åŒ–è®¾è®¡ä¸åˆ†è§£ã€‚

**åµŒå…¥å¼ä¸è¾¹ç¼˜**ï¼šç®—åŠ›å—é™ä¸‹çš„ä½é˜¶è¿‘ä¼¼ã€å›ºå®šç‚¹å®ç°ä¸èƒ½è€—ä¼˜åŒ–æˆä¸ºå·¥ç¨‹å…³é”®ã€‚

**æ•°å­—å­ªç”Ÿ**ï¼šåœ¨çº¿æ ¡æ­£ä¸è‡ªæ•´å®šæ¨åŠ¨çº¿æ€§ç†è®ºåœ¨å¤æ‚ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸­çš„åº”ç”¨ã€‚

### 14.5 æ”¹è¿›å»ºè®®

**é²æ£’æœ€ä¼˜ååŒ**ï¼šåœ¨ç»å…¸çº¿æ€§æ¡†æ¶ä¸­å¼•å…¥ä¸ç¡®å®šæ€§å»ºæ¨¡ä¸å¤šç›®æ ‡ä¼˜åŒ–ã€‚

**æ•°å€¼ç¨³å¥æµç¨‹**ï¼šé‡‡ç”¨æ­£åˆ™åŒ–ã€å­ç©ºé—´æ³•ã€éšæœºåŒ–çº¿æ€§ä»£æ•°æå‡ç§©åˆ¤åˆ«ä¸æç‚¹é…ç½®ç¨³å®šæ€§ã€‚

**æ¨¡å‹-æ•°æ®é—­ç¯**ï¼šä»¥è¾¨è¯†-éªŒè¯-æ§åˆ¶é—­ç¯æµç¨‹æŒç»­æ›´æ–°æ¨¡å‹ï¼Œæé«˜è½åœ°ä¸€è‡´æ€§ã€‚
