# 04.4.1 依赖函数与依赖对（Π/Σ 类型）

## 📋 目录

- [04.4.1 依赖函数与依赖对（Π/Σ 类型）](#0441-依赖函数与依赖对πς-类型)
  - [📋 目录](#-目录)
  - [1 概述](#1-概述)
  - [2 规则轮廓](#2-规则轮廓)
  - [3 示例](#3-示例)
  - [参考文献](#参考文献)
  - [4 批判性分析](#4-批判性分析)

---

## 1 概述

- Π 类型：`Πx:A. B x`，类型依赖于项 `x` 的函数（对应 ∀）
- Σ 类型：`Σx:A. B x`，携带见证 `x:A` 与性质 `B x` 的成对数据（对应 ∃）

## 2 规则轮廓

- 形成：`Γ ⊢ A:Type, Γ,x:A ⊢ B x:Type ⇒ Γ ⊢ Πx:A. B x : Type`（Σ 同理）
- 引入/消解：λ/应用（Π），pair/投影（Σ）
- 计算：β/η 规则及替换封闭

## 3 示例

```coq
(* 依赖函数与依赖对的基本示意 *)
Require Import Coq.Program.Equality.

Definition dep_id {A:Type} (B:A->Type) :
  (forall x:A, B x -> B x) := fun x b => b.

Record sig_ex (A:Type) (B:A->Type) := {
  wit : A;
  prf : B wit
}.
```

```lean
-- Π/Σ 示例：给定 n，自然数向量 Vec α n 的首元提取
inductive Vec (α : Type) : Nat -> Type
| nil  : Vec 0
| cons : (x : α) -> {n : Nat} -> Vec n -> Vec (n+1)

open Vec

def head {α} : {n : Nat} -> Vec α (n+1) -> α
| .(0+1), cons x _ _ => x
```

## 参考文献

- Martin‑Löf ITT；Coq/Agda/Lean 手册

## 4 批判性分析

- 多元理论视角：
  - 规格承载：Π/Σ 将“输入约束—输出性质—存在见证”内化为类型层级，统一函数规范与数据不变量。
  - 语义连接：与范畴论中的指数对象与纤维化结构形成自然对应，提升跨学科可解释性。
- 局限性分析：
  - 可读性与推断：深层嵌套与复杂依赖使错误定位与推断困难，需要良好IDE与策略化省略。
  - 提取一致性：带见证的数据在提取/运行时的语义保持需明示策略（擦除、证明无关）。
- 争议与分歧：
  - 规格粒度：何种性质进入类型、何种留给测试与运行时断言，需权衡可判定性与工程成本。
- 应用前景：
  - 安全 API 设计、协议与格式的见证化建模、不可变基础设施的类型化保障。
- 改进建议：
  - 提供“从注解到证明携带”的增量路径与模板库；建立提取策略与CI 证据产物审计流程。
