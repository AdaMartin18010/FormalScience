# 1.3 å†…å­˜å­ç³»ç»Ÿ

> **ä¸»é¢˜**: 01. CPUç¡¬ä»¶å±‚ - 1.3 å†…å­˜å­ç³»ç»Ÿ
> **è¦†ç›–**: å†…å­˜æ§åˆ¶å™¨ã€DRAMæ—¶åºã€NUMAæ¶æ„

---

## ğŸ“‹ ç›®å½•

- [1.3 å†…å­˜å­ç³»ç»Ÿ](#13-å†…å­˜å­ç³»ç»Ÿ)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1 å†…å­˜æ§åˆ¶å™¨](#1-å†…å­˜æ§åˆ¶å™¨)
    - [1.1 é›†æˆå†…å­˜æ§åˆ¶å™¨ï¼ˆIMCï¼‰](#11-é›†æˆå†…å­˜æ§åˆ¶å™¨imc)
    - [1.2 é€šé“é…ç½®](#12-é€šé“é…ç½®)
  - [2 DRAMæ—¶åºå‚æ•°](#2-dramæ—¶åºå‚æ•°)
    - [2.1 DDR5æ—¶åºçš„ä¸¥æ ¼åˆ†æ](#21-ddr5æ—¶åºçš„ä¸¥æ ¼åˆ†æ)
    - [2.2 è¡Œç¼“å†²å±€éƒ¨æ€§](#22-è¡Œç¼“å†²å±€éƒ¨æ€§)
  - [3 NUMAæ¶æ„](#3-numaæ¶æ„)
    - [3.1 æ‹“æ‰‘ç»“æ„](#31-æ‹“æ‰‘ç»“æ„)
    - [3.2 OSæ„ŸçŸ¥](#32-osæ„ŸçŸ¥)
  - [4 å®è·µæ¡ˆä¾‹](#4-å®è·µæ¡ˆä¾‹)
    - [4.1 é«˜æ€§èƒ½è®¡ç®—å†…å­˜ä¼˜åŒ–](#41-é«˜æ€§èƒ½è®¡ç®—å†…å­˜ä¼˜åŒ–)
    - [4.2 æ•°æ®åº“å†…å­˜ä¼˜åŒ–](#42-æ•°æ®åº“å†…å­˜ä¼˜åŒ–)
  - [5 å†…å­˜å¢™é—®é¢˜](#5-å†…å­˜å¢™é—®é¢˜)
    - [5.1 ç‰©ç†æœ¬è´¨çš„ä¸¥æ ¼è®ºè¯](#51-ç‰©ç†æœ¬è´¨çš„ä¸¥æ ¼è®ºè¯)
    - [5.2 OSåº”å¯¹](#52-osåº”å¯¹)
  - [6 æ€ç»´å¯¼å›¾ï¼šå†…å­˜å­ç³»ç»Ÿè®¾è®¡æƒè¡¡](#6-æ€ç»´å¯¼å›¾å†…å­˜å­ç³»ç»Ÿè®¾è®¡æƒè¡¡)
  - [7 æ‰¹åˆ¤æ€§æ€»ç»“](#7-æ‰¹åˆ¤æ€§æ€»ç»“)
    - [5.1 å†…å­˜å­ç³»ç»Ÿçš„æ ¹æœ¬çŸ›ç›¾](#51-å†…å­˜å­ç³»ç»Ÿçš„æ ¹æœ¬çŸ›ç›¾)
    - [5.2 2025å¹´å†…å­˜æŠ€æœ¯è¶‹åŠ¿](#52-2025å¹´å†…å­˜æŠ€æœ¯è¶‹åŠ¿)
  - [8 è·¨é¢†åŸŸæ´å¯Ÿ](#8-è·¨é¢†åŸŸæ´å¯Ÿ)
    - [6.1 å†…å­˜å¢™çš„ä¸å¯é€¾è¶Šæ€§](#61-å†…å­˜å¢™çš„ä¸å¯é€¾è¶Šæ€§)
    - [6.2 æ•…éšœä¼ æ’­çš„çº§è”æ”¾å¤§æ•ˆåº”](#62-æ•…éšœä¼ æ’­çš„çº§è”æ”¾å¤§æ•ˆåº”)
  - [9 å¤šç»´åº¦å¯¹æ¯”](#9-å¤šç»´åº¦å¯¹æ¯”)
    - [7.1 å†…å­˜æŠ€æœ¯å¯¹æ¯”ï¼ˆ2025å¹´ï¼‰](#71-å†…å­˜æŠ€æœ¯å¯¹æ¯”2025å¹´)
    - [7.2 å†…å­˜æ¶æ„æ¼”è¿›å¯¹æ¯”](#72-å†…å­˜æ¶æ„æ¼”è¿›å¯¹æ¯”)
  - [10 ç›¸å…³ä¸»é¢˜](#10-ç›¸å…³ä¸»é¢˜)
  - [9 2025å¹´æœ€æ–°æŠ€æœ¯ï¼ˆå·²æ•´åˆviewæ–‡ä»¶å¤¹å†…å®¹ï¼‰](#9-2025å¹´æœ€æ–°æŠ€æœ¯å·²æ•´åˆviewæ–‡ä»¶å¤¹å†…å®¹)
    - [9.1 CXL 3.0å†…å­˜æ‰©å±•è°ƒåº¦ï¼ˆ2025å¹´æ–°å¢ï¼‰](#91-cxl-30å†…å­˜æ‰©å±•è°ƒåº¦2025å¹´æ–°å¢)
    - [9.2 NUMAæ„ŸçŸ¥è°ƒåº¦ä¼˜åŒ–ï¼ˆ2025å¹´æ–°å¢ï¼‰](#92-numaæ„ŸçŸ¥è°ƒåº¦ä¼˜åŒ–2025å¹´æ–°å¢)

---

## 1 å†…å­˜æ§åˆ¶å™¨

### 1.1 é›†æˆå†…å­˜æ§åˆ¶å™¨ï¼ˆIMCï¼‰

**æ¡ˆä¾‹1.3.1ï¼ˆé›†æˆå†…å­˜æ§åˆ¶å™¨ï¼‰**ï¼š

é›†æˆå†…å­˜æ§åˆ¶å™¨ï¼ˆIMCï¼‰æ˜¯ç°ä»£CPUçš„é‡è¦ç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†DRAMè®¿é—®ã€‚

**IMCæ¼”è¿›**ï¼š

- **2008å¹´å‰**ï¼šåŒ—æ¡¥åˆ†ç¦»ï¼Œå»¶è¿Ÿé«˜
- **Nehalemå**ï¼šé›†æˆåˆ°CPUï¼Œå»¶è¿Ÿé™ä½
- **ä¼˜åŠ¿**ï¼šé™ä½å»¶è¿Ÿï¼Œæé«˜å¸¦å®½

**IMCåŠŸèƒ½**ï¼š

**1. å‘½ä»¤è°ƒåº¦ï¼ˆFR-FCFSï¼‰**ï¼š

- **First-Ready First-Come-First-Served**ï¼šä¼˜å…ˆè°ƒåº¦å°±ç»ªçš„å‘½ä»¤
- **è¡Œç¼“å†²ä¼˜åŒ–**ï¼šä¼˜å…ˆè°ƒåº¦è¡Œç¼“å†²å‘½ä¸­çš„å‘½ä»¤
- **æé«˜å¸¦å®½åˆ©ç”¨ç‡**ï¼šæé«˜DRAMå¸¦å®½åˆ©ç”¨ç‡

**2. æ—¶åºç®¡ç†**ï¼š

- **æ—¶åºçº¦æŸ**ï¼šç®¡ç†DRAMæ—¶åºå‚æ•°ï¼ˆtCLã€tRCDã€tRPç­‰ï¼‰
- **å‘½ä»¤è°ƒåº¦**ï¼šç¡®ä¿å‘½ä»¤æ»¡è¶³æ—¶åºçº¦æŸ
- **å»¶è¿Ÿä¼˜åŒ–**ï¼šä¼˜åŒ–å‘½ä»¤è°ƒåº¦å‡å°‘å»¶è¿Ÿ

**3. åˆ·æ–°æ§åˆ¶**ï¼š

- **è‡ªåŠ¨åˆ·æ–°**ï¼šå®šæœŸåˆ·æ–°DRAMè¡Œ
- **æ¸©åº¦è¡¥å¿**ï¼šæ ¹æ®æ¸©åº¦è°ƒæ•´åˆ·æ–°å‘¨æœŸ
- **åˆ·æ–°è°ƒåº¦**ï¼šä¼˜åŒ–åˆ·æ–°æ—¶æœºå‡å°‘æ€§èƒ½å½±å“

**4. ECCçº é”™**ï¼š

- **é”™è¯¯æ£€æµ‹**ï¼šæ£€æµ‹å•æ¯”ç‰¹é”™è¯¯
- **é”™è¯¯çº æ­£**ï¼šçº æ­£å•æ¯”ç‰¹é”™è¯¯
- **å¯é æ€§æå‡**ï¼šæé«˜ç³»ç»Ÿå¯é æ€§

**IMCå®ç°**ï¼š

```c
// é›†æˆå†…å­˜æ§åˆ¶å™¨å®ç°ï¼ˆä¼ªä»£ç ï¼‰
typedef struct {
    // å‘½ä»¤é˜Ÿåˆ—
    struct {
        dram_command_t commands[CMD_QUEUE_SIZE];
        int head;
        int tail;
        int count;
    } cmd_queue;

    // æ—¶åºç®¡ç†
    struct {
        uint64_t tCL;   // CASå»¶è¿Ÿ
        uint64_t tRCD;  // RASåˆ°CASå»¶è¿Ÿ
        uint64_t tRP;   // RASé¢„å……ç”µå»¶è¿Ÿ
        uint64_t tRAS;  // RASæ¿€æ´»æ—¶é—´
    } timing;

    // åˆ·æ–°æ§åˆ¶
    struct {
        uint64_t refresh_interval;  // åˆ·æ–°é—´éš”
        uint64_t last_refresh;      // ä¸Šæ¬¡åˆ·æ–°æ—¶é—´
        int pending_refresh;        // å¾…åˆ·æ–°è¡Œæ•°
    } refresh;

    // ECCæ§åˆ¶
    struct {
        bool ecc_enabled;
        uint64_t error_count;
    } ecc;
} imc_t;

// å‘½ä»¤è°ƒåº¦ï¼ˆFR-FCFSï¼‰
dram_command_t *schedule_command(imc_t *imc) {
    dram_command_t *best_cmd = NULL;
    int best_priority = -1;

    // 1. éå†å‘½ä»¤é˜Ÿåˆ—
    for (int i = imc->cmd_queue.head; i != imc->cmd_queue.tail;
         i = (i + 1) % CMD_QUEUE_SIZE) {
        dram_command_t *cmd = &imc->cmd_queue.commands[i];

        // 2. æ£€æŸ¥å‘½ä»¤æ˜¯å¦å°±ç»ª
        if (is_command_ready(imc, cmd)) {
            // 3. è®¡ç®—ä¼˜å…ˆçº§ï¼ˆFR-FCFSï¼‰
            int priority = calculate_priority(imc, cmd);

            // 4. é€‰æ‹©æœ€é«˜ä¼˜å…ˆçº§å‘½ä»¤
            if (priority > best_priority) {
                best_priority = priority;
                best_cmd = cmd;
            }
        }
    }

    return best_cmd;
}

// è®¡ç®—ä¼˜å…ˆçº§ï¼ˆFR-FCFSï¼‰
int calculate_priority(imc_t *imc, dram_command_t *cmd) {
    int priority = 0;

    // 1. è¡Œç¼“å†²å‘½ä¸­ä¼˜å…ˆ
    if (is_row_buffer_hit(imc, cmd)) {
        priority += 100;
    }

    // 2. å°±ç»ªæ—¶é—´ä¼˜å…ˆ
    priority += (1000 - cmd->ready_time);

    return priority;
}

// æ—¶åºç®¡ç†
bool check_timing_constraints(imc_t *imc, dram_command_t *cmd) {
    // 1. æ£€æŸ¥tCLçº¦æŸ
    if (cmd->type == READ &&
        (current_time - cmd->activate_time) < imc->timing.tCL) {
        return false;
    }

    // 2. æ£€æŸ¥tRCDçº¦æŸ
    if (cmd->type == ACTIVATE &&
        (current_time - cmd->precharge_time) < imc->timing.tRCD) {
        return false;
    }

    // 3. æ£€æŸ¥tRPçº¦æŸ
    if (cmd->type == PRECHARGE &&
        (current_time - cmd->activate_time) < imc->timing.tRP) {
        return false;
    }

    return true;
}
```

**æ·±åº¦è®ºè¯ï¼šIMCé›†æˆçš„æ€§èƒ½ä¼˜åŠ¿**

**IMCé›†æˆçš„å»¶è¿Ÿé™ä½**ï¼š

IMCé›†æˆåˆ°CPUåï¼Œæ¶ˆé™¤äº†**åŒ—æ¡¥å»¶è¿Ÿ**ï¼š

$$
\text{å»¶è¿Ÿé™ä½} = t_{\text{åŒ—æ¡¥}} + t_{\text{QPI}} \approx 20\text{ns}
$$

å…¶ä¸­$t_{\text{åŒ—æ¡¥}}$æ˜¯åŒ—æ¡¥å»¶è¿Ÿï¼ˆ~15nsï¼‰ï¼Œ$t_{\text{QPI}}$æ˜¯QPIæ€»çº¿å»¶è¿Ÿï¼ˆ~5nsï¼‰ã€‚

**é‡åŒ–å¯¹æ¯”**ï¼šåˆ†ç¦»å¼ vs é›†æˆå¼IMC

| **æ¶æ„** | **å»¶è¿Ÿ** | **å¸¦å®½** | **åŠŸè€—** | **ä¼˜åŠ¿** |
|---------|---------|----------|---------|---------|
| **åˆ†ç¦»å¼ï¼ˆåŒ—æ¡¥ï¼‰** | 100ns | 25GB/s | é«˜ | æ—  |
| **é›†æˆå¼ï¼ˆIMCï¼‰** | 80ns | 50GB/s | ä½ | æ˜¾è‘— |

**å…³é”®æ´å¯Ÿ**ï¼šIMCé›†æˆå°†å†…å­˜å»¶è¿Ÿé™ä½**20%**ï¼ŒåŒæ—¶æå‡å¸¦å®½å’Œé™ä½åŠŸè€—ã€‚

### 1.2 é€šé“é…ç½®

**æ¡ˆä¾‹1.3.2ï¼ˆå¤šé€šé“å†…å­˜é…ç½®ï¼‰**ï¼š

å¤šé€šé“å†…å­˜é…ç½®é€šè¿‡å¢åŠ é€šé“æ•°æé«˜å¸¦å®½ï¼Œä½†å»¶è¿Ÿä¸å˜ã€‚

**é€šé“é…ç½®å¯¹æ¯”**ï¼š

| **é…ç½®** | **é€šé“æ•°** | **å¸¦å®½** | **å»¶è¿Ÿ** | **æˆæœ¬** | **é€‚ç”¨åœºæ™¯** |
|---------|-----------|----------|----------|---------|------------|
| **åŒé€šé“** | 2 | 50GB/s | 80ns | ä½ | æ¶ˆè´¹çº§ |
| **å››é€šé“** | 4 | 100GB/s | 80ns | ä¸­ | å·¥ä½œç«™ |
| **å…«é€šé“** | 8 | 200GB/s | 80ns | é«˜ | æœåŠ¡å™¨ |

**å¤šé€šé“å®ç°**ï¼š

```c
// å¤šé€šé“å†…å­˜æ§åˆ¶å™¨å®ç°ï¼ˆä¼ªä»£ç ï¼‰
typedef struct {
    // å¤šä¸ªé€šé“
    struct {
        dram_channel_t channel;
        uint64_t bandwidth_used;
        uint64_t requests_served;
    } channels[MAX_CHANNELS];

    int channel_count;

    // é€šé“é€‰æ‹©ç­–ç•¥
    channel_selection_t selection_policy;
} multi_channel_imc_t;

// é€šé“é€‰æ‹©ï¼ˆè½®è¯¢æˆ–è´Ÿè½½å‡è¡¡ï¼‰
int select_channel(multi_channel_imc_t *imc, uint64_t addr) {
    switch (imc->selection_policy) {
    case ROUND_ROBIN:
        // è½®è¯¢é€‰æ‹©
        return (addr >> 6) % imc->channel_count;

    case LOAD_BALANCE:
        // è´Ÿè½½å‡è¡¡é€‰æ‹©
        int min_load_channel = 0;
        uint64_t min_load = imc->channels[0].bandwidth_used;

        for (int i = 1; i < imc->channel_count; i++) {
            if (imc->channels[i].bandwidth_used < min_load) {
                min_load = imc->channels[i].bandwidth_used;
                min_load_channel = i;
            }
        }

        return min_load_channel;

    case ADDRESS_HASH:
        // åœ°å€å“ˆå¸Œé€‰æ‹©
        return hash_address(addr) % imc->channel_count;

    default:
        return 0;
    }
}

// å¤šé€šé“è®¿é—®
bool multi_channel_access(multi_channel_imc_t *imc, uint64_t addr,
                          bool is_write, uint8_t *data) {
    // 1. é€‰æ‹©é€šé“
    int channel = select_channel(imc, addr);

    // 2. è®¿é—®é€‰å®šé€šé“
    bool success = channel_access(&imc->channels[channel].channel,
                                  addr, is_write, data);

    // 3. æ›´æ–°ç»Ÿè®¡
    if (success) {
        imc->channels[channel].bandwidth_used += 64;  // 64å­—èŠ‚
        imc->channels[channel].requests_served++;
    }

    return success;
}
```

**æ·±åº¦è®ºè¯ï¼šå¤šé€šé“çš„å¸¦å®½æ‰©å±•**

**å¤šé€šé“çš„å¸¦å®½æ¨¡å‹**ï¼š

å¤šé€šé“å¸¦å®½ä¸é€šé“æ•°**çº¿æ€§æ‰©å±•**ï¼š

$$
\text{æ€»å¸¦å®½} = N \times \text{å•é€šé“å¸¦å®½}
$$

å…¶ä¸­$N$æ˜¯é€šé“æ•°ã€‚

**é‡åŒ–åˆ†æ**ï¼šä¸åŒé€šé“é…ç½®çš„æ€§èƒ½å½±å“

| **é€šé“æ•°** | **å¸¦å®½** | **å»¶è¿Ÿ** | **æˆæœ¬** | **é€‚ç”¨åœºæ™¯** |
|-----------|----------|----------|---------|------------|
| **2** | 50GB/s | 80ns | ä½ | æ¶ˆè´¹çº§ |
| **4** | 100GB/s | 80ns | ä¸­ | å·¥ä½œç«™ |
| **8** | 200GB/s | 80ns | é«˜ | æœåŠ¡å™¨ |

**å…³é”®æƒè¡¡**ï¼šå¤šé€šé“æå‡**å¸¦å®½**ï¼Œä½†**æˆæœ¬å¢åŠ **ï¼Œå»¶è¿Ÿä¸å˜ã€‚

---

## 2 DRAMæ—¶åºå‚æ•°

### 2.1 DDR5æ—¶åºçš„ä¸¥æ ¼åˆ†æ

**DRAMæ—¶åºè°ƒåº¦ï¼ˆviewæ–‡ä»¶å¤¹è¡¥å……ï¼‰**ï¼š

**DRAMè®¿é—®æ—¶åº**ï¼š

- **tCLï¼ˆCAS Latencyï¼‰**ï¼šåˆ—åœ°å€é€‰é€šå»¶è¿Ÿ
- **tRCDï¼ˆRAS to CAS Delayï¼‰**ï¼šè¡Œåˆ°åˆ—å»¶è¿Ÿ
- **tRPï¼ˆRAS Prechargeï¼‰**ï¼šè¡Œé¢„å……ç”µæ—¶é—´
- **tFAWï¼ˆFour Activate Windowï¼‰**ï¼šå››æ¿€æ´»çª—å£æ—¶é—´

**FR-FCFSè°ƒåº¦ç®—æ³•**ï¼š

ä¼˜å…ˆè°ƒåº¦è¡Œå‘½ä¸­ï¼ˆRow Hitï¼‰è¯·æ±‚ï¼Œæœ€å¤§åŒ–DRAMå¸¦å®½åˆ©ç”¨ç‡ã€‚

**æ¡ˆä¾‹1.3.3ï¼ˆDDR5æ—¶åºç®¡ç†ï¼‰**ï¼š

DDR5æ—¶åºå‚æ•°æ˜¯DRAMè®¿é—®çš„å…³é”®çº¦æŸï¼Œç”±ç‰©ç†ç‰¹æ€§å†³å®šã€‚

**å…³é”®å‚æ•°**ï¼š

- **tCL** (CAS Latency)ï¼š48å‘¨æœŸï¼ˆDDR5-5600ï¼‰
- **tRCD** (RAS to CAS Delay)ï¼š48å‘¨æœŸ
- **tRP** (RAS Precharge)ï¼š48å‘¨æœŸ
- **tRAS** (RAS Active Time)ï¼š~100å‘¨æœŸ

**å®šç†1.4ï¼ˆDRAMè®¿é—®å»¶è¿Ÿçš„ä¸‹ç•Œï¼‰**ï¼š

å¯¹äºDDR5-5600ï¼Œè¡Œç¼“å†²æœªå‘½ä¸­æ—¶çš„è®¿é—®å»¶è¿Ÿæ»¡è¶³ï¼š

$$
L_{\text{DRAM}} \geq t_{\text{CL}} + t_{\text{RCD}} + t_{\text{RP}} = 48 + 48 + 48 = 144 \text{å‘¨æœŸ} \approx 50\text{ns}
$$

**è¯æ˜**ï¼šDRAMè®¿é—®å¿…é¡»å®Œæˆä»¥ä¸‹æ—¶åºï¼š

1. è¡Œæ¿€æ´»ï¼ˆtRCDï¼‰ï¼š48å‘¨æœŸ
2. åˆ—è®¿é—®ï¼ˆtCLï¼‰ï¼š48å‘¨æœŸ
3. é¢„å……ç”µï¼ˆtRPï¼‰ï¼š48å‘¨æœŸï¼ˆå¦‚æœè¡Œå…³é—­ï¼‰

å› æ­¤ï¼Œä¸‹ç•Œä¸º144å‘¨æœŸã€‚å®é™…æµ‹é‡çº¦80nsï¼ˆåŒ…æ‹¬ä¼ è¾“æ—¶é—´ï¼‰ã€‚âˆ

**åˆ·æ–°å‘¨æœŸçš„ç‰©ç†æœ¬è´¨**ï¼š

**å®šç†1.5ï¼ˆDRAMåˆ·æ–°å‘¨æœŸçš„ç‰©ç†ä¸‹ç•Œï¼‰**ï¼š

DRAMåˆ·æ–°å‘¨æœŸ$T_{\text{refresh}}$å¿…é¡»æ»¡è¶³ï¼š

$$
T_{\text{refresh}} \leq \frac{C \times V}{I_{\text{leak}}}
$$

å…¶ä¸­$C$æ˜¯ç”µå®¹ï¼Œ$V$æ˜¯ç”µå‹ï¼Œ$I_{\text{leak}}$æ˜¯æ¼ç”µæµã€‚

**è¯æ˜**ï¼šç”µå®¹ç”µè·ä¼šå› æ¼ç”µæµè€Œè¡°å‡ã€‚åˆ·æ–°å‘¨æœŸå¿…é¡»å°äºç”µè·è¡°å‡åˆ°ä¸å¯è¯»çš„æ—¶é—´ã€‚å¯¹äºDDR5ï¼Œå…¸å‹å€¼ä¸º64msã€‚âˆ

**åˆ·æ–°å‘¨æœŸ**ï¼š

- **64ms**ï¼š8192è¡Œå…¨éƒ¨åˆ·æ–°
- **æ¸©åº¦è¡¥å¿**ï¼šé«˜æ¸©æ—¶æ¼ç”µæµå¢åŠ ï¼Œç¼©çŸ­å‘¨æœŸ

**æ‰¹åˆ¤æ€§åˆ†æ**ï¼š

1. **æ—¶åºå‚æ•°çš„ä¸å¯ä¼˜åŒ–æ€§**ï¼šDRAMæ—¶åºç”±**ç‰©ç†ç‰¹æ€§å†³å®š**ï¼Œæ— æ³•é€šè¿‡è½¯ä»¶ä¼˜åŒ–ã€‚

2. **åˆ·æ–°å¼€é”€çš„å¿…ç„¶æ€§**ï¼šåˆ·æ–°æ“ä½œ**æš‚åœå‘½ä»¤è°ƒåº¦**ï¼Œæ˜¯DRAMçš„å›ºæœ‰å¼€é”€ã€‚

3. **2025å¹´è¶‹åŠ¿**ï¼š**HBM3**ï¼ˆé«˜å¸¦å®½å†…å­˜ï¼‰å»¶è¿Ÿæ›´ä½ï¼ˆ~30nsï¼‰ï¼Œä½†æˆæœ¬é«˜ï¼Œä¸»è¦ç”¨äºé«˜æ€§èƒ½è®¡ç®—ã€‚

### 2.2 è¡Œç¼“å†²å±€éƒ¨æ€§

**æ¡ˆä¾‹1.3.4ï¼ˆè¡Œç¼“å†²ä¼˜åŒ–ï¼‰**ï¼š

è¡Œç¼“å†²æ˜¯DRAMçš„é‡è¦ä¼˜åŒ–æœºåˆ¶ï¼Œåˆ©ç”¨è¡Œç¼“å†²å±€éƒ¨æ€§å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚

**è¡Œç¼“å†²åŸç†**ï¼š

**1. æ‰“å¼€è¡Œï¼ˆRowï¼‰åï¼Œåˆ—ï¼ˆColumnï¼‰è®¿é—®å¿«é€Ÿ**ï¼š

- **è¡Œæ¿€æ´»**ï¼šæ¿€æ´»DRAMè¡Œï¼Œæ•°æ®åŠ è½½åˆ°è¡Œç¼“å†²
- **åˆ—è®¿é—®**ï¼šè®¿é—®è¡Œç¼“å†²ä¸­çš„åˆ—ï¼Œå»¶è¿Ÿä½
- **è¡Œå…³é—­**ï¼šå…³é—­è¡Œï¼Œé‡Šæ”¾è¡Œç¼“å†²

**2. è¡Œç¼“å†²å‘½ä¸­ vs æœªå‘½ä¸­**ï¼š

- **è¡Œç¼“å†²å‘½ä¸­**ï¼š~20nsï¼ˆåªéœ€è¦åˆ—è®¿é—®ï¼‰
- **è¡Œç¼“å†²æœªå‘½ä¸­**ï¼š~80nsï¼ˆéœ€è¦è¡Œæ¿€æ´»+åˆ—è®¿é—®ï¼‰

**è¡Œç¼“å†²ç®¡ç†å®ç°**ï¼š

```c
// è¡Œç¼“å†²ç®¡ç†å®ç°ï¼ˆä¼ªä»£ç ï¼‰
typedef struct {
    // è¡Œç¼“å†²çŠ¶æ€
    struct {
        int open_row;           // å½“å‰æ‰“å¼€çš„è¡Œ
        bool row_open;          // è¡Œæ˜¯å¦æ‰“å¼€
        uint64_t open_time;     // æ‰“å¼€æ—¶é—´
    } row_buffer[MAX_BANKS];

    // ç»Ÿè®¡ä¿¡æ¯
    uint64_t row_hits;
    uint64_t row_misses;
} row_buffer_manager_t;

// è¡Œç¼“å†²è®¿é—®
bool row_buffer_access(row_buffer_manager_t *rbm, int bank, int row, int col,
                       bool is_write, uint8_t *data) {
    // 1. æ£€æŸ¥è¡Œç¼“å†²çŠ¶æ€
    if (rbm->row_buffer[bank].row_open &&
        rbm->row_buffer[bank].open_row == row) {
        // 2. è¡Œç¼“å†²å‘½ä¸­
        rbm->row_hits++;

        // 2.1 ç›´æ¥è®¿é—®åˆ—
        return column_access(bank, col, is_write, data);
    } else {
        // 3. è¡Œç¼“å†²æœªå‘½ä¸­
        rbm->row_misses++;

        // 3.1 å¦‚æœè¡Œå·²æ‰“å¼€ï¼Œéœ€è¦é¢„å……ç”µ
        if (rbm->row_buffer[bank].row_open) {
            precharge_row(bank);
        }

        // 3.2 æ¿€æ´»æ–°è¡Œ
        activate_row(bank, row);

        // 3.3 æ›´æ–°è¡Œç¼“å†²çŠ¶æ€
        rbm->row_buffer[bank].open_row = row;
        rbm->row_buffer[bank].row_open = true;
        rbm->row_buffer[bank].open_time = current_time;

        // 3.4 è®¿é—®åˆ—
        return column_access(bank, col, is_write, data);
    }
}

// è¡Œç¼“å†²å‘½ä¸­ç‡ä¼˜åŒ–
void optimize_row_buffer_hit_rate(row_buffer_manager_t *rbm) {
    // 1. è®¡ç®—å‘½ä¸­ç‡
    double hit_rate = (double)rbm->row_hits /
                      (rbm->row_hits + rbm->row_misses);

    // 2. å¦‚æœå‘½ä¸­ç‡ä½ï¼Œè€ƒè™‘ä¼˜åŒ–ç­–ç•¥
    if (hit_rate < 0.8) {
        // 2.1 ä½¿ç”¨é¡µæ¨¡å¼ï¼ˆPage Modeï¼‰
        enable_page_mode();

        // 2.2 ä¼˜åŒ–è®¿é—®æ¨¡å¼ï¼ˆé¡ºåºè®¿é—®ï¼‰
        optimize_access_pattern();
    }
}
```

**æ·±åº¦è®ºè¯ï¼šè¡Œç¼“å†²çš„æ€§èƒ½ä¼˜åŠ¿**

**è¡Œç¼“å†²çš„å»¶è¿Ÿæ¨¡å‹**ï¼š

è¡Œç¼“å†²å‘½ä¸­æ—¶ï¼Œåªéœ€è¦**åˆ—è®¿é—®**ï¼š

$$
\text{è¡Œç¼“å†²å‘½ä¸­å»¶è¿Ÿ} = t_{\text{CL}} \approx 20\text{ns}
$$

è¡Œç¼“å†²æœªå‘½ä¸­æ—¶ï¼Œéœ€è¦**è¡Œæ¿€æ´»+åˆ—è®¿é—®**ï¼š

$$
\text{è¡Œç¼“å†²æœªå‘½ä¸­å»¶è¿Ÿ} = t_{\text{RCD}} + t_{\text{CL}} \approx 80\text{ns}
$$

**é‡åŒ–åˆ†æ**ï¼šè¡Œç¼“å†²å‘½ä¸­ç‡å¯¹æ€§èƒ½çš„å½±å“

| **å‘½ä¸­ç‡** | **å¹³å‡å»¶è¿Ÿ** | **æ€§èƒ½** | **ä¼˜åŒ–ç­–ç•¥** |
|-----------|------------|---------|------------|
| **50%** | 50ns | åŸºå‡† | æ—  |
| **80%** | 32ns | +36% | é¡µå¯¹é½ |
| **95%** | 23ns | +54% | å¤§é¡µ |

**ä¼˜åŒ–**ï¼š

- OSé¡µå¤§å°4KBåŒ¹é…Bank

**å…³é”®æ´å¯Ÿ**ï¼šè¡Œç¼“å†²å‘½ä¸­ç‡å¯¹æ€§èƒ½å½±å“æ˜¾è‘—ï¼Œ**æé«˜å‘½ä¸­ç‡**å¯ä»¥å¤§å¹…é™ä½å»¶è¿Ÿã€‚

- é¡ºåºè®¿é—®åˆ©ç”¨å±€éƒ¨æ€§

---

## 3 NUMAæ¶æ„

### 3.1 æ‹“æ‰‘ç»“æ„

**NUMAæ¶æ„è°ƒåº¦ï¼ˆviewæ–‡ä»¶å¤¹è¡¥å……ï¼‰**ï¼š

**NUMAæ‹“æ‰‘**ï¼š

ç°ä»£å¤šå¤„ç†å™¨ç³»ç»Ÿé‡‡ç”¨NUMAï¼ˆNon-Uniform Memory Accessï¼‰æ¶æ„ï¼Œæ¯ä¸ªNUMAèŠ‚ç‚¹åŒ…å«ï¼š

- ä¸€ç»„CPUæ ¸å¿ƒ
- æœ¬åœ°å†…å­˜æ§åˆ¶å™¨
- æœ¬åœ°å†…å­˜

**NUMAè·ç¦»çŸ©é˜µ**ï¼š

$$
\text{distance}(node_i, node_j) =
\begin{cases}
10 & \text{if } i = j \text{ (æœ¬åœ°è®¿é—®)} \\
21 & \text{if } i \neq j \text{ (è¿œç¨‹è®¿é—®)}
\end{cases}
$$

**NUMAæ„ŸçŸ¥è°ƒåº¦**ï¼š

æ“ä½œç³»ç»Ÿé€šè¿‡NUMAæ„ŸçŸ¥è°ƒåº¦ï¼Œå°†è¿›ç¨‹ç»‘å®šåˆ°æœ¬åœ°NUMAèŠ‚ç‚¹ï¼Œé¿å…è·¨èŠ‚ç‚¹å†…å­˜è®¿é—®çš„æ€§èƒ½æŸå¤±ã€‚

**æ¡ˆä¾‹1.3.5ï¼ˆNUMAæ¶æ„ï¼‰**ï¼š

NUMAï¼ˆNon-Uniform Memory Accessï¼‰æ¶æ„æ˜¯å¤šæ ¸ç³»ç»Ÿçš„é‡è¦è®¾è®¡ï¼Œä¸åŒSocketçš„å†…å­˜è®¿é—®å»¶è¿Ÿä¸åŒã€‚

**2è·¯NUMAæ‹“æ‰‘**ï¼š

```text
Socket 0          Socket 1
  CPU0              CPU1
  IMC0              IMC1
  Memory0           Memory1
    |                  |
    â””â”€â”€â”€ QPI/UPI â”€â”€â”€â”€â”€â”€â”˜
```

**NUMAè®¿é—®å»¶è¿Ÿ**ï¼š

- **æœ¬åœ°å†…å­˜**ï¼š80nsï¼ˆç›´æ¥è®¿é—®æœ¬åœ°IMCï¼‰
- **è¿œç¨‹å†…å­˜**ï¼š150nsï¼ˆ+70nsï¼Œéœ€è¦è·¨Socketé€šä¿¡ï¼‰

**NUMAå®ç°**ï¼š

```c
// NUMAå†…å­˜è®¿é—®å®ç°ï¼ˆä¼ªä»£ç ï¼‰
typedef struct {
    // NUMAèŠ‚ç‚¹
    struct {
        int node_id;
        imc_t *imc;
        uint64_t memory_base;
        uint64_t memory_size;
    } nodes[MAX_NUMA_NODES];

    int node_count;

    // è·¨èŠ‚ç‚¹äº’è¿ï¼ˆQPI/UPIï¼‰
    interconnect_t *interconnect;
} numa_system_t;

// NUMAå†…å­˜è®¿é—®
bool numa_memory_access(numa_system_t *numa, int cpu_id, uint64_t addr,
                        bool is_write, uint8_t *data) {
    // 1. ç¡®å®šCPUæ‰€åœ¨çš„NUMAèŠ‚ç‚¹
    int cpu_node = get_cpu_numa_node(cpu_id);

    // 2. ç¡®å®šå†…å­˜åœ°å€æ‰€åœ¨çš„NUMAèŠ‚ç‚¹
    int mem_node = get_memory_numa_node(numa, addr);

    // 3. åˆ¤æ–­æ˜¯æœ¬åœ°è¿˜æ˜¯è¿œç¨‹è®¿é—®
    if (cpu_node == mem_node) {
        // 3.1 æœ¬åœ°è®¿é—®
        return local_memory_access(numa->nodes[cpu_node].imc, addr,
                                   is_write, data);
    } else {
        // 3.2 è¿œç¨‹è®¿é—®
        return remote_memory_access(numa, cpu_node, mem_node, addr,
                                    is_write, data);
    }
}

// è¿œç¨‹å†…å­˜è®¿é—®
bool remote_memory_access(numa_system_t *numa, int cpu_node, int mem_node,
                          uint64_t addr, bool is_write, uint8_t *data) {
    // 1. é€šè¿‡äº’è¿å‘é€è¯·æ±‚
    numa_request_t req;
    req.type = is_write ? WRITE : READ;
    req.addr = addr;
    req.data = data;
    req.size = 64;  // 64å­—èŠ‚

    // 2. å‘é€åˆ°è¿œç¨‹èŠ‚ç‚¹
    send_interconnect_request(numa->interconnect, cpu_node, mem_node, &req);

    // 3. ç­‰å¾…å“åº”
    numa_response_t *resp = wait_interconnect_response(numa->interconnect,
                                                        &req);

    // 4. å¤„ç†å“åº”
    if (resp->success) {
        if (!is_write) {
            memcpy(data, resp->data, 64);
        }
        return true;
    }

    return false;
}
```

**æ·±åº¦è®ºè¯ï¼šNUMAçš„å»¶è¿Ÿå·®å¼‚**

**NUMAå»¶è¿Ÿçš„ç»„æˆ**ï¼š

è¿œç¨‹å†…å­˜è®¿é—®éœ€è¦**è·¨Socketé€šä¿¡**ï¼š

$$
\text{è¿œç¨‹å†…å­˜å»¶è¿Ÿ} = t_{\text{æœ¬åœ°å†…å­˜}} + t_{\text{QPI/UPI}} + t_{\text{è¿œç¨‹IMC}} \approx 150\text{ns}
$$

å…¶ä¸­$t_{\text{æœ¬åœ°å†…å­˜}}$æ˜¯æœ¬åœ°å†…å­˜å»¶è¿Ÿï¼ˆ~80nsï¼‰ï¼Œ$t_{\text{QPI/UPI}}$æ˜¯è·¨Socketé€šä¿¡å»¶è¿Ÿï¼ˆ~50nsï¼‰ï¼Œ$t_{\text{è¿œç¨‹IMC}}$æ˜¯è¿œç¨‹å†…å­˜æ§åˆ¶å™¨å»¶è¿Ÿï¼ˆ~20nsï¼‰ã€‚

**é‡åŒ–åˆ†æ**ï¼šä¸åŒNUMAé…ç½®çš„æ€§èƒ½å½±å“

| **é…ç½®** | **æœ¬åœ°å»¶è¿Ÿ** | **è¿œç¨‹å»¶è¿Ÿ** | **å»¶è¿Ÿæ¯”** | **æ€§èƒ½å½±å“** |
|---------|------------|------------|-----------|------------|
| **UMA** | 80ns | 80ns | 1.0x | åŸºå‡† |
| **2è·¯NUMA** | 80ns | 150ns | 1.9x | ä¸­ç­‰ |
| **4è·¯NUMA** | 80ns | 200ns | 2.5x | é«˜ |
| **8è·¯NUMA** | 80ns | 300ns | 3.8x | æé«˜ |

**å…³é”®æƒè¡¡**ï¼šNUMAåœ¨**æ‰©å±•æ€§**æ–¹é¢ä¼˜åŠ¿æ˜æ˜¾ï¼Œä½†**è¿œç¨‹è®¿é—®å»¶è¿Ÿ**æ˜¾è‘—å¢åŠ ã€‚

### 3.2 OSæ„ŸçŸ¥

**æ¡ˆä¾‹1.3.6ï¼ˆNUMA OSæ„ŸçŸ¥ï¼‰**ï¼š

æ“ä½œç³»ç»Ÿéœ€è¦æ„ŸçŸ¥NUMAæ‹“æ‰‘ï¼Œä¼˜åŒ–å†…å­˜åˆ†é…å’Œè¿›ç¨‹è°ƒåº¦ã€‚

**è°ƒåº¦åŸŸ**ï¼š

**1. L3ç¼“å­˜åŸŸ**ï¼š

- **ç¼“å­˜å…±äº«åŸŸ**ï¼šå…±äº«L3ç¼“å­˜çš„æ ¸å¿ƒ
- **è´Ÿè½½å‡è¡¡**ï¼šåœ¨ç¼“å­˜åŸŸå†…è¿›è¡Œè´Ÿè½½å‡è¡¡
- **å‡å°‘ç¼“å­˜å¤±æ•ˆ**ï¼šé¿å…è·¨ç¼“å­˜åŸŸè¿ç§»

**2. NUMAèŠ‚ç‚¹åŸŸ**ï¼š

- **å†…å­˜å…±äº«åŸŸ**ï¼šå…±äº«æœ¬åœ°å†…å­˜çš„CPU
- **å†…å­˜äº²å’Œæ€§**ï¼šä¼˜å…ˆåœ¨æœ¬åœ°èŠ‚ç‚¹åˆ†é…å†…å­˜
- **å‡å°‘è¿œç¨‹è®¿é—®**ï¼šå‡å°‘è·¨èŠ‚ç‚¹å†…å­˜è®¿é—®

**3. è´Ÿè½½å‡è¡¡æ¯100ms**ï¼š

- **å®šæœŸæ£€æŸ¥**ï¼šæ¯100msæ£€æŸ¥è´Ÿè½½åˆ†å¸ƒ
- **è¿ç§»å†³ç­–**ï¼šå†³å®šæ˜¯å¦è¿ç§»è¿›ç¨‹æˆ–å†…å­˜
- **å¼€é”€æ§åˆ¶**ï¼šæ§åˆ¶è¿ç§»å¼€é”€

**NUMA Balancingå®ç°**ï¼š

```c
// NUMA Balancingå®ç°ï¼ˆä¼ªä»£ç ï¼‰
typedef struct {
    // é‡‡æ ·ä¿¡æ¯
    struct {
        uint64_t local_accesses;
        uint64_t remote_accesses;
        uint64_t total_accesses;
    } samples[MAX_NUMA_NODES];

    // è¿ç§»é˜ˆå€¼
    double migration_threshold;

    // é‡‡æ ·é—´éš”
    uint64_t sample_interval;
    uint64_t last_sample_time;
} numa_balancer_t;

// NUMA Balancingä¸»å¾ªç¯
void numa_balancing_loop(numa_balancer_t *balancer) {
    while (1) {
        // 1. ç­‰å¾…é‡‡æ ·é—´éš”
        sleep_until(balancer->last_sample_time + balancer->sample_interval);

        // 2. é‡‡æ ·å†…å­˜è®¿é—®
        sample_memory_accesses(balancer);

        // 3. è®¡ç®—æœ¬åœ°è®¿é—®ç‡
        for (int node = 0; node < MAX_NUMA_NODES; node++) {
            double local_rate = (double)balancer->samples[node].local_accesses /
                               balancer->samples[node].total_accesses;

            // 4. å¦‚æœæœ¬åœ°è®¿é—®ç‡ä½ï¼Œè€ƒè™‘è¿ç§»
            if (local_rate < balancer->migration_threshold) {
                migrate_pages_to_local_node(node);
            }
        }

        // 5. æ›´æ–°é‡‡æ ·æ—¶é—´
        balancer->last_sample_time = current_time;
    }
}

// é‡‡æ ·å†…å­˜è®¿é—®
void sample_memory_accesses(numa_balancer_t *balancer) {
    // 1. ä½¿ç”¨ç¡¬ä»¶æ€§èƒ½è®¡æ•°å™¨é‡‡æ ·
    for (int node = 0; node < MAX_NUMA_NODES; node++) {
        balancer->samples[node].local_accesses =
            read_pmc(LOCAL_MEM_ACCESS_COUNTER, node);
        balancer->samples[node].remote_accesses =
            read_pmc(REMOTE_MEM_ACCESS_COUNTER, node);
        balancer->samples[node].total_accesses =
            balancer->samples[node].local_accesses +
            balancer->samples[node].remote_accesses;
    }
}

// é¡µè¿ç§»
void migrate_pages_to_local_node(int target_node) {
    // 1. é€‰æ‹©è¦è¿ç§»çš„é¡µ
    page_t *pages = select_pages_for_migration(target_node);

    // 2. è¿ç§»é¡µ
    for (int i = 0; i < pages->count; i++) {
        migrate_page(pages[i], target_node);
    }
}
```

**å†…å­˜ç»‘å®š**ï¼š

```bash
# å†…å­˜ç»‘å®šåˆ°èŠ‚ç‚¹0ï¼ŒCPUç»‘å®šåˆ°èŠ‚ç‚¹0
numactl --membind=0 --cpunodebind=0 ./app

# å†…å­˜ç»‘å®šå®ç°
void numa_membind(int node) {
    // 1. è®¾ç½®å†…å­˜åˆ†é…ç­–ç•¥
    set_memory_policy(node);

    // 2. è¿ç§»ç°æœ‰é¡µåˆ°ç›®æ ‡èŠ‚ç‚¹
    migrate_all_pages_to_node(node);
}
```

**æ·±åº¦è®ºè¯ï¼šå†…å­˜ç»‘å®šçš„æ€§èƒ½ä¼˜åŠ¿**

**å†…å­˜ç»‘å®šçš„å»¶è¿Ÿæ¨¡å‹**ï¼š

å†…å­˜ç»‘å®šä¿è¯**æ‰€æœ‰å†…å­˜è®¿é—®éƒ½æ˜¯æœ¬åœ°**ï¼š

$$
\text{å¹³å‡å»¶è¿Ÿ} = t_{\text{æœ¬åœ°å†…å­˜}} = 80\text{ns}
$$

è€Œæ— ç»‘å®šæ—¶ï¼Œå¹³å‡å»¶è¿Ÿä¸ºï¼š

$$
\text{å¹³å‡å»¶è¿Ÿ} = p \times t_{\text{æœ¬åœ°}} + (1-p) \times t_{\text{è¿œç¨‹}}
$$

å…¶ä¸­$p$æ˜¯æœ¬åœ°è®¿é—®ç‡ã€‚

**é‡åŒ–åˆ†æ**ï¼šä¸åŒæœ¬åœ°è®¿é—®ç‡ä¸‹çš„æ€§èƒ½

| **æœ¬åœ°è®¿é—®ç‡** | **æ— ç»‘å®šå»¶è¿Ÿ** | **æœ‰ç»‘å®šå»¶è¿Ÿ** | **æ€§èƒ½æå‡** |
|-------------|--------------|--------------|------------|
| **50%** | 115ns | 80ns | +30% |
| **80%** | 94ns | 80ns | +15% |
| **95%** | 83ns | 80ns | +4% |

**å…³é”®æ´å¯Ÿ**ï¼šå†…å­˜ç»‘å®šåœ¨**ä½æœ¬åœ°è®¿é—®ç‡**åœºæ™¯ä¸‹ä¼˜åŠ¿æ˜æ˜¾ï¼Œå¯ä»¥æ˜¾è‘—é™ä½å»¶è¿Ÿã€‚

---

## 4 å®è·µæ¡ˆä¾‹

### 4.1 é«˜æ€§èƒ½è®¡ç®—å†…å­˜ä¼˜åŒ–

**æ¡ˆä¾‹1.3.7ï¼ˆé«˜æ€§èƒ½è®¡ç®—å†…å­˜ä¼˜åŒ–ï¼‰**ï¼š

æŸé«˜æ€§èƒ½è®¡ç®—ç³»ç»Ÿä¼˜åŒ–å†…å­˜è®¿é—®ï¼Œæé«˜è®¡ç®—æ€§èƒ½ã€‚

**ä¼˜åŒ–ç­–ç•¥**ï¼š

**1. NUMAæ„ŸçŸ¥å†…å­˜åˆ†é…**ï¼š

```c
// NUMAæ„ŸçŸ¥å†…å­˜åˆ†é…
void *numa_aware_malloc(size_t size, int preferred_node) {
    // 1. åœ¨é¦–é€‰èŠ‚ç‚¹åˆ†é…å†…å­˜
    void *ptr = numa_alloc_onnode(size, preferred_node);

    if (ptr == NULL) {
        // 2. å¦‚æœå¤±è´¥ï¼Œå°è¯•å…¶ä»–èŠ‚ç‚¹
        for (int node = 0; node < numa_max_node(); node++) {
            if (node != preferred_node) {
                ptr = numa_alloc_onnode(size, node);
                if (ptr != NULL) {
                    break;
                }
            }
        }
    }

    return ptr;
}
```

**2. å¤§é¡µä¼˜åŒ–**ï¼š

```c
// ä½¿ç”¨å¤§é¡µå‡å°‘TLBæœªå‘½ä¸­
void *allocate_huge_page(size_t size) {
    // 1. å°è¯•åˆ†é…2MBå¤§é¡µ
    void *ptr = mmap(NULL, size, PROT_READ | PROT_WRITE,
                     MAP_PRIVATE | MAP_ANONYMOUS | MAP_HUGETLB,
                     -1, 0);

    if (ptr == MAP_FAILED) {
        // 2. å¦‚æœå¤±è´¥ï¼Œä½¿ç”¨æ™®é€šé¡µ
        ptr = mmap(NULL, size, PROT_READ | PROT_WRITE,
                   MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);
    }

    return ptr;
}
```

**ä¼˜åŒ–æ•ˆæœ**ï¼š

| **æŒ‡æ ‡** | **ä¼˜åŒ–å‰** | **ä¼˜åŒ–å** | **æ”¹å–„** |
|---------|-----------|-----------|---------|
| **æœ¬åœ°è®¿é—®ç‡** | 60% | 95% | +58% |
| **å¹³å‡å†…å­˜å»¶è¿Ÿ** | 120ns | 85ns | -29% |
| **è®¡ç®—æ€§èƒ½** | åŸºå‡† | +25% | æå‡ |

### 4.2 æ•°æ®åº“å†…å­˜ä¼˜åŒ–

**æ¡ˆä¾‹1.3.8ï¼ˆæ•°æ®åº“å†…å­˜ä¼˜åŒ–ï¼‰**ï¼š

æŸæ•°æ®åº“ç³»ç»Ÿä¼˜åŒ–å†…å­˜è®¿é—®æ¨¡å¼ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚

**ä¼˜åŒ–ç­–ç•¥**ï¼š

**1. è¡Œç¼“å†²ä¼˜åŒ–**ï¼š

```c
// ä¼˜åŒ–æ•°æ®å¸ƒå±€ï¼Œæé«˜è¡Œç¼“å†²å‘½ä¸­ç‡
struct optimized_row {
    int id;
    char name[32];
    int age;
    double salary;
} __attribute__((aligned(64)));  // å¯¹é½åˆ°ç¼“å­˜è¡Œ

// é¡ºåºè®¿é—®ä¼˜åŒ–
void process_rows_optimized(struct optimized_row *rows, int count) {
    // é¡ºåºè®¿é—®ï¼Œæé«˜è¡Œç¼“å†²å‘½ä¸­ç‡
    for (int i = 0; i < count; i++) {
        process_row(&rows[i]);
    }
}
```

**2. é¢„å–ä¼˜åŒ–**ï¼š

```c
// ç¡¬ä»¶é¢„å–
void prefetch_rows(struct optimized_row *rows, int count) {
    for (int i = 0; i < count; i++) {
        // é¢„å–4ä¸ªå…ƒç´ å
        __builtin_prefetch(&rows[i + 4], 0, 3);
        process_row(&rows[i]);
    }
}
```

**ä¼˜åŒ–æ•ˆæœ**ï¼š

| **æŒ‡æ ‡** | **ä¼˜åŒ–å‰** | **ä¼˜åŒ–å** | **æ”¹å–„** |
|---------|-----------|-----------|---------|
| **è¡Œç¼“å†²å‘½ä¸­ç‡** | 70% | 90% | +29% |
| **æŸ¥è¯¢å»¶è¿Ÿ** | 10ms | 7ms | -30% |
| **ååé‡** | 1000 QPS | 1400 QPS | +40% |

## 5 å†…å­˜å¢™é—®é¢˜

### 5.1 ç‰©ç†æœ¬è´¨çš„ä¸¥æ ¼è®ºè¯

**å®šç†1.6ï¼ˆå†…å­˜å¢™çš„ä¸å¯é€¾è¶Šæ€§ï¼‰**ï¼š

å¯¹äºCPUé¢‘ç‡$f_{\text{CPU}}$å’Œå†…å­˜å»¶è¿Ÿ$L_{\text{mem}}$ï¼Œå†…å­˜å¢™ç³»æ•°æ»¡è¶³ï¼š

$$
\text{å†…å­˜å¢™ç³»æ•°} = \frac{L_{\text{mem}}}{1/f_{\text{CPU}}} = L_{\text{mem}} \times f_{\text{CPU}}
$$

å¯¹äºDDR5-5600å’Œ5GHz CPUï¼š

- $L_{\text{mem}} = 80\text{ns}$
- $f_{\text{CPU}} = 5\text{GHz} = 0.2\text{ns/å‘¨æœŸ}$
- **å†…å­˜å¢™ç³»æ•° = 400å‘¨æœŸ**

**è¯æ˜**ï¼šå†…å­˜å»¶è¿Ÿç”±ç‰©ç†ç‰¹æ€§å†³å®šï¼ˆç”µå®¹å……æ”¾ç”µï¼‰ï¼Œè€ŒCPUé¢‘ç‡å—å…‰é€Ÿé™åˆ¶ã€‚ä¸¤è€…ä¹‹æ¯”å½¢æˆå†…å­˜å¢™ã€‚âˆ

**æ—¶åºçº¦æŸ**ï¼š

- DDR5-5600 tCL=48å‘¨æœŸ â‰ˆ 16.4ns
- CPU 5GHzå‘¨æœŸ = 0.2ns
- **å†…å­˜å»¶è¿Ÿ = 80å€CPUå‘¨æœŸ**

**èƒ½è€—è§„å¾‹çš„ä¸¥æ ¼åˆ†æ**ï¼š

**å®šç†1.7ï¼ˆå†…å­˜è®¿é—®èƒ½è€—çš„ä¸‹ç•Œï¼‰**ï¼š

å¯¹äºDRAMè®¿é—®ï¼Œèƒ½è€—æ»¡è¶³ï¼š

$$
E_{\text{DRAM}} = C \times V^2 \times \alpha
$$

å…¶ä¸­$C$æ˜¯è´Ÿè½½ç”µå®¹ï¼Œ$V$æ˜¯ç”µå‹ï¼Œ$\alpha$æ˜¯æ´»åŠ¨å› å­ã€‚

**èƒ½è€—å¯¹æ¯”**ï¼š

- L1ç¼“å­˜ï¼š0.5nJ/æ¬¡ï¼ˆ$C$å°ï¼Œ$V$ä½ï¼‰
- DRAMï¼š2nJ/æ¬¡ï¼ˆ$C$å¤§ï¼Œ$V$é«˜ï¼‰
- **èƒ½è€—æ¯”å·®å¼‚40å€**

**æ‰¹åˆ¤æ€§åˆ†æ**ï¼š

1. **å†…å­˜å¢™çš„ç‰©ç†æœ¬è´¨**ï¼šå†…å­˜å»¶è¿Ÿç”±**ç”µå®¹å……æ”¾ç”µæ—¶é—´å†³å®š**ï¼Œæ— æ³•é€šè¿‡è®¾è®¡å®Œå…¨æ¶ˆé™¤ã€‚

2. **ç¼“å­˜çš„é‡è¦æ€§**ï¼šå†…å­˜å¢™ä½¿å¾—**ç¼“å­˜æˆä¸ºæ€§èƒ½å…³é”®**ï¼Œè€ŒéCPUé¢‘ç‡ã€‚

3. **2025å¹´è¶‹åŠ¿**ï¼š**è¿‘å†…å­˜è®¡ç®—**ï¼ˆProcessing-in-Memoryï¼‰å°†è®¡ç®—ç§»åˆ°å†…å­˜é™„è¿‘ï¼ŒæŒ‘æˆ˜ä¼ ç»Ÿæ¶æ„ã€‚

### 5.2 OSåº”å¯¹

**æ¡ˆä¾‹1.3.9ï¼ˆOSå†…å­˜å¢™åº”å¯¹ï¼‰**ï¼š

æ“ä½œç³»ç»Ÿé€šè¿‡å¤šç§ç­–ç•¥åº”å¯¹å†…å­˜å¢™é—®é¢˜ã€‚

**OSåº”å¯¹ç­–ç•¥**ï¼š

**1. NUMA Balancing**ï¼š

- **æ¯100msé‡‡æ ·å†…å­˜è®¿é—®**ï¼šå®šæœŸé‡‡æ ·å†…å­˜è®¿é—®æ¨¡å¼
- **é¡µè¡¨è¿ç§»ä¼˜åŒ–å±€éƒ¨æ€§**ï¼šå°†é¡µè¿ç§»åˆ°è®¿é—®å®ƒçš„CPUé™„è¿‘
- **å¼€é”€**ï¼š2-3% CPU

**2. å¤§é¡µæ”¯æŒ**ï¼š

- **2MB/1GBå¤§é¡µ**ï¼šå‡å°‘TLBæœªå‘½ä¸­
- **æé«˜TLBè¦†ç›–ç‡**ï¼šä¸€ä¸ªTLBæ¡ç›®è¦†ç›–æ›´å¤§åœ°å€ç©ºé—´
- **å‡å°‘é¡µè¡¨éå†**ï¼šå‡å°‘é¡µè¡¨éå†æ¬¡æ•°

**3. é¢„å–ä¼˜åŒ–**ï¼š

- **ç¡¬ä»¶é¢„å–**ï¼šåˆ©ç”¨ç¡¬ä»¶é¢„å–å™¨
- **è½¯ä»¶é¢„å–**ï¼šä½¿ç”¨é¢„å–æŒ‡ä»¤
- **éšè—å»¶è¿Ÿ**ï¼šæå‰åŠ è½½æ•°æ®

**4. å†…å­˜å‹ç¼©**ï¼š

- **Zswap/Zram**ï¼šå‹ç¼©å†…å­˜é¡µé¢
- **æé«˜æœ‰æ•ˆå®¹é‡**ï¼šæé«˜å†…å­˜åˆ©ç”¨ç‡
- **å‡å°‘äº¤æ¢**ï¼šå‡å°‘ç£ç›˜äº¤æ¢

---

## 6 æ€ç»´å¯¼å›¾ï¼šå†…å­˜å­ç³»ç»Ÿè®¾è®¡æƒè¡¡

```mermaid
mindmap
  root((å†…å­˜å­ç³»ç»Ÿ))
    å»¶è¿Ÿä¼˜åŒ–
      æ›´å¤§ç¼“å­˜
        å‡å°‘å†…å­˜è®¿é—®
        ä½†é¢ç§¯æˆæœ¬
      é¢„å–ä¼˜åŒ–
        éšè—å»¶è¿Ÿ
        ä½†å¯èƒ½æµªè´¹å¸¦å®½
      å†…å­˜æ± åŒ–
        CXLæ‰©å±•
        ä½†å»¶è¿Ÿå¢åŠ 
    å¸¦å®½ä¼˜åŒ–
      æ›´å¤šé€šé“
        çº¿æ€§æå‡å¸¦å®½
        ä½†æˆæœ¬å¢åŠ 
      æ›´é«˜é¢‘ç‡
        DDR5-5600
        ä½†æ—¶åºçº¦æŸ
      3Då †å 
        HBM3
        ä½†æˆæœ¬é«˜
    èƒ½è€—ä¼˜åŒ–
      ä½ç”µå‹
        é™ä½åŠŸè€—
        ä½†é€Ÿåº¦ä¸‹é™
      åˆ·æ–°ä¼˜åŒ–
        æ¸©åº¦è¡¥å¿
        ä½†å¤æ‚åº¦å¢åŠ 
    æ¶æ„æƒè¡¡
      é›†æˆvsåˆ†ç¦»
        IMCé›†æˆé™ä½å»¶è¿Ÿ
        ä½†è®¾è®¡å¤æ‚
      NUMA vs UMA
        NUMAæ‰©å±•æ€§å¥½
        ä½†ç¼–ç¨‹å¤æ‚
```

---

## 7 æ‰¹åˆ¤æ€§æ€»ç»“

### 5.1 å†…å­˜å­ç³»ç»Ÿçš„æ ¹æœ¬çŸ›ç›¾

1. **å»¶è¿Ÿvså¸¦å®½**ï¼šé™ä½å»¶è¿Ÿéœ€è¦æ›´å°å®¹é‡ï¼Œä½†**æé«˜å¸¦å®½éœ€è¦æ›´å¤šé€šé“**ï¼Œä¸¤è€…çŸ›ç›¾ã€‚

2. **æˆæœ¬vsæ€§èƒ½**ï¼šé«˜æ€§èƒ½å†…å­˜ï¼ˆå¦‚HBM3ï¼‰**æˆæœ¬é«˜**ï¼Œéš¾ä»¥æ™®åŠã€‚

3. **é€šç”¨æ€§vsä¸“ç”¨æ€§**ï¼šé€šç”¨DRAMçµæ´»ï¼Œä½†**ä¸“ç”¨å†…å­˜ï¼ˆå¦‚NVMï¼‰åœ¨æŸäº›åœºæ™¯æ›´ä¼˜**ã€‚

### 5.2 2025å¹´å†…å­˜æŠ€æœ¯è¶‹åŠ¿

- **CXLå†…å­˜æ± åŒ–**ï¼šç»Ÿä¸€å†…å­˜å’ŒIOï¼Œ**æŒ‘æˆ˜ä¼ ç»Ÿå†…å­˜å±‚æ¬¡**ã€‚
- **è¿‘å†…å­˜è®¡ç®—**ï¼šProcessing-in-Memoryï¼Œ**å‡å°‘æ•°æ®ç§»åŠ¨**ã€‚
- **å¼‚æ„å†…å­˜**ï¼šDRAM + NVM + CXLçš„æ··åˆæ¶æ„ï¼Œ**éœ€è¦æ–°çš„ç®¡ç†ç­–ç•¥**ã€‚

---

## 8 è·¨é¢†åŸŸæ´å¯Ÿ

### 6.1 å†…å­˜å¢™çš„ä¸å¯é€¾è¶Šæ€§

**æ ¸å¿ƒå‘½é¢˜**ï¼šå†…å­˜å»¶è¿Ÿæ— æ³•é€šè¿‡æé«˜CPUé¢‘ç‡è§£å†³ã€‚

**é‡åŒ–åˆ†æ**ï¼š

å¯¹äºDDR5-5600å’Œ5GHz CPUï¼š

- $L_{\text{mem}} = 80\text{ns}$
- $f_{\text{CPU}} = 5\text{GHz} = 0.2\text{ns/å‘¨æœŸ}$
- **å†…å­˜å¢™ç³»æ•° = 400å‘¨æœŸ**

å³ä½¿CPUé¢‘ç‡æå‡åˆ°10GHzï¼Œå†…å­˜å¢™ç³»æ•°ä»ä¸º200å‘¨æœŸï¼Œ**æ— æ³•æ ¹æœ¬è§£å†³**ã€‚

**æ‰¹åˆ¤æ€§åˆ†æ**ï¼š

1. **"é¢‘ç‡è‡³ä¸Š"çš„ç»ˆç»“**ï¼šæé«˜CPUé¢‘ç‡æ— æ³•è§£å†³å†…å­˜å¢™ï¼Œ**ç¼“å­˜æˆä¸ºæ€§èƒ½å…³é”®**ã€‚

2. **æ‘©å°”å®šå¾‹çš„ç‰©ç†ç»ˆç»“**ï¼šæ™¶ä½“ç®¡å¾®ç¼©æ¥è¿‘ç‰©ç†æé™ï¼Œ**åŠŸè€—å¢™æˆä¸ºæ–°ç“¶é¢ˆ**ã€‚

3. **2025å¹´è¶‹åŠ¿**ï¼š**è¿‘å†…å­˜è®¡ç®—**ï¼ˆProcessing-in-Memoryï¼‰å°†è®¡ç®—ç§»åˆ°å†…å­˜é™„è¿‘ï¼ŒæŒ‘æˆ˜ä¼ ç»Ÿæ¶æ„ã€‚

### 6.2 æ•…éšœä¼ æ’­çš„çº§è”æ”¾å¤§æ•ˆåº”

```text
å•ä¸ªDRAM Cellæ•…éšœç‡: 10â»Â¹âµ/å°æ—¶
  â†“ (64msåˆ·æ–°å‘¨æœŸ)
Row Hammer â†’ é‚»è¡Œä½ç¿»è½¬: 10â»â¹/å°æ—¶
  â†“ (æ— ECCä¿æŠ¤)
æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®æŸå: 10â»â¶/å°æ—¶
  â†“ (fsckä¿®å¤)
ç³»ç»Ÿå´©æºƒé‡å¯: 10â»Â³/å°æ—¶
  â†“ (SLA 99.9%)
å¹´åœæœºæ—¶é—´: 8.7å°æ—¶

çº§è”å› å­ = 10â»Â³ / 10â»Â¹âµ = 10Â¹Â² å€!
```

**OSç¼“è§£**ï¼šEDACå­ç³»ç»Ÿç›‘æ§CEé”™è¯¯ç‡ï¼Œè¶…è¿‡é˜ˆå€¼è‡ªåŠ¨ç¦»çº¿é¡µé¢ï¼Œå°†çº§è”æ‰“æ–­åœ¨10â»â¹å±‚çº§ã€‚

**æ‰¹åˆ¤æ€§åˆ†æ**ï¼š

1. **çº§è”æ”¾å¤§ä¸å¯é¿å…**ï¼šç¡¬ä»¶æ•…éšœä¼š**çº§è”æ”¾å¤§**ï¼Œéœ€è¦å¤šå±‚é˜²æŠ¤ã€‚

2. **OSçš„é˜²æŠ¤ä½œç”¨**ï¼šOSé€šè¿‡**é”™è¯¯æ£€æµ‹å’Œæ¢å¤**ï¼Œæ‰“æ–­çº§è”æ”¾å¤§ã€‚

3. **2025å¹´è¶‹åŠ¿**ï¼š**ç¡¬ä»¶é”™è¯¯æ£€æµ‹**ï¼ˆå¦‚Intel MCAã€AMD MCEï¼‰æä¾›æ›´æ—©çš„é”™è¯¯æ£€æµ‹ã€‚

---

## 9 å¤šç»´åº¦å¯¹æ¯”

### 7.1 å†…å­˜æŠ€æœ¯å¯¹æ¯”ï¼ˆ2025å¹´ï¼‰

| **æŠ€æœ¯** | **å»¶è¿Ÿ** | **å¸¦å®½** | **å®¹é‡** | **æˆæœ¬** | **åŠŸè€—** | **åº”ç”¨åœºæ™¯** |
|---------|---------|---------|---------|---------|---------|------------|
| **SRAM** | 1ns | 2TB/s | 32MB | $100/MB | é«˜ | L1/L2ç¼“å­˜ |
| **DRAM** | 80ns | 50GB/s | 128GB | $1/GB | ä¸­ | ä¸»å†…å­˜ |
| **HBM3** | 100ns | 1TB/s | 64GB | $10/GB | é«˜ | GPUæ˜¾å­˜ |
| **Optane PMem** | 300ns | 6GB/s | 512GB | $5/GB | ä½ | æŒä¹…å†…å­˜ |
| **CXL 3.0** | 300ns | 32GB/s | æ‰©å±• | $2/GB | ä¸­ | å†…å­˜æ± åŒ– |
| **NAND SSD** | 100Î¼s | 3.5GB/s | 8TB | $0.1/GB | ä½ | å­˜å‚¨ |

**æ‰¹åˆ¤æ€§åˆ†æ**ï¼š

1. **å»¶è¿Ÿvså®¹é‡çš„æƒè¡¡**ï¼šSRAMå»¶è¿Ÿä½ä½†å®¹é‡å°ï¼ŒDRAMå®¹é‡å¤§ä½†å»¶è¿Ÿé«˜ã€‚

2. **æˆæœ¬vsæ€§èƒ½**ï¼šHBM3æ€§èƒ½å¥½ä½†æˆæœ¬é«˜ï¼ŒNANDæˆæœ¬ä½ä½†æ€§èƒ½å·®ã€‚

3. **2025å¹´è¶‹åŠ¿**ï¼š**CXLå†…å­˜æ± åŒ–**ç»Ÿä¸€å†…å­˜å’ŒIOï¼ŒæŒ‘æˆ˜ä¼ ç»Ÿå†…å­˜å±‚æ¬¡ã€‚

### 7.2 å†…å­˜æ¶æ„æ¼”è¿›å¯¹æ¯”

| **æ—¶ä»£** | **æ¶æ„** | **å»¶è¿Ÿ** | **å¸¦å®½** | **å…³é”®çªç ´** | **ä»£è¡¨äº§å“** |
|---------|---------|---------|---------|------------|------------|
| **1990s** | SDRAM | 100ns | 0.1GB/s | åŒæ­¥æ¥å£ | PC-100 |
| **2000s** | DDR | 80ns | 1.6GB/s | åŒå€æ•°æ®ç‡ | DDR-400 |
| **2010s** | DDR3/4 | 70ns | 25GB/s | æ›´é«˜é¢‘ç‡ | DDR4-3200 |
| **2020s** | DDR5 | 80ns | 50GB/s | æ›´é«˜å¸¦å®½ | DDR5-5600 |
| **2025+** | CXL/HBM | 100ns | 1TB/s | 3Då †å  | HBM3/CXL |

**æ‰¹åˆ¤æ€§åˆ†æ**ï¼š

1. **å»¶è¿Ÿçš„åœæ»**ï¼šä»DDRåˆ°DDR5ï¼Œå»¶è¿Ÿ**åŸºæœ¬ä¸å˜**ï¼Œå› ä¸ºå—ç‰©ç†é™åˆ¶ã€‚

2. **å¸¦å®½çš„æå‡**ï¼šå¸¦å®½æŒç»­æå‡ï¼Œä½†**å—é™äºé€šé“æ•°å’Œé¢‘ç‡**ã€‚

3. **2025å¹´è¶‹åŠ¿**ï¼š**3Då †å å’Œå†…å­˜æ± åŒ–**æˆä¸ºæ–°æ–¹å‘ï¼Œçªç ´ä¼ ç»Ÿé™åˆ¶ã€‚

---

## 10 ç›¸å…³ä¸»é¢˜

- [1.2 ç¼“å­˜å±‚æ¬¡ç»“æ„](./01.2_ç¼“å­˜å±‚æ¬¡ç»“æ„.md) - ç¼“å­˜ä¸å†…å­˜ååŒ
- [1.4 MMUä¸TLB](./01.4_MMUä¸TLB.md) - åœ°å€è½¬æ¢
- [3.2 å†…å­˜ç®¡ç†æ¨¡å‹](../03_OSæŠ½è±¡å±‚/03.2_å†…å­˜ç®¡ç†æ¨¡å‹.md) - OSå†…å­˜ç®¡ç†
- [7.2 å»¶è¿Ÿç©¿é€åˆ†æ](../07_æ€§èƒ½ä¼˜åŒ–ä¸å®‰å…¨/07.2_å»¶è¿Ÿç©¿é€åˆ†æ.md) - å†…å­˜å»¶è¿Ÿä¼˜åŒ–
- [8.4 æœ€æ–°æŠ€æœ¯è¶‹åŠ¿](../08_æŠ€æœ¯æ¼”è¿›ä¸å¯¹æ ‡/08.4_æœ€æ–°æŠ€æœ¯è¶‹åŠ¿.md) - CXL/Chiplet
- [ä¸»æ–‡æ¡£ï¼šå†…å­˜å¢™åˆ†æ](../schedule_formal_view.md#æ´å¯Ÿ1å†…å­˜å¢™çš„ä¸å¯é€¾è¶Šæ€§) - å®Œæ•´åˆ†æ

---

## 9 2025å¹´æœ€æ–°æŠ€æœ¯ï¼ˆå·²æ•´åˆviewæ–‡ä»¶å¤¹å†…å®¹ï¼‰

### 9.1 CXL 3.0å†…å­˜æ‰©å±•è°ƒåº¦ï¼ˆ2025å¹´æ–°å¢ï¼‰

**CXLï¼ˆCompute Express Linkï¼‰3.0**ï¼š

CXL 3.0æä¾›é«˜é€Ÿã€ä½å»¶è¿Ÿçš„å†…å­˜æ‰©å±•å’Œç¼“å­˜ä¸€è‡´æ€§åè®®ã€‚

**è°ƒåº¦ç‰¹æ€§**ï¼š

- **å†…å­˜æ± åŒ–**ï¼šå¤šä¸ªCPUå…±äº«CXLå†…å­˜æ± 
- **ç¼“å­˜ä¸€è‡´æ€§**ï¼šCXLè®¾å¤‡ä¸CPUç¼“å­˜ä¿æŒä¸€è‡´æ€§
- **ä½å»¶è¿Ÿè®¿é—®**ï¼šå»¶è¿Ÿçº¦100-200nsï¼Œæ¥è¿‘æœ¬åœ°å†…å­˜

**è°ƒåº¦ç­–ç•¥**ï¼š

$$
\text{Allocate}(memory, CXL) \iff \text{LocalMemoryFull} \land \text{CXLAvailable} \land \text{Latency}(CXL) < \text{SLA}
$$

### 9.2 NUMAæ„ŸçŸ¥è°ƒåº¦ä¼˜åŒ–ï¼ˆ2025å¹´æ–°å¢ï¼‰

**NUMAè°ƒåº¦ä¼˜åŒ–**ï¼š

æ“ä½œç³»ç»Ÿé€šè¿‡NUMAæ„ŸçŸ¥è°ƒåº¦ï¼Œå°†è¿›ç¨‹ç»‘å®šåˆ°æœ¬åœ°NUMAèŠ‚ç‚¹ï¼Œé¿å…è·¨èŠ‚ç‚¹å†…å­˜è®¿é—®çš„æ€§èƒ½æŸå¤±ã€‚

**ä¼˜åŒ–ç­–ç•¥**ï¼š

- **å†…å­˜æœ¬åœ°åŒ–**ï¼šä¼˜å…ˆåœ¨æœ¬åœ°NUMAèŠ‚ç‚¹åˆ†é…å†…å­˜
- **çº¿ç¨‹ç»‘å®š**ï¼šå°†çº¿ç¨‹ç»‘å®šåˆ°ç‰¹å®šNUMAèŠ‚ç‚¹
- **æ•°æ®åˆ†åŒº**ï¼šæ ¹æ®NUMAæ‹“æ‰‘åˆ†åŒºæ•°æ®

**æ€§èƒ½æå‡**ï¼š

- å†…å­˜è®¿é—®å»¶è¿Ÿï¼šé™ä½30-40%
- ç³»ç»Ÿååé‡ï¼šæå‡20-30%
- CPUåˆ©ç”¨ç‡ï¼šæå‡10-15%

---

**æœ€åæ›´æ–°**: 2025-01-XXï¼ˆå·²æ•´åˆviewæ–‡ä»¶å¤¹å½’çº³å†…å®¹ï¼‰
