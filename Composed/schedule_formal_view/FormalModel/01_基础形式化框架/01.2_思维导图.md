# 01.2 思维导图

> **所属主题**: 01_基础形式化框架
> **最后更新**: 2025-01-27

## 📋 目录

- [01.2 思维导图](#012-思维导图)
  - [📋 目录](#-目录)
  - [1. 三层调度系统共性模型](#1-三层调度系统共性模型)
    - [1.1 核心抽象层](#11-核心抽象层)
    - [1.2 调度算法共性](#12-调度算法共性)
    - [1.3 数据结构共性](#13-数据结构共性)
    - [1.4 通信与同步](#14-通信与同步)
  - [2. 相关文档](#2-相关文档)

---

## 1. 三层调度系统共性模型

```text
三层调度系统共性模型
├── 核心抽象层
│   ├── 资源抽象
│   │   ├── 可分资源 (CPU时间片、内存页)
│   │   ├── 不可分资源 (GPU、端口)
│   │   └── 拓扑感知 (NUMA、节点亲和性)
│   ├── 实体抽象
│   │   ├── 生命周期管理
│   │   ├── 状态机 {创建→就绪→运行→阻塞→终止}
│   │   └── 优先级/权重机制
│   └── 约束抽象
│       ├── 硬约束 (资源上限、隔离性)
│       ├── 软约束 (偏好、QoS)
│       └── 时序约束 (截止时间、依赖)
│
├── 调度算法共性
│   ├── 基础算法
│   │   ├── 时间片轮转 (RR) → 统一公平性
│   │   ├── 优先级调度 → 加权份额
│   │   └── 截止期调度 (EDF) → QoS保证
│   ├── 高级策略
│   │   ├── 两级调度：全局分配 + 本地执行
│   │   ├── 预算配额：cgroup shares ↔ EEVDF算法
│   │   └── 负载均衡：WLB问题 ↔ 装箱问题变体
│   └── 数学模型
│       ├── 排队论 M/G/1-PS 模型
│       ├── 控制理论 反馈调节
│       └── 博弈论 纳什均衡分配
│
├── 数据结构共性
│   ├── 核心结构
│   │   ├── 红黑树 (CFS调度实体、VM优先级队列)
│   │   ├── 最小堆 (任务优先级、事件定时器)
│   │   └── 位图 (CPU affinity、可用资源)
│   ├── 资源管理
│   │   ├── 伙伴系统 (内存页 → 容器存储层)
│   │   ├── slab分配器 (内核对象 → 容器元数据)
│   │   └── 事务日志 (Journaling → etcd一致性)
│   └── 索引结构
│       ├── hash表 (PID → 容器ID映射)
│       ├── Radix树 (虚拟地址 → 存储卷)
│       └── B+树 (磁盘块 → 镜像分层)
│
└── 通信与同步
    ├── 控制平面
    │   ├── 事件驱动模型 (epoll → watch API)
    │   ├── 状态广播 (procfs →  Metrics API)
    │   └── 一致性协议 (futex → Raft)
    ├── 数据平面
    │   ├── 共享内存 (进程IPC → VM virtio → 容器tmpfs)
    │   ├── 消息队列 (POSIX → RabbitMQ → NATS)
    │   └── 远程调用 (系统调用 → hypercall → gRPC)
    └── 网络模型
        ├── 命名空间隔离 (PID/net/mnt namespace)
        ├── 软件定义网络 (vlan → ovs → CNI)
        └── 服务发现 (DNS → 服务网格)
```

### 1.1 核心抽象层

**资源抽象**
- 可分资源：CPU时间片、内存页
- 不可分资源：GPU、端口
- 拓扑感知：NUMA、节点亲和性

**实体抽象**
- 生命周期管理
- 状态机：创建→就绪→运行→阻塞→终止
- 优先级/权重机制

**约束抽象**
- 硬约束：资源上限、隔离性
- 软约束：偏好、QoS
- 时序约束：截止时间、依赖

### 1.2 调度算法共性

**基础算法**
- 时间片轮转 (RR) → 统一公平性
- 优先级调度 → 加权份额
- 截止期调度 (EDF) → QoS保证

**高级策略**
- 两级调度：全局分配 + 本地执行
- 预算配额：cgroup shares ↔ EEVDF算法
- 负载均衡：WLB问题 ↔ 装箱问题变体

**数学模型**
- 排队论 M/G/1-PS 模型
- 控制理论 反馈调节
- 博弈论 纳什均衡分配

### 1.3 数据结构共性

**核心结构**
- 红黑树 (CFS调度实体、VM优先级队列)
- 最小堆 (任务优先级、事件定时器)
- 位图 (CPU affinity、可用资源)

**资源管理**
- 伙伴系统 (内存页 → 容器存储层)
- slab分配器 (内核对象 → 容器元数据)
- 事务日志 (Journaling → etcd一致性)

**索引结构**
- hash表 (PID → 容器ID映射)
- Radix树 (虚拟地址 → 存储卷)
- B+树 (磁盘块 → 镜像分层)

### 1.4 通信与同步

**控制平面**
- 事件驱动模型 (epoll → watch API)
- 状态广播 (procfs → Metrics API)
- 一致性协议 (futex → Raft)

**数据平面**
- 共享内存 (进程IPC → VM virtio → 容器tmpfs)
- 消息队列 (POSIX → RabbitMQ → NATS)
- 远程调用 (系统调用 → hypercall → gRPC)

**网络模型**
- 命名空间隔离 (PID/net/mnt namespace)
- 软件定义网络 (vlan → ovs → CNI)
- 服务发现 (DNS → 服务网格)

---

## 2. 相关文档

- [返回 FormalModel 目录](../README.md)
- [01_基础形式化框架 README](README.md)
- [01.1_资源抽象模型](01.1_资源抽象模型.md)
- [04_动态交互模型](../04_动态交互模型/README.md)

---

**最后更新**: 2025-01-27

