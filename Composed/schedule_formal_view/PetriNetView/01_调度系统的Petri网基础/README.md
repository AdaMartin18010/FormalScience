# 01 调度系统的Petri网基础

> **子主题编号**: 01
> **视角**: Petri网视角
> **最后更新**: 2025-12-02
> **文档状态**: ✅ 完成

---

## 📋 目录

- [01 调度系统的Petri网基础](#01-调度系统的petri网基础)
  - [📋 目录](#-目录)
  - [1 概述](#1-概述)
    - [1.1 核心洞察](#11-核心洞察)
    - [1.2 基本映射](#12-基本映射)
  - [2 调度系统的Petri网表示](#2-调度系统的petri网表示)
    - [2.1 任务表示](#21-任务表示)
    - [2.2 资源表示](#22-资源表示)
    - [2.3 状态表示](#23-状态表示)
  - [3 基本映射关系](#3-基本映射关系)
    - [3.1 任务-变迁映射](#31-任务-变迁映射)
    - [3.2 资源-库所映射](#32-资源-库所映射)
    - [3.3 依赖-弧映射](#33-依赖-弧映射)
  - [4 基本调度模式的Petri网建模](#4-基本调度模式的petri网建模)
    - [4.1 顺序调度](#41-顺序调度)
    - [4.2 并行调度](#42-并行调度)
    - [4.3 选择调度](#43-选择调度)
    - [4.4 循环调度](#44-循环调度)
  - [5 Petri网性质与调度性质对应](#5-petri网性质与调度性质对应)
    - [5.1 可达性与调度可行性](#51-可达性与调度可行性)
    - [5.2 活性与无死锁](#52-活性与无死锁)
    - [5.3 有界性与资源有限性](#53-有界性与资源有限性)
  - [6 关系属性与依赖分析](#6-关系属性与依赖分析)
    - [6.1 映射保持性质](#61-映射保持性质)
    - [6.2 调度模式之间的关系](#62-调度模式之间的关系)
    - [6.3 映射的唯一性与完备性](#63-映射的唯一性与完备性)
  - [7 跨视角链接](#7-跨视角链接)
    - [7.1 Petri网视角关联](#71-petri网视角关联)
    - [7.2 调度视角关联](#72-调度视角关联)
    - [7.3 形式化视角关联](#73-形式化视角关联)

---

## 1 概述

### 1.1 核心洞察

**Petri网视角的独特之处**在于将调度系统视为**离散事件系统**，通过库所、变迁、标记的自然映射，提供了一种直观且形式化的调度系统建模方法。

### 1.2 基本映射

**调度系统 → Petri网**：

```text
调度系统概念          Petri网概念
─────────────────────────────────
任务（Task）          → 变迁（Transition）
资源（Resource）      → 库所（Place）
资源状态（State）     → 标记（Marking）
任务执行（Execution）  → 变迁点火（Firing）
任务依赖（Dependency）→ 弧连接（Arc）
调度决策（Decision）  → 变迁选择（Selection）
```

---

## 2 调度系统的Petri网表示

### 2.1 任务表示

**任务 → 变迁**：

```text
任务t映射到变迁t'：

输入库所：•t' = {p_resource | resource ∈ required(t)}
输出库所：t'• = {p_resource | resource ∈ released(t)}

权重：
  W(p_resource, t') = amount_required(t, resource)
  W(t', p_resource) = amount_released(t, resource)
```

**独特视角**：

- 任务不是被动的对象，而是**主动的转换操作**
- 任务的执行就是**变迁的点火**
- 任务的依赖关系通过**库所连接**自然表示

### 2.2 资源表示

**资源 → 库所**：

```text
资源r映射到库所p_r：

标记数：M(p_r) = available_amount(r)

资源分配：
  M(p_r)减少 → 资源被分配
  M(p_r)增加 → 资源被释放
```

**独特视角**：

- 资源不是抽象概念，而是**具体的标记数量**
- 资源状态变化就是**标记的流动**
- 资源竞争就是**多个变迁竞争同一标记**

### 2.3 状态表示

**系统状态 → 标记**：

```text
系统状态S映射到标记M：

M = {M(p_r) | r ∈ Resources} ∪ {M(p_t) | t ∈ Tasks}

其中：
  M(p_r)：资源r的可用数量
  M(p_t)：任务t的状态（待执行、执行中、已完成）
```

**独特视角**：

- 系统状态是**所有资源状态的组合**
- 状态转换就是**标记的重新分布**
- 状态空间就是**所有可达标记的集合**

---

## 3 基本映射关系

### 3.1 任务-变迁映射

**定义 3.1**（任务-变迁映射）：

```text
任务T = (id, required_resources, released_resources, duration)

映射到变迁t：

  •t = {p_r | r ∈ required_resources}
  t• = {p_r | r ∈ released_resources}

  W(p_r, t) = required_amount(T, r)
  W(t, p_r) = released_amount(T, r)
```

**独特见解**：

- 任务的**资源需求**直接对应变迁的**输入库所**
- 任务的**资源释放**直接对应变迁的**输出库所**
- 任务的**执行时间**可以映射到**时间Petri网**的时间约束

### 3.2 资源-库所映射

**定义 3.2**（资源-库所映射）：

```text
资源R = (id, capacity, current_available)

映射到库所p：

  M₀(p) = current_available
  capacity(p) = capacity

  资源分配：M(p)减少
  资源释放：M(p)增加
```

**独特见解**：

- 资源的**容量**对应库所的**有界性**
- 资源的**可用性**对应标记的**存在性**
- 资源的**类型**可以映射到**着色Petri网**的颜色

### 3.3 依赖-弧映射

**定义 3.3**（依赖-弧映射）：

```text
任务依赖T₁ → T₂映射到Petri网路径：

  t₁• ∩ •t₂ ≠ ∅

即：任务T₁的输出资源是任务T₂的输入资源
```

**独特见解**：

- **数据依赖** = 数据资源库所连接
- **控制依赖** = 控制状态库所连接
- **资源依赖** = 资源库所连接

---

## 4 基本调度模式的Petri网建模

### 4.1 顺序调度

**模式**：任务按顺序执行

**Petri网表示**：

```text
t₁ →[p₁]→ t₂ →[p₂]→ t₃ → ...

结构：
  t₁• = {p₁}
  •t₂ = {p₁}
  t₂• = {p₂}
  •t₃ = {p₂}
```

**独特视角**：

- 顺序调度就是**线性Petri网**
- 每个任务等待前一个任务的**完成信号**（标记）

### 4.2 并行调度

**模式**：多个任务同时执行

**Petri网表示**：

```text
p_start →[t₁]→ p₁
p_start →[t₂]→ p₂
p_start →[t₃]→ p₃

结构：
  •t₁ = •t₂ = •t₃ = {p_start}
```

**独特视角**：

- 并行调度就是**并发变迁**
- 并发度 = 可同时点火的变迁数量
- 无需显式枚举所有并发状态组合

### 4.3 选择调度

**模式**：根据条件选择执行路径

**Petri网表示**：

```text
p_condition →[t₁]→ p_path1
p_condition →[t₂]→ p_path2

结构：
  •t₁ = •t₂ = {p_condition}

冲突：M(p_condition) < W(p_condition, t₁) + W(p_condition, t₂)
```

**独特视角**：

- 选择调度就是**冲突结构**
- 调度决策就是**冲突解决**
- 可以通过**守卫函数**（着色Petri网）表示条件

### 4.4 循环调度

**模式**：任务循环执行

**Petri网表示**：

```text
p_loop →[t]→ p_after →[t_continue]→ p_loop

结构：
  t• = {p_after}
  t_continue• = {p_loop}
  •t = {p_loop}
```

**独特视角**：

- 循环调度就是**循环结构**
- 循环条件通过**守卫函数**或**标记条件**表示

---

## 5 Petri网性质与调度性质对应

### 5.1 可达性与调度可行性

**对应关系**：

```text
调度可行性 ⟺ Petri网可达性

任务序列可行 ⟺ 存在从初始标记到目标标记的路径
```

**定理 5.1**（调度可行性）：

```text
调度问题有解，当且仅当对应的Petri网中：
  存在从M₀到M_target的可达路径
```

### 5.2 活性与无死锁

**对应关系**：

```text
调度系统无死锁 ⟺ Petri网是活的

所有任务最终都能执行 ⟺ 所有变迁最终都能点火
```

**定理 5.2**（无死锁性）：

```text
调度系统无死锁，当且仅当对应的Petri网是活的
```

### 5.3 有界性与资源有限性

**对应关系**：

```text
资源有限 ⟺ Petri网有界

资源不会无限累积 ⟺ 库所标记数有界
```

**定理 5.3**（资源有限性）：

```text
调度系统资源有限，当且仅当对应的Petri网是有界的
```

---

## 6 关系属性与依赖分析

### 6.1 映射保持性质

**定理 6.1**（映射保持性质）：

```text
调度系统 → Petri网映射F保持以下性质：

1. 执行语义：调度执行 ⟺ 变迁序列
2. 状态对应：系统状态 ⟺ 标记
3. 性质对应：调度性质 ⟺ Petri网性质
```

**证明思路**：

```text
1. 执行语义保持：
   - 调度执行步骤对应变迁点火步骤
   - 任务序列对应变迁序列
   - 执行顺序对应点火顺序

2. 状态对应保持：
   - 系统状态对应标记
   - 状态转换对应标记转换
   - 状态空间对应可达标记集合

3. 性质对应保持：
   - 调度可行性 ⟺ 可达性
   - 无死锁 ⟺ 活性
   - 资源有限 ⟺ 有界性
```

### 6.2 调度模式之间的关系

**模式组合**：

```text
复杂调度模式 = 基本模式的组合

例如：
  并行-顺序 = 并行模式 + 顺序模式
  选择-循环 = 选择模式 + 循环模式
```

**模式层次结构**：

```text
调度模式层次：
├── 基本模式（原子模式）
│   ├── 顺序模式
│   ├── 并行模式
│   ├── 选择模式
│   └── 循环模式
├── 组合模式（模式组合）
│   ├── 并行-顺序
│   ├── 选择-循环
│   └── 嵌套模式
└── 复杂模式（多模式组合）
    ├── 工作流模式
    └── 业务流程模式
```

### 6.3 映射的唯一性与完备性

**定理 6.2**（映射唯一性）：

```text
对于给定的调度系统，Petri网表示是唯一的（在同构意义下）。

证明：
  映射F是单射的（不同的调度系统映射到不同的Petri网）
  映射F是满射的（每个Petri网都对应某个调度系统）
  因此F是双射的
```

**定理 6.3**（映射完备性）：

```text
Petri网可以表示所有离散事件调度系统。

证明：
  由于Petri网与图灵机等效，可以表示任何可计算的系统
  调度系统是可计算的，因此可以用Petri网表示
```

---

## 7 跨视角链接

### 7.1 Petri网视角关联

- [Petri网视角主索引](../README.md) - 主索引
- [并发调度的Petri网建模](../02_并发调度的Petri网建模/README.md) - 并发建模

### 7.2 调度视角关联

- [调度模型](../06_调度模型/) - 调度模型
- [工作流调度](../30_工作流调度/) - 工作流应用

### 7.3 形式化视角关联

- [FormalModel](../FormalModel/) - 形式化模型
- [Petri网理论](../../formal_lang_view/10_Petri网理论/) - 理论基础

---

**返回**: [Petri网视角主索引](../README.md) | [调度视角主索引](../../README.md)
