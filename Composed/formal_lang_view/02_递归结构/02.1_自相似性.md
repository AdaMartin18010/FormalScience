# 2.1 è‡ªç›¸ä¼¼æ€§ï¼ˆFractal Architectureï¼‰

> **å­ä¸»é¢˜ç¼–å·**: 02.1
> **ä¸»é¢˜**: é€’å½’ç»“æ„
> **æœ€åæ›´æ–°**: 2025-01-XX

---

## ğŸ“‹ ç›®å½•

- [2.1 è‡ªç›¸ä¼¼æ€§ï¼ˆFractal Architectureï¼‰](#21-è‡ªç›¸ä¼¼æ€§fractal-architecture)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1 æ¦‚è¿°](#1-æ¦‚è¿°)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•-1)
  - [2 æ ¸å¿ƒæ¦‚å¿µ](#2-æ ¸å¿ƒæ¦‚å¿µ)
    - [2.1 åˆ†å½¢æ¶æ„](#21-åˆ†å½¢æ¶æ„)
    - [2.2 è‡ªç›¸ä¼¼æ€§å±‚æ¬¡](#22-è‡ªç›¸ä¼¼æ€§å±‚æ¬¡)
  - [3 å±‚æ¬¡å¯¹åº”è¡¨](#3-å±‚æ¬¡å¯¹åº”è¡¨)
  - [4 æŠ€æœ¯ç»†èŠ‚](#4-æŠ€æœ¯ç»†èŠ‚)
    - [4.1 èµ„æºæŠ½è±¡Monad](#41-èµ„æºæŠ½è±¡monad)
    - [4.2 åŒæ„æ˜ å°„](#42-åŒæ„æ˜ å°„)
  - [5 å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 Docker in Docker](#51-docker-in-docker)
    - [5.2 Kubernetes in Kubernetes](#52-kubernetes-in-kubernetes)
    - [5.3 WASM in Container](#53-wasm-in-container)
  - [6 ç›¸å…³æ¦‚å¿µ](#6-ç›¸å…³æ¦‚å¿µ)
  - [7 å»¶ä¼¸é˜…è¯»](#7-å»¶ä¼¸é˜…è¯»)

---

## 1 æ¦‚è¿°

åŸºç¡€è®¾æ–½å…·æœ‰**åˆ†å½¢ç‰¹æ€§**ï¼Œæ¯ä¸€å±‚éƒ½æ˜¯**åŒæ„çš„"èµ„æºæŠ½è±¡ Monad"**ï¼Œä»ç‰©ç†æœºåˆ°WASMæ²™ç›’ï¼Œæ¯ä¸€å±‚éƒ½éµå¾ªç›¸åŒçš„æŠ½è±¡æ¨¡å¼ã€‚

---

## ğŸ“‘ ç›®å½•

- [2.1 è‡ªç›¸ä¼¼æ€§ï¼ˆFractal Architectureï¼‰](#21-è‡ªç›¸ä¼¼æ€§fractal-architecture)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1 æ¦‚è¿°](#1-æ¦‚è¿°)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•-1)
  - [2 æ ¸å¿ƒæ¦‚å¿µ](#2-æ ¸å¿ƒæ¦‚å¿µ)
    - [2.1 åˆ†å½¢æ¶æ„](#21-åˆ†å½¢æ¶æ„)
    - [2.2 è‡ªç›¸ä¼¼æ€§å±‚æ¬¡](#22-è‡ªç›¸ä¼¼æ€§å±‚æ¬¡)
  - [3 å±‚æ¬¡å¯¹åº”è¡¨](#3-å±‚æ¬¡å¯¹åº”è¡¨)
  - [4 æŠ€æœ¯ç»†èŠ‚](#4-æŠ€æœ¯ç»†èŠ‚)
    - [4.1 èµ„æºæŠ½è±¡Monad](#41-èµ„æºæŠ½è±¡monad)
    - [4.2 åŒæ„æ˜ å°„](#42-åŒæ„æ˜ å°„)
  - [5 å®é™…åº”ç”¨](#5-å®é™…åº”ç”¨)
    - [5.1 Docker in Docker](#51-docker-in-docker)
    - [5.2 Kubernetes in Kubernetes](#52-kubernetes-in-kubernetes)
    - [5.3 WASM in Container](#53-wasm-in-container)
  - [6 ç›¸å…³æ¦‚å¿µ](#6-ç›¸å…³æ¦‚å¿µ)
  - [7 å»¶ä¼¸é˜…è¯»](#7-å»¶ä¼¸é˜…è¯»)

---

## 2 æ ¸å¿ƒæ¦‚å¿µ

### 2.1 åˆ†å½¢æ¶æ„

æ¯ä¸€å±‚éƒ½æ˜¯**åŒæ„çš„"èµ„æºæŠ½è±¡ Monad"**ï¼š`Resource<T> â†’ Resource<Resource<T>>`

### 2.2 è‡ªç›¸ä¼¼æ€§å±‚æ¬¡

```text
ç‰©ç†æœº (Type-0)
â””â”€â”€ è™šæ‹Ÿæœºç›‘æ§å™¨ (Type-1 Hypervisor)
    â””â”€â”€ è™šæ‹Ÿæœº (Type-2)
        â””â”€â”€ å®¹å™¨è¿è¡Œæ—¶ (Containerd)
            â””â”€â”€ Pod (Containerçš„å®¹å™¨)
                â””â”€â”€åº”ç”¨è¿›ç¨‹ (gRPCæœåŠ¡å™¨)
                    â””â”€â”€ WASMæ²™ç›’ (å‡½æ•°çº§å®¹å™¨)
                        â””â”€â”€ ...
```

---

## 3 å±‚æ¬¡å¯¹åº”è¡¨

| å±‚æ¬¡ | æŠ½è±¡ç±»å‹ | å®ç°æŠ€æœ¯ | éš”ç¦»æœºåˆ¶ |
|------|---------|---------|---------|
| L0 | ç‰©ç†æœº | ç¡¬ä»¶ | ç‰©ç†éš”ç¦» |
| L1 | Hypervisor | KVM/ESXi | ç¡¬ä»¶è™šæ‹ŸåŒ– |
| L2 | è™šæ‹Ÿæœº | VM | å®Œæ•´OSéš”ç¦» |
| L3 | å®¹å™¨è¿è¡Œæ—¶ | containerd/runc | Namespace/Cgroups |
| L4 | Pod | Kubernetes | ç½‘ç»œå‘½åç©ºé—´å…±äº« |
| L5 | åº”ç”¨è¿›ç¨‹ | è¿›ç¨‹ | è¿›ç¨‹éš”ç¦» |
| L6 | WASMæ²™ç›’ | WasmEdge | å‡½æ•°çº§éš”ç¦» |

---

## 4 æŠ€æœ¯ç»†èŠ‚

### 4.1 èµ„æºæŠ½è±¡Monad

```haskell
-- ç±»å‹ç³»ç»Ÿè§†è§’
data Resource a = Resource {
    isolate :: IsolationLevel,
    content :: a
}

-- Monadå®ä¾‹
instance Monad Resource where
    return x = Resource NoIsolation x
    (Resource i x) >>= f = Resource (combine i (isolationOf (f x))) (f x)
```

### 4.2 åŒæ„æ˜ å°„

```text
Resource<T> â†’ Resource<Resource<T>> â†’ Resource<Resource<Resource<T>>> â†’ ...
```

æ¯ä¸€å±‚éƒ½æ˜¯å‰ä¸€å±‚èµ„æºçš„å®¹å™¨åŒ–ã€‚

---

## 5 å®é™…åº”ç”¨

### 5.1 Docker in Docker

```text
Host Container
â””â”€â”€ Docker Engine
    â””â”€â”€ Container (åµŒå¥—å®¹å™¨)
```

### 5.2 Kubernetes in Kubernetes

```text
Host Cluster
â””â”€â”€ vCluster
    â””â”€â”€ Virtual Cluster (åµŒå¥—é›†ç¾¤)
```

### 5.3 WASM in Container

```text
Container
â””â”€â”€ WASM Runtime
    â””â”€â”€ WASM Module (å‡½æ•°çº§å®¹å™¨)
```

---

## 6 ç›¸å…³æ¦‚å¿µ

- [2.2 ç±»å‹é€’å½’çš„å…·ä½“ä½“ç°](./02.2_ç±»å‹é€’å½’çš„å…·ä½“ä½“ç°.md)
- [2.3 ä¸åŠ¨ç‚¹ï¼ˆFixed Pointï¼‰](./02.3_ä¸åŠ¨ç‚¹.md)
- [01.3 ç±»å‹å±‚çº§ä¸ç»§æ‰¿](../01_æ ¸å¿ƒæ¦‚å¿µæ˜ å°„/01.3_ç±»å‹å±‚çº§ä¸ç»§æ‰¿.md)

---

## 7 å»¶ä¼¸é˜…è¯»

- Fractal Architecture
- Monad in Functional Programming
- Nested Virtualization

---

**è¿”å›**: [02. é€’å½’ç»“æ„](./README.md) | [ä¸»é¢˜ç´¢å¼•](../README.md)
