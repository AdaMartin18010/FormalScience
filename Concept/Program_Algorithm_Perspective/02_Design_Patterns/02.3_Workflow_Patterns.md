# å·¥ä½œæµæ¨¡å¼ï¼ˆWorkflow Patternsï¼‰

## ğŸ“š ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [1. Petri ç½‘åŸºç¡€](#1-petri-ç½‘åŸºç¡€)
  - [1.1 å½¢å¼å®šä¹‰](#11-å½¢å¼å®šä¹‰)
  - [1.2 åŸºæœ¬æ€§è´¨](#12-åŸºæœ¬æ€§è´¨)
- [2. æ§åˆ¶æµæ¨¡å¼ï¼ˆåŸºç¡€ 5 ç§ï¼‰](#2-æ§åˆ¶æµæ¨¡å¼åŸºç¡€-5-ç§)
  - [2.1 Sequenceï¼ˆé¡ºåºï¼‰](#21-sequenceé¡ºåº)
  - [2.2 Parallel Splitï¼ˆå¹¶è¡Œåˆ†æ”¯ï¼‰](#22-parallel-splitå¹¶è¡Œåˆ†æ”¯)
  - [2.3 Synchronizationï¼ˆåŒæ­¥ï¼‰](#23-synchronizationåŒæ­¥)
  - [2.4 Exclusive Choiceï¼ˆäº’æ–¥é€‰æ‹© / XOR-Splitï¼‰](#24-exclusive-choiceäº’æ–¥é€‰æ‹©--xor-split)
  - [2.5 Simple Mergeï¼ˆç®€å•åˆå¹¶ / XOR-Joinï¼‰](#25-simple-mergeç®€å•åˆå¹¶--xor-join)
- [3. é«˜çº§æ§åˆ¶æµæ¨¡å¼ï¼ˆ15 ç§èŠ‚é€‰ï¼‰](#3-é«˜çº§æ§åˆ¶æµæ¨¡å¼15-ç§èŠ‚é€‰)
  - [3.1 Multi-Choiceï¼ˆå¤šé€‰ / OR-Splitï¼‰](#31-multi-choiceå¤šé€‰--or-split)
  - [3.2 Structured Synchronizing Mergeï¼ˆç»“æ„åŒ–åŒæ­¥åˆå¹¶ï¼‰](#32-structured-synchronizing-mergeç»“æ„åŒ–åŒæ­¥åˆå¹¶)
  - [3.3 Multiple Instances without Synchronization](#33-multiple-instances-without-synchronization)
  - [3.4 Deferred Choiceï¼ˆå»¶è¿Ÿé€‰æ‹©ï¼‰](#34-deferred-choiceå»¶è¿Ÿé€‰æ‹©)
  - [3.5 Cancel Activityï¼ˆå–æ¶ˆæ´»åŠ¨ï¼‰](#35-cancel-activityå–æ¶ˆæ´»åŠ¨)
- [4. å®Œæ•´ç¤ºä¾‹ï¼šé‡‡è´­æµç¨‹](#4-å®Œæ•´ç¤ºä¾‹é‡‡è´­æµç¨‹)
  - [4.1 æµç¨‹æè¿°](#41-æµç¨‹æè¿°)
  - [4.2 Petri ç½‘å»ºæ¨¡](#42-petri-ç½‘å»ºæ¨¡)
  - [4.3 éªŒè¯](#43-éªŒè¯)
- [5. æ•°æ®æ¨¡å¼ï¼ˆèŠ‚é€‰ 5 ç§ï¼‰](#5-æ•°æ®æ¨¡å¼èŠ‚é€‰-5-ç§)
  - [5.1 Task Dataï¼ˆä»»åŠ¡æ•°æ®ï¼‰](#51-task-dataä»»åŠ¡æ•°æ®)
  - [5.2 Block Dataï¼ˆå—æ•°æ®ï¼‰](#52-block-dataå—æ•°æ®)
  - [5.3 Case Dataï¼ˆæ¡ˆä¾‹æ•°æ®ï¼‰](#53-case-dataæ¡ˆä¾‹æ•°æ®)
  - [5.4 Task to Taskï¼ˆä»»åŠ¡é—´ä¼ é€’ï¼‰](#54-task-to-taskä»»åŠ¡é—´ä¼ é€’)
  - [5.5 Environment to Taskï¼ˆç¯å¢ƒè¾“å…¥ï¼‰](#55-environment-to-taskç¯å¢ƒè¾“å…¥)
- [6. èµ„æºæ¨¡å¼ï¼ˆèŠ‚é€‰ 5 ç§ï¼‰](#6-èµ„æºæ¨¡å¼èŠ‚é€‰-5-ç§)
- [7. éªŒè¯å·¥å…·é“¾](#7-éªŒè¯å·¥å…·é“¾)
- [8. ä¸ BPMN å¯¹æ¯”](#8-ä¸-bpmn-å¯¹æ¯”)
- [9. å¤§å­¦è¯¾ç¨‹å¯¹åº”](#9-å¤§å­¦è¯¾ç¨‹å¯¹åº”)
- [10. æ•™æå¯¹åº”](#10-æ•™æå¯¹åº”)
- [11. æœ¬åœ°é¡¹ç›®å¼•ç”¨](#11-æœ¬åœ°é¡¹ç›®å¼•ç”¨)

---

## æ¦‚è¿°

**å·¥ä½œæµæ¨¡å¼**æ˜¯ä¸šåŠ¡æµç¨‹ç®¡ç†ï¼ˆBPMï¼‰ä¸­å¸¸è§çš„æ§åˆ¶æµã€æ•°æ®æµå’Œèµ„æºåˆ†é…æ¨¡å¼ã€‚**Workflow Management Coalition (WfMC)** å®šä¹‰äº† **43 ä¸ªå·¥ä½œæµæ¨¡å¼**ï¼Œæ¶µç›–ï¼š

1. **æ§åˆ¶æµæ¨¡å¼**ï¼ˆ20 ç§ï¼‰ï¼šä»»åŠ¡æ‰§è¡Œé¡ºåº
2. **æ•°æ®æ¨¡å¼**ï¼ˆ40 ç§ï¼‰ï¼šæ•°æ®åœ¨ä»»åŠ¡é—´ä¼ é€’
3. **èµ„æºæ¨¡å¼**ï¼ˆ43 ç§ï¼‰ï¼šäººå‘˜/è®¾å¤‡åˆ†é…

æœ¬æ–‡èšç„¦**æ§åˆ¶æµæ¨¡å¼**ï¼Œç”¨ **Petri ç½‘**å½¢å¼åŒ–ï¼Œå¹¶é€šè¿‡ **æ¨¡å‹æ£€æµ‹**éªŒè¯æ€§è´¨ï¼ˆæ­»é”è‡ªç”±ã€æœ‰ç•Œæ€§ã€æ´»æ€§ï¼‰ã€‚

**æ ¸å¿ƒæ´å¯Ÿ**ï¼š

```text
å·¥ä½œæµæ¨¡å¼ = å¯ç‚¹ç‡ƒçš„ Petri ç½‘

éªŒè¯ = çŠ¶æ€ç©ºé—´æ¢ç´¢ + CTL æ€§è´¨æ£€æŸ¥
```

---

## 1. Petri ç½‘åŸºç¡€

### 1.1 å½¢å¼å®šä¹‰

```text
Petri ç½‘ N = âŸ¨P, T, F, W, Mâ‚€âŸ©

å…¶ä¸­ï¼š
  P   : åº“æ‰€é›†åˆï¼ˆPlaceï¼Œåœ†åœˆï¼‰
  T   : å˜è¿é›†åˆï¼ˆTransitionï¼Œæ–¹æ¡†ï¼‰
  F   : æµå…³ç³» F âŠ† (PÃ—T) âˆª (TÃ—P)
  W   : å¼§æƒé‡ W: F â†’ â„•âº
  Mâ‚€  : åˆå§‹æ ‡è¯†ï¼ˆMarkingï¼‰Mâ‚€: P â†’ â„•
```

**ç‚¹ç«è§„åˆ™**ï¼š

```text
å˜è¿ t ä½¿èƒ½ï¼ˆenabledï¼‰âŸº âˆ€p âˆˆ â€¢t, M(p) â‰¥ W(p,t)

ç‚¹ç«åï¼š
  M'(p) = M(p) - W(p,t) + W(t,p)
```

### 1.2 åŸºæœ¬æ€§è´¨

| æ€§è´¨ | CTL å…¬å¼ | è¯´æ˜ |
|------|----------|------|
| **æ­»é”è‡ªç”±** | `AG EX true` | ä»»ä½•çŠ¶æ€éƒ½æœ‰åç»§ |
| **æœ‰ç•Œæ€§** | `AG (âˆ€p. M(p) â‰¤ k)` | æ‰˜è‚¯æ•°ä¸è¶…è¿‡ k |
| **æ´»æ€§** | `AG EF M(p_final)` | æ€»èƒ½åˆ°è¾¾æœ€ç»ˆçŠ¶æ€ |
| **å¯é€†æ€§** | `AG EF Mâ‚€` | æ€»èƒ½å›åˆ°åˆå§‹çŠ¶æ€ |

---

## 2. æ§åˆ¶æµæ¨¡å¼ï¼ˆåŸºç¡€ 5 ç§ï¼‰

### 2.1 Sequenceï¼ˆé¡ºåºï¼‰

**å®šä¹‰**ï¼šä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œå‰ä¸€ä¸ªå®Œæˆåæ‰èƒ½å¼€å§‹ä¸‹ä¸€ä¸ªã€‚

**Petri ç½‘**ï¼š

```text
Place:  start â†’ A â†’ B â†’ end
Marking: [1, 0, 0, 0]

Transitions:
  tâ‚: start â†’ A
  tâ‚‚: A â†’ B
  tâ‚ƒ: B â†’ end
```

**å½¢å¼åŒ–å®šä¹‰**ï¼ˆTina æ ¼å¼ï¼‰ï¼š

```text
# Sequence.net
pl start, A, B, end
tr t1 : start -> A
tr t2 : A -> B
tr t3 : B -> end
m0 start:1
```

**éªŒè¯**ï¼š

```bash
tina -ctl Sequence.net -f "AG !deadlock"
# è¾“å‡ºï¼šTRUE
```

**æ€§è´¨**ï¼š

```text
å®šç†ï¼ˆçº¿æ€§æ—¶é—´ï¼‰ï¼š
  æ‰§è¡Œæ—¶é—´ T = T_A + T_B
  
å®šç†ï¼ˆç¡®å®šæ€§ï¼‰ï¼š
  åªæœ‰ä¸€æ¡æ‰§è¡Œè·¯å¾„
```

---

### 2.2 Parallel Splitï¼ˆå¹¶è¡Œåˆ†æ”¯ï¼‰

**å®šä¹‰**ï¼šä¸€ä¸ªä»»åŠ¡å®Œæˆåï¼Œå¤šä¸ªä»»åŠ¡**åŒæ—¶å¯åŠ¨**ã€‚

**Petri ç½‘**ï¼š

```text
Place:  start â†’ split â†’ A
                      â†˜ B

Transition:
  t_split: start â†’ A âˆ§ B  (ä¸€æ¬¡ç‚¹ç«äº§ç”Ÿ 2 ä¸ªæ‰˜è‚¯)
```

**å½¢å¼åŒ–å®šä¹‰**ï¼š

```text
# Parallel_Split.net
pl start, A, B
tr t_split : start -> {A, B}  # å¤šè¾“å‡ºå¼§
m0 start:1
```

**mCRL2 å½¢å¼åŒ–**ï¼š

```mcrl2
proc Split = start . (A | B);  % | è¡¨ç¤ºå¹¶è¡Œç»„åˆ

init Split;
```

**éªŒè¯**ï¼š

```bash
mcrl22lps parallel_split.mcrl2 | lps2lts -v
# è¾“å‡ºï¼š2 ä¸ªå¹¶å‘çŠ¶æ€
```

**æ€§è´¨**ï¼š

```text
å®šç†ï¼ˆå¹¶è¡Œåº¦ï¼‰ï¼š
  Span = max(T_A, T_B)
  Work = T_A + T_B
  
å®šç†ï¼ˆå¹¶å‘çŠ¶æ€æ•°ï¼‰ï¼š
  |Reach| = 2^n  ï¼ˆn ä¸ºå¹¶è¡Œä»»åŠ¡æ•°ï¼‰
```

---

### 2.3 Synchronizationï¼ˆåŒæ­¥ï¼‰

**å®šä¹‰**ï¼šå¤šä¸ªä»»åŠ¡å¿…é¡»**å…¨éƒ¨å®Œæˆ**åï¼Œæ‰èƒ½å¯åŠ¨ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚

**Petri ç½‘**ï¼š

```text
Place:  A â†’ sync
        B â†’ sync â†’ C

Transition:
  t_sync: {A, B} â†’ C  (éœ€è¦ 2 ä¸ªæ‰˜è‚¯æ‰èƒ½ç‚¹ç«)
```

**å½¢å¼åŒ–å®šä¹‰**ï¼š

```text
# Synchronization.net
pl A, B, C
tr t_sync : {A, B} -> C  # å¤šè¾“å…¥å¼§
m0 A:1 B:1
```

**æ€§è´¨**ï¼š

```text
å®šç†ï¼ˆåŒæ­¥å±éšœï¼‰ï¼š
  åªæœ‰å½“ M(A) â‰¥ 1 âˆ§ M(B) â‰¥ 1 æ—¶ï¼Œt_sync æ‰èƒ½ç‚¹ç«
  
å®šç†ï¼ˆå…³é”®è·¯å¾„ï¼‰ï¼š
  æ€»æ—¶é—´ = max(åˆ°è¾¾Açš„æ—¶é—´, åˆ°è¾¾Bçš„æ—¶é—´) + T_C
```

---

### 2.4 Exclusive Choiceï¼ˆäº’æ–¥é€‰æ‹© / XOR-Splitï¼‰

**å®šä¹‰**ï¼šæ ¹æ®æ¡ä»¶é€‰æ‹©**ä¸€æ¡**åˆ†æ”¯æ‰§è¡Œã€‚

**Petri ç½‘**ï¼š

```text
Place:  start â†’ choice â‡‰ A
                       â‡‰ B

Transitions:
  t_A: choice â†’ A  (æ¡ä»¶ cond_A)
  t_B: choice â†’ B  (æ¡ä»¶ cond_B)
  
  çº¦æŸï¼šcond_A âˆ§ cond_B = false
```

**é¢œè‰² Petri ç½‘ï¼ˆCPNï¼‰**ï¼š

```text
colset COND = with condA | condB;
var c : COND;

Place choice: COND;

tr t_A: choice(condA) -> A
tr t_B: choice(condB) -> B
```

**æ€§è´¨**ï¼š

```text
å®šç†ï¼ˆäº’æ–¥æ€§ï¼‰ï¼š
  âˆ€æ‰§è¡Œï¼Œåˆ°è¾¾ A âŠ• åˆ°è¾¾ Bï¼ˆå¼‚æˆ–ï¼‰
  
å®šç†ï¼ˆéç¡®å®šæ€§ï¼‰ï¼š
  è‹¥æ¡ä»¶é‡å ï¼Œåˆ™å­˜åœ¨å¤šæ¡è·¯å¾„
```

---

### 2.5 Simple Mergeï¼ˆç®€å•åˆå¹¶ / XOR-Joinï¼‰

**å®šä¹‰**ï¼šå¤šæ¡åˆ†æ”¯**ä»»æ„ä¸€æ¡**åˆ°è¾¾å³ç»§ç»­ã€‚

**Petri ç½‘**ï¼š

```text
Place:  A â†’ merge â†’ end
        B â†’ merge

Transition:
  t_merge: A âˆ¨ B â†’ end
```

**æ³¨æ„**ï¼šè‹¥ A å’Œ B **åŒæ—¶**åˆ°è¾¾ï¼Œ`t_merge` ä¼šç‚¹ç«**ä¸¤æ¬¡**ï¼ˆå¯èƒ½ä¸æ˜¯æœŸæœ›è¡Œä¸ºï¼‰ã€‚

**æ”¹è¿›**ï¼ˆåŠ äº’æ–¥ä¿æŠ¤ï¼‰ï¼š

```text
ä½¿ç”¨ Token-Ring æˆ– Mutex Place é˜²æ­¢é‡å¤ç‚¹ç«
```

---

## 3. é«˜çº§æ§åˆ¶æµæ¨¡å¼ï¼ˆ15 ç§èŠ‚é€‰ï¼‰

### 3.1 Multi-Choiceï¼ˆå¤šé€‰ / OR-Splitï¼‰

**å®šä¹‰**ï¼šæ ¹æ®æ¡ä»¶é€‰æ‹©**ä¸€ä¸ªæˆ–å¤šä¸ª**åˆ†æ”¯ã€‚

**Petri ç½‘**ï¼š

```text
tr t_A: start -> A  if cond_A
tr t_B: start -> B  if cond_B
tr t_C: start -> C  if cond_C

å¯èƒ½åŒæ—¶ç‚¹ç«å¤šä¸ªå˜è¿ï¼ˆéç¡®å®šæ€§ï¼‰
```

### 3.2 Structured Synchronizing Mergeï¼ˆç»“æ„åŒ–åŒæ­¥åˆå¹¶ï¼‰

**å®šä¹‰**ï¼šæ ¹æ®å‰é¢çš„ Multi-Choiceï¼Œ**åŠ¨æ€**å†³å®šéœ€è¦ç­‰å¾…å‡ ä¸ªåˆ†æ”¯ã€‚

**å®ç°**ï¼šéœ€è¦**é¢œè‰² Petri ç½‘**æˆ–**é«˜çº§åŒæ­¥**æœºåˆ¶ã€‚

### 3.3 Multiple Instances without Synchronization

**å®šä¹‰**ï¼šå¯¹æ¯ä¸ªæ•°æ®é¡¹å¯åŠ¨ä¸€ä¸ªä»»åŠ¡å®ä¾‹ï¼Œ**ä¸ç­‰å¾…**å®ƒä»¬å®Œæˆã€‚

**Petri ç½‘**ï¼š

```text
foreach item in list:
  create_token(process_item, item)
```

### 3.4 Deferred Choiceï¼ˆå»¶è¿Ÿé€‰æ‹©ï¼‰

**å®šä¹‰**ï¼šç”±**ç¯å¢ƒ**ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ï¼‰å†³å®šèµ°å“ªæ¡åˆ†æ”¯ã€‚

**å®ç°**ï¼šç”¨**è®¡æ—¶å™¨**æˆ–**å¤–éƒ¨äº‹ä»¶**è§¦å‘å˜è¿ã€‚

### 3.5 Cancel Activityï¼ˆå–æ¶ˆæ´»åŠ¨ï¼‰

**å®šä¹‰**ï¼šä¸­é€”å–æ¶ˆæŸä¸ªæ´»åŠ¨ã€‚

**Petri ç½‘**ï¼š

```text
æ·»åŠ  "cancel" å˜è¿ï¼Œç›´æ¥æ¸…ç©ºç›®æ ‡ Place çš„æ‰˜è‚¯
```

---

## 4. å®Œæ•´ç¤ºä¾‹ï¼šé‡‡è´­æµç¨‹

### 4.1 æµç¨‹æè¿°

```text
1. æäº¤é‡‡è´­ç”³è¯·
2. å¹¶è¡Œå®¡æ‰¹ï¼š
   - éƒ¨é—¨ç»ç†å®¡æ‰¹
   - è´¢åŠ¡å®¡æ‰¹
3. åŒæ­¥ï¼šä¸¤è€…éƒ½é€šè¿‡
4. é€‰æ‹©ï¼š
   - é‡‘é¢ < 10000ï¼šè‡ªåŠ¨é‡‡è´­
   - é‡‘é¢ â‰¥ 10000ï¼šæ€»ç»ç†å®¡æ‰¹ â†’ é‡‡è´­
5. å®Œæˆ
```

### 4.2 Petri ç½‘å»ºæ¨¡

```text
# Purchase.net
pl submit, mgr_review, fin_review, sync, decide, auto_buy, ceo_review, buy, done

tr t1: submit -> {mgr_review, fin_review}  # å¹¶è¡Œåˆ†æ”¯
tr t2: {mgr_review, fin_review} -> sync     # åŒæ­¥
tr t3: sync -> decide

# äº’æ–¥é€‰æ‹©
tr t_auto: decide -> auto_buy  if amount < 10000
tr t_ceo: decide -> ceo_review if amount >= 10000

tr t4: auto_buy -> buy
tr t5: ceo_review -> buy
tr t6: buy -> done

m0 submit:1
```

### 4.3 éªŒè¯

#### æ­»é”æ£€æŸ¥

```bash
tina -ctl Purchase.net -f "AG !deadlock"
```

#### æœ€ç»ˆå¿…è¾¾

```text
AG EF done
```

#### äº’æ–¥æ€§

```text
AG !(auto_buy=1 âˆ§ ceo_review=1)
```

---

## 5. æ•°æ®æ¨¡å¼ï¼ˆèŠ‚é€‰ 5 ç§ï¼‰

### 5.1 Task Dataï¼ˆä»»åŠ¡æ•°æ®ï¼‰

**å®šä¹‰**ï¼šæ•°æ®ä»…åœ¨å•ä¸ªä»»åŠ¡å†…å¯è§ã€‚

### 5.2 Block Dataï¼ˆå—æ•°æ®ï¼‰

**å®šä¹‰**ï¼šæ•°æ®åœ¨å­æµç¨‹å†…å…±äº«ã€‚

### 5.3 Case Dataï¼ˆæ¡ˆä¾‹æ•°æ®ï¼‰

**å®šä¹‰**ï¼šæ•°æ®åœ¨æ•´ä¸ªæµç¨‹å®ä¾‹ä¸­å…±äº«ã€‚

### 5.4 Task to Taskï¼ˆä»»åŠ¡é—´ä¼ é€’ï¼‰

**Petri ç½‘å®ç°**ï¼šç”¨**é¢œè‰²**æˆ–**æ‰˜è‚¯æºå¸¦æ•°æ®**ã€‚

**CPN Tools ç¤ºä¾‹**ï¼š

```text
colset DATA = int;
var x : DATA;

tr t1: A(x) -> B(x+1)
```

### 5.5 Environment to Taskï¼ˆç¯å¢ƒè¾“å…¥ï¼‰

**å®ç°**ï¼šå¤–éƒ¨äº‹ä»¶è§¦å‘ï¼Œæ‰˜è‚¯æºå¸¦è¾“å…¥æ•°æ®ã€‚

---

## 6. èµ„æºæ¨¡å¼ï¼ˆèŠ‚é€‰ 5 ç§ï¼‰

### 6.1 Direct Allocationï¼ˆç›´æ¥åˆ†é…ï¼‰

**å®šä¹‰**ï¼šä»»åŠ¡æŒ‡å®šç‰¹å®šèµ„æºï¼ˆå¦‚ç”¨æˆ·ï¼‰ã€‚

### 6.2 Role-Based Allocationï¼ˆåŸºäºè§’è‰²ï¼‰

**å®šä¹‰**ï¼šä»»åŠ¡åˆ†é…ç»™æ»¡è¶³è§’è‰²æ¡ä»¶çš„èµ„æºã€‚

### 6.3 Deferred Allocationï¼ˆå»¶è¿Ÿåˆ†é…ï¼‰

**å®šä¹‰**ï¼šä»»åŠ¡å¯åŠ¨æ—¶æ‰åˆ†é…èµ„æºã€‚

### 6.4 Authorizationï¼ˆæˆæƒï¼‰

**å®šä¹‰**ï¼šèµ„æºéœ€è¦æƒé™æ‰èƒ½æ‰§è¡Œä»»åŠ¡ã€‚

### 6.5 Separation of Dutiesï¼ˆèŒè´£åˆ†ç¦»ï¼‰

**å®šä¹‰**ï¼šåŒä¸€æµç¨‹çš„æŸäº›ä»»åŠ¡**ä¸èƒ½**ç”±åŒä¸€èµ„æºæ‰§è¡Œã€‚

**Petri ç½‘æ‰©å±•**ï¼š

```text
æ·»åŠ  "resource token"ï¼Œå¸¦æ ‡è¯†ç¬¦
çº¦æŸï¼štâ‚ å’Œ tâ‚‚ çš„ resource token å¿…é¡»ä¸åŒ
```

---

## 7. å·¥å…·é“¾

### 7.1 Petri ç½‘å»ºæ¨¡ä¸éªŒè¯å·¥å…·

| å·¥å…· | ç±»å‹ | ç‰¹ç‚¹ | å®‰è£…å‘½ä»¤ |
|------|------|------|----------|
| **Tina** | P/T ç½‘ | è½»é‡ã€CTL æ¨¡å‹æ£€æµ‹ | `apt install tina` |
| **CPN Tools** | é¢œè‰²ç½‘ | GUIã€ä»¿çœŸã€æ€§èƒ½åˆ†æ | `docker pull cpntools/cpntools` |
| **mCRL2** | è¿›ç¨‹ä»£æ•° | LTS ç”Ÿæˆã€Î¼-æ¼”ç®— | `brew install mcrl2` |
| **LoLA** | P/T ç½‘ | çŠ¶æ€æ–¹ç¨‹ã€çº¿æ€§ä»£æ•° | <https://theo.informatik.uni-rostock.de/theo-forschung/tools/lola/> |
| **PIPE** | P/T ç½‘ | Java GUI | <https://pipe2.sourceforge.net/> |

### 7.2 BPMN åˆ° Petri ç½‘è½¬æ¢

```bash
# ä½¿ç”¨ ProM å·¥å…·é“¾
java -jar ProM.jar -f bpmn2pn.xml input.bpmn output.pnml
```

---

## 8. å½¢å¼åŒ–éªŒè¯æ¡ˆä¾‹

### 8.1 æ¡ˆä¾‹ï¼šå®¡æ‰¹æµç¨‹

**éœ€æ±‚**ï¼š

1. ç”³è¯· â†’ å®¡æ‰¹ â†’ æ‰§è¡Œ
2. å®¡æ‰¹å¯æ‹’ç» â†’ è¿”å›ç”³è¯·
3. æ‰§è¡Œåå¿…é¡»å½’æ¡£

**Petri ç½‘**ï¼š

```text
pl apply, review, approved, rejected, execute, archive

tr t_submit: apply -> review
tr t_approve: review -> approved
tr t_reject: review -> rejected
tr t_rework: rejected -> apply
tr t_exec: approved -> execute
tr t_archive: execute -> archive
```

**éªŒè¯æ€§è´¨**ï¼š

```text
1. æ­»é”è‡ªç”±ï¼šAG EX true  âœ“
2. å¿…è¾¾å½’æ¡£ï¼šAG EF archive  âœ“
3. æ‹’ç»åå¯é‡åšï¼šAG (rejected -> EF apply)  âœ“
```

**mCRL2 éªŒè¯**ï¼š

```mcrl2
proc Approval = 
  submit . (approve . execute . archive
           + reject . Approval);

init Approval;
```

```bash
mcrl22lps approval.mcrl2 | lps2lts -v | ltsconvert -eliveness
# è¾“å‡ºï¼šNo deadlocks, all paths reach archive
```

---

## 9. å¤§å­¦è¯¾ç¨‹å¯¹åº”

| è¯¾ç¨‹ | ç›¸å…³ç« èŠ‚ |
|------|----------|
| **TU Eindhoven BPM** | å…¨éƒ¨ 43 ç§å·¥ä½œæµæ¨¡å¼ |
| **ETH ZÃ¼rich Formal Methods** | Petri ç½‘æ¨¡å‹æ£€æµ‹ |
| **CMU 17-355 Software Architecture** | æµç¨‹å»ºæ¨¡ |
| **UC Berkeley CS 294 Workflow Systems** | BPMNã€YAWL |

---

## 10. å›½é™…æ ‡å‡†å¯¹åº”

| æ ‡å‡† | å†…å®¹ | æœ¬æ–‡å¯¹åº” |
|------|------|----------|
| **BPMN 2.0** (ISO/IEC 19510) | ä¸šåŠ¡æµç¨‹å»ºæ¨¡ç¬¦å· | æ§åˆ¶æµæ¨¡å¼ |
| **WS-BPEL 2.0** | Web æœåŠ¡ç¼–æ’ | æ•°æ®æµæ¨¡å¼ |
| **XPDL 2.2** | æµç¨‹å®šä¹‰äº¤æ¢ | å…¨éƒ¨æ¨¡å¼ |
| **Petri Net Markup Language (PNML)** | Petri ç½‘äº¤æ¢æ ¼å¼ | å½¢å¼åŒ–æ¨¡å‹ |

---

## 11. æœ¬åœ°é¡¹ç›®å¼•ç”¨

- `02.1_GoF_Formal_Analysis.md` - è®¾è®¡æ¨¡å¼çš„å½¢å¼åŒ–ï¼ˆè¡Œä¸ºæ¨¡å¼å¯ç”¨ Petri ç½‘ï¼‰
- `02.2_Distributed_Patterns.md` - Saga å¯ç”¨ Petri ç½‘å»ºæ¨¡
- `../03_Algorithm_Complexity/03.1_Multidimensional_Complexity.md` - å·¥ä½œæµçš„å¤æ‚åº¦åˆ†æ
- `../05_Formal_Verification/05.2_Model_Checking_Tools.md` - Petri ç½‘æ¨¡å‹æ£€æµ‹å·¥å…·

---

## 12. æ€»ç»“

### æ ¸å¿ƒæ´å¯Ÿ

```text
å·¥ä½œæµæ¨¡å¼ = å¯é‡ç”¨çš„æµç¨‹ç‰‡æ®µ

å½¢å¼åŒ– = Petri ç½‘ + CTL æ€§è´¨

éªŒè¯ = çŠ¶æ€ç©ºé—´æ¢ç´¢ + æ¨¡å‹æ£€æµ‹

æ§åˆ¶æµ 5 å¤§åŸºç¡€æ¨¡å¼ï¼š
  Sequence    â†’ ä¸²è¡Œ
  Parallel    â†’ å¹¶è¡Œ
  Sync        â†’ åŒæ­¥
  XOR-Split   â†’ äº’æ–¥é€‰æ‹©
  XOR-Join    â†’ ç®€å•åˆå¹¶
```

### å·¥å…·é“¾æ¨è

| åœºæ™¯ | æ¨èå·¥å…· |
|------|----------|
| **å¿«é€ŸéªŒè¯** | Tina + CTL |
| **æ€§èƒ½åˆ†æ** | CPN Tools |
| **å·¥ä¸š BPMN** | Camunda + ProM |
| **å­¦æœ¯ç ”ç©¶** | mCRL2 |

### å®æˆ˜å»ºè®®

1. **å»ºæ¨¡**ï¼šå…ˆç”¨ BPMN ç”»æµç¨‹å›¾ï¼Œå†è½¬ Petri ç½‘
2. **éªŒè¯**ï¼šç”¨ Tina å¿«é€Ÿæ£€æŸ¥æ­»é”ï¼Œç”¨ CPN Tools æ·±åº¦ä»¿çœŸ
3. **ä¼˜åŒ–**ï¼šç”¨çŠ¶æ€ç©ºé—´å¤§å°æŒ‡å¯¼æµç¨‹ç®€åŒ–
4. **å·¥ä¸šåŒ–**ï¼šç”¨ Camunda/Activiti å¼•æ“æ‰§è¡Œ BPMN

---

## é™„å½• Aï¼šWfMC 43 ç§æ¨¡å¼é€ŸæŸ¥è¡¨

### æ§åˆ¶æµæ¨¡å¼ï¼ˆ20 ç§ï¼‰

| ID | åç§° | Petri ç½‘ç‰¹å¾ |
|----|------|-------------|
| 1 | Sequence | å•é“¾ |
| 2 | Parallel Split | å¤šè¾“å‡ºå¼§ |
| 3 | Synchronization | å¤šè¾“å…¥å¼§ |
| 4 | Exclusive Choice | æ¡ä»¶åˆ†æ”¯ |
| 5 | Simple Merge | å•è¾“å…¥å¼§ |
| 6 | Multi-Choice | OR-Split |
| 7 | Structured Synchronizing Merge | åŠ¨æ€ Join |
| 8 | Multi-Merge | å¤šæ¬¡è§¦å‘ |
| 9 | Discriminator | é¦–ä¸ªåˆ°è¾¾å³è§¦å‘ |
| 10 | Arbitrary Cycles | ä»»æ„å¾ªç¯ |
| 11-20 | ... | ï¼ˆé«˜çº§æ¨¡å¼ï¼Œè§ WfMC å®˜ç½‘ï¼‰ |

### æ•°æ®æ¨¡å¼ï¼ˆ40 ç§ï¼ŒèŠ‚é€‰ï¼‰

| ID | åç§° | å®ç°æ–¹å¼ |
|----|------|----------|
| 1 | Task Data | å±€éƒ¨å˜é‡ |
| 2 | Block Data | ä½œç”¨åŸŸ |
| 9 | Task to Task | æ‰˜è‚¯æºå¸¦æ•°æ® |
| 12 | Case to Case | å…¨å±€å˜é‡ |

### èµ„æºæ¨¡å¼ï¼ˆ43 ç§ï¼ŒèŠ‚é€‰ï¼‰

| ID | åç§° | å®ç°æ–¹å¼ |
|----|------|----------|
| 1 | Direct Allocation | å›ºå®šèµ„æº ID |
| 2 | Role-Based | èµ„æºç±»å‹æ ‡ç­¾ |
| 8 | Separation of Duties | çº¦æŸæ£€æŸ¥ |

---

## é™„å½• Bï¼šPetri ç½‘å¯è¾¾å›¾ç¤ºä¾‹

### Sequence å¯è¾¾å›¾

```text
Mâ‚€ = [start:1, A:0, B:0, end:0]
  â†“ tâ‚
Mâ‚ = [start:0, A:1, B:0, end:0]
  â†“ tâ‚‚
Mâ‚‚ = [start:0, A:0, B:1, end:0]
  â†“ tâ‚ƒ
Mâ‚ƒ = [start:0, A:0, B:0, end:1]
```

çŠ¶æ€æ•°ï¼š4

### Parallel Split å¯è¾¾å›¾

```text
Mâ‚€ = [start:1, A:0, B:0]
  â†“ t_split
Mâ‚ = [start:0, A:1, B:1]
```

å¹¶å‘ï¼šA å’Œ B å¯ä»»æ„é¡ºåºå®Œæˆ

---

## é™„å½• Cï¼šWikipedia æ¦‚å¿µå¯¹ç…§

| æ¦‚å¿µ | Wikipedia æ¡ç›® | æœ¬æ–‡ç« èŠ‚ |
|------|----------------|----------|
| Petri Net | <https://en.wikipedia.org/wiki/Petri_net> | Â§1 |
| Workflow Patterns | <https://en.wikipedia.org/wiki/Workflow_patterns> | Â§2-6 |
| BPMN | <https://en.wikipedia.org/wiki/Business_Process_Model_and_Notation> | Â§7 |
| Model Checking | <https://en.wikipedia.org/wiki/Model_checking> | Â§8 |
| Reachability Graph | <https://en.wikipedia.org/wiki/Reachability> | é™„å½•B |

---

**ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2025-10-29  
**ç»´æŠ¤è€…**ï¼šFormalScience Project  
**è®¸å¯**ï¼šCC BY-SA 4.0
