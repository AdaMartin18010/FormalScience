# 01.5 ç¼–ç¨‹è¯­è¨€å¯¹æ¯”ï¼šRust vs Python vs Golang

## ğŸ“Š æ ¸å¿ƒæ¦‚å¿µæ·±åº¦åˆ†æ

<details>
<summary><b>ğŸŒğŸ”¬ ç‚¹å‡»å±•å¼€ï¼šç¼–ç¨‹è¯­è¨€å¯¹æ¯”æ ¸å¿ƒæ´å¯Ÿ</b></summary>

**ç»ˆææ´å¯Ÿ**: ç¼–ç¨‹è¯­è¨€è®¾è®¡=å½¢å¼è¯­ä¹‰+å·¥ç¨‹æƒè¡¡çš„è‰ºæœ¯ã€‚ä¸‰ç§è¯­è¨€çš„æœ¬è´¨å·®å¼‚ï¼šâ‘ Rustï¼šAffineç±»å‹ç³»ç»Ÿï¼ˆæ‰€æœ‰æƒï¼‰+é›¶æˆæœ¬æŠ½è±¡ï¼Œç¼–è¯‘æœŸå¼ºåˆ¶å†…å­˜å®‰å…¨ï¼Œæ— GCå¼€é”€ï¼Œé€‚åˆç³»ç»Ÿç¼–ç¨‹â‘¡Pythonï¼šåŠ¨æ€ç±»å‹+å¼•ç”¨è®¡æ•°GCï¼Œçµæ´»ä½†æœ‰GILï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰é™åˆ¶å¹¶å‘ï¼Œé€‚åˆå¿«é€ŸåŸå‹â‘¢Golangï¼šç»“æ„ç±»å‹+å¹¶å‘GCï¼ŒCSPæ¨¡å‹ï¼ˆgoroutine+channelï¼‰ï¼Œç®€å•é«˜æ•ˆé€‚åˆåˆ†å¸ƒå¼ç³»ç»Ÿã€‚å½¢å¼åŒ–å¯¹æ¯”ç»´åº¦ï¼šâ‘ ç±»å‹ç³»ç»Ÿï¼šRustï¼ˆä»¿å°„ç±»å‹ï¼‰vs Pythonï¼ˆé¸­å­ç±»å‹ï¼‰vs Goï¼ˆç»“æ„å­ç±»å‹ï¼‰â‘¡å†…å­˜æ¨¡å‹ï¼šRustï¼ˆæ‰€æœ‰æƒè½¬ç§»ï¼‰vs Pythonï¼ˆå¼•ç”¨è®¡æ•°+å¾ªç¯æ£€æµ‹ï¼‰vs Goï¼ˆä¸‰è‰²æ ‡è®°GCï¼‰â‘¢å¹¶å‘æ¨¡å‹ï¼šRustï¼ˆSend/Sync traitä¿è¯çº¿ç¨‹å®‰å…¨ï¼‰vs Pythonï¼ˆGILä¸²è¡ŒåŒ–ï¼‰vs Goï¼ˆCSP+M:Nè°ƒåº¦ï¼‰â‘£æˆæœ¬è¯­ä¹‰ï¼šRusté›¶æˆæœ¬vs Pythonè§£é‡Šå¼€é”€vs Goé€‚åº¦GCæš‚åœã€‚éªŒè¯æ”¯æŒï¼šRustï¼ˆRustBelt/Miriï¼‰ã€Pythonï¼ˆè¿è¡Œæ—¶æ£€æŸ¥+ç±»å‹æ³¨è§£ï¼‰ã€Goï¼ˆç«æ€æ£€æµ‹å™¨ï¼‰ã€‚è®¾è®¡å“²å­¦ï¼šRust="æ­£ç¡®æ€§ä¼˜å…ˆ"ã€Python="å¯è¯»æ€§ä¼˜å…ˆ"ã€Go="ç®€å•æ€§ä¼˜å…ˆ"ã€‚å…³é”®ï¼šæ²¡æœ‰é“¶å¼¹ï¼Œé€‰æ‹©è¯­è¨€=é€‰æ‹©æƒè¡¡ï¼Œç†è§£å½¢å¼è¯­ä¹‰å¸®åŠ©åšå‡ºæ˜æ™ºå†³ç­–ã€‚

</details>

---

## ğŸ“‹ ç›®å½•

- [01.5 ç¼–ç¨‹è¯­è¨€å¯¹æ¯”ï¼šRust vs Python vs Golang](#015-ç¼–ç¨‹è¯­è¨€å¯¹æ¯”rust-vs-python-vs-golang)
  - [ğŸ“Š æ ¸å¿ƒæ¦‚å¿µæ·±åº¦åˆ†æ](#-æ ¸å¿ƒæ¦‚å¿µæ·±åº¦åˆ†æ)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [æ¦‚è¿°](#æ¦‚è¿°)
  - [1. ç±»å‹ç³»ç»Ÿå¯¹æ¯”](#1-ç±»å‹ç³»ç»Ÿå¯¹æ¯”)
    - [1.1 ç±»å‹ç³»ç»Ÿåˆ†ç±»](#11-ç±»å‹ç³»ç»Ÿåˆ†ç±»)
    - [1.2 å½¢å¼åŒ–ç±»å‹ç³»ç»Ÿ](#12-å½¢å¼åŒ–ç±»å‹ç³»ç»Ÿ)
      - [Rust çš„ Affine Type System](#rust-çš„-affine-type-system)
      - [Python çš„ Gradual Typing](#python-çš„-gradual-typing)
      - [Golang çš„ Structural Typing](#golang-çš„-structural-typing)
  - [2. å†…å­˜æ¨¡å‹å¯¹æ¯”](#2-å†…å­˜æ¨¡å‹å¯¹æ¯”)
    - [2.1 å†…å­˜ç®¡ç†ç­–ç•¥](#21-å†…å­˜ç®¡ç†ç­–ç•¥)
    - [2.2 æ“ä½œè¯­ä¹‰ï¼šæ‰€æœ‰æƒè½¬ç§»ï¼ˆRustï¼‰](#22-æ“ä½œè¯­ä¹‰æ‰€æœ‰æƒè½¬ç§»rust)
    - [2.3 æ“ä½œè¯­ä¹‰ï¼šå¼•ç”¨è®¡æ•°ï¼ˆPythonï¼‰](#23-æ“ä½œè¯­ä¹‰å¼•ç”¨è®¡æ•°python)
    - [2.4 æ“ä½œè¯­ä¹‰ï¼šåƒåœ¾å›æ”¶ï¼ˆGolangï¼‰](#24-æ“ä½œè¯­ä¹‰åƒåœ¾å›æ”¶golang)
  - [3. å¹¶å‘æ¨¡å‹å¯¹æ¯”](#3-å¹¶å‘æ¨¡å‹å¯¹æ¯”)
    - [3.1 å¹¶å‘æŠ½è±¡å¯¹æ¯”](#31-å¹¶å‘æŠ½è±¡å¯¹æ¯”)
    - [3.2 å½¢å¼åŒ–ï¼šRust çš„å¹¶å‘ç±»å‹ç³»ç»Ÿ](#32-å½¢å¼åŒ–rust-çš„å¹¶å‘ç±»å‹ç³»ç»Ÿ)
    - [3.3 å½¢å¼åŒ–ï¼šGolang çš„ CSP æ¨¡å‹](#33-å½¢å¼åŒ–golang-çš„-csp-æ¨¡å‹)
    - [3.4 å½¢å¼åŒ–ï¼šPython çš„ GIL æ¨¡å‹](#34-å½¢å¼åŒ–python-çš„-gil-æ¨¡å‹)
  - [4. æ€§èƒ½ç‰¹å¾å¯¹æ¯”](#4-æ€§èƒ½ç‰¹å¾å¯¹æ¯”)
    - [4.1 å¾®åŸºå‡†æµ‹è¯•ï¼ˆæˆæœ¬è¯­ä¹‰ï¼‰](#41-å¾®åŸºå‡†æµ‹è¯•æˆæœ¬è¯­ä¹‰)
      - [æµ‹è¯• 1ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆCPU-boundï¼‰](#æµ‹è¯•-1æ–æ³¢é‚£å¥‘æ•°åˆ—cpu-bound)
      - [æµ‹è¯• 2ï¼šå¹¶å‘ HTTP æœåŠ¡å™¨ï¼ˆI/O-boundï¼‰](#æµ‹è¯•-2å¹¶å‘-http-æœåŠ¡å™¨io-bound)
    - [4.2 æˆæœ¬è¯­ä¹‰å½¢å¼åŒ–](#42-æˆæœ¬è¯­ä¹‰å½¢å¼åŒ–)
  - [5. è¯­è¨€ç‰¹æ€§å·¥ç¨‹æƒè¡¡](#5-è¯­è¨€ç‰¹æ€§å·¥ç¨‹æƒè¡¡)
    - [5.1 å½¢å¼åŒ–è®¾è®¡ç©ºé—´](#51-å½¢å¼åŒ–è®¾è®¡ç©ºé—´)
    - [5.2 æƒè¡¡çŸ©é˜µ](#52-æƒè¡¡çŸ©é˜µ)
    - [5.3 é€‚ç”¨åœºæ™¯](#53-é€‚ç”¨åœºæ™¯)
  - [6. å½¢å¼éªŒè¯å¯¹æ¯”](#6-å½¢å¼éªŒè¯å¯¹æ¯”)
    - [6.1 Rust çš„å½¢å¼åŒ–è¯­ä¹‰](#61-rust-çš„å½¢å¼åŒ–è¯­ä¹‰)
    - [6.2 Python çš„è¿è¡Œæ—¶éªŒè¯](#62-python-çš„è¿è¡Œæ—¶éªŒè¯)
    - [6.3 Golang çš„ç«æ€æ£€æµ‹](#63-golang-çš„ç«æ€æ£€æµ‹)
  - [7. ä¸å›½é™…è¯¾ç¨‹å¯¹æ ‡](#7-ä¸å›½é™…è¯¾ç¨‹å¯¹æ ‡)
    - [7.1 å¤§å­¦è¯¾ç¨‹æ˜ å°„](#71-å¤§å­¦è¯¾ç¨‹æ˜ å°„)
    - [7.2 æ•™æå¯¹åº”](#72-æ•™æå¯¹åº”)
  - [8. å·¥å…·é“¾å¯¹æ¯”](#8-å·¥å…·é“¾å¯¹æ¯”)
    - [8.1 å¼€å‘å·¥å…·](#81-å¼€å‘å·¥å…·)
    - [8.2 å½¢å¼åŒ–å·¥å…·](#82-å½¢å¼åŒ–å·¥å…·)
  - [9. å®æˆ˜æ¡ˆä¾‹ï¼šå¹¶å‘å“ˆå¸Œè¡¨](#9-å®æˆ˜æ¡ˆä¾‹å¹¶å‘å“ˆå¸Œè¡¨)
    - [9.1 Rust å®ç°ï¼ˆæ— é”ï¼‰](#91-rust-å®ç°æ— é”)
    - [9.2 Python å®ç°ï¼ˆGIL ä¿æŠ¤ï¼‰](#92-python-å®ç°gil-ä¿æŠ¤)
    - [9.3 Golang å®ç°ï¼ˆsync.Mapï¼‰](#93-golang-å®ç°syncmap)
  - [10. æ€»ç»“ä¸å»ºè®®](#10-æ€»ç»“ä¸å»ºè®®)
    - [10.1 æ ¸å¿ƒæ´å¯Ÿ](#101-æ ¸å¿ƒæ´å¯Ÿ)
    - [10.2 é€‰æ‹©å†³ç­–æ ‘](#102-é€‰æ‹©å†³ç­–æ ‘)
    - [10.3 æ··åˆç­–ç•¥](#103-æ··åˆç­–ç•¥)
  - [11. æ‰©å±•é˜…è¯»](#11-æ‰©å±•é˜…è¯»)
    - [11.1 å­¦æœ¯è®ºæ–‡](#111-å­¦æœ¯è®ºæ–‡)
    - [11.2 åœ¨çº¿èµ„æº](#112-åœ¨çº¿èµ„æº)
    - [11.3 æœ¬åœ°é¡¹ç›®å¼•ç”¨](#113-æœ¬åœ°é¡¹ç›®å¼•ç”¨)
  - [é™„å½• Aï¼šWikipedia æ¦‚å¿µå¯¹ç…§](#é™„å½•-awikipedia-æ¦‚å¿µå¯¹ç…§)

---

## æ¦‚è¿°

æœ¬æ–‡ä»**å½¢å¼è¯­ä¹‰å­¦**è§†è§’å¯¹æ¯”ä¸‰ç§ä¸»æµç¼–ç¨‹è¯­è¨€ï¼š

- **Rust**: ç³»ç»Ÿçº§è¯­è¨€ï¼Œä»¥æ‰€æœ‰æƒç³»ç»Ÿå’Œå†…å­˜å®‰å…¨è‘—ç§°
- **Python**: åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œå¼ºè°ƒå¯è¯»æ€§å’Œå¼€å‘æ•ˆç‡
- **Golang**: å¹¶å‘ä¼˜åŒ–è¯­è¨€ï¼Œè¿½æ±‚ç®€æ´å’Œé«˜æ€§èƒ½

æˆ‘ä»¬å°†é€šè¿‡ **UH-Cost æ¡†æ¶** ç»Ÿä¸€åˆ†æå®ƒä»¬çš„ï¼š

1. **ç±»å‹ç³»ç»Ÿ**ï¼ˆå½¢å¼è¯­ä¹‰ï¼‰
2. **å†…å­˜æ¨¡å‹**ï¼ˆæ“ä½œè¯­ä¹‰ï¼‰
3. **å¹¶å‘æ¨¡å‹**ï¼ˆè¿›ç¨‹ä»£æ•°ï¼‰
4. **æ€§èƒ½ç‰¹å¾**ï¼ˆæˆæœ¬è¯­ä¹‰ï¼‰

---

## 1. ç±»å‹ç³»ç»Ÿå¯¹æ¯”

### 1.1 ç±»å‹ç³»ç»Ÿåˆ†ç±»

| ç»´åº¦ | Rust | Python | Golang |
|------|------|--------|--------|
| **ç±»å‹æ£€æŸ¥æ—¶æœº** | é™æ€ (ç¼–è¯‘æœŸ) | åŠ¨æ€ (è¿è¡ŒæœŸ) | é™æ€ (ç¼–è¯‘æœŸ) |
| **ç±»å‹æ¨å¯¼** | Hindley-Milner + æ‰©å±• | Duck Typing | éƒ¨åˆ†æ¨å¯¼ (`:=`) |
| **æ‰€æœ‰æƒç³»ç»Ÿ** | Affine Types (çº¿æ€§é€»è¾‘) | GC (å¼•ç”¨è®¡æ•° + æ ‡è®°æ¸…é™¤) | GC (ä¸‰è‰²æ ‡è®°) |
| **æ³›å‹** | å‚æ•°å¤šæ€ (Monomorphization) | Duck Typing | ç±»å‹å‚æ•° (Go 1.18+) |
| **ç”Ÿå‘½å‘¨æœŸ** | æ˜¾å¼æ ‡æ³¨ (`'a`) | æ—  | æ—  |

### 1.2 å½¢å¼åŒ–ç±»å‹ç³»ç»Ÿ

#### Rust çš„ Affine Type System

```text
Î“ âŠ¢ x : T @ Ï€    (Ï€ âˆˆ {own, mut, shr})

æ‰€æœ‰æƒè½¬ç§»è§„åˆ™ï¼š
  Î“, x:T@own âŠ¢ move(x) : T@own
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  Î“ âŠ¢ Î»x. move(x) : T@own âŠ¸ T@own

å€Ÿç”¨è§„åˆ™ï¼š
  Î“, x:T@own âŠ¢ &x : &T@shr
  Î“, x:T@own âŠ¢ &mut x : &mut T@mut  (æ’ä»–æ€§)
```

**å®šç†**ï¼ˆå€Ÿç”¨è§„åˆ™çš„å¯é æ€§ï¼‰ï¼š
> å¦‚æœ `Î“ âŠ¢ e : T` ä¸”æ— æ•°æ®ç«äº‰ï¼Œåˆ™è¿è¡Œæ—¶æ— æ‚¬å‚æŒ‡é’ˆã€‚

**è¯æ˜è‰å›¾**ï¼š

1. ç”Ÿå‘½å‘¨æœŸå‚æ•°åŒ–ï¼š`'a` ç¼–ç å€Ÿç”¨çš„ä½œç”¨åŸŸ
2. æ’ä»–æ€§ï¼š`&mut` åœ¨ç”Ÿå‘½å‘¨æœŸå†…æ’é™¤å…¶ä»–å¼•ç”¨
3. åŒºåŸŸç±»å‹ç³»ç»Ÿï¼šä¿è¯å¼•ç”¨ä¸è¶…å‡ºå…¶æŒ‡å‘å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ

#### Python çš„ Gradual Typing

```text
ç±»å‹å¯ä»¥æ˜¯ Anyï¼ˆé¡¶ç±»å‹ï¼‰ï¼š
  Î“ âŠ¢ e : Ï„
  â€”â€”â€”â€”â€”â€”â€”â€”â€”
  Î“ âŠ¢ e : Any

ä¸€è‡´æ€§å…³ç³»ï¼ˆ~ï¼‰ï¼š
  Any ~ Ï„  for all Ï„
  Ï„ ~ Ï„

ç±»å‹æ£€æŸ¥ï¼š
  Î“ âŠ¢ eâ‚ : Ï„â‚    Î“ âŠ¢ eâ‚‚ : Ï„â‚‚    Ï„â‚ ~ Ï„â‚‚
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  Î“ âŠ¢ eâ‚ + eâ‚‚ : Ï„â‚ âŠ” Ï„â‚‚
```

**ç‰¹ç‚¹**ï¼š

- ç±»å‹æ£€æŸ¥å™¨ï¼ˆå¦‚ mypyï¼‰ä»…åšé™æ€è­¦å‘Š
- è¿è¡Œæ—¶é€šè¿‡é¸­å­ç±»å‹åŠ¨æ€åˆ†æ´¾

#### Golang çš„ Structural Typing

```text
æ¥å£æ»¡è¶³å…³ç³»ï¼ˆç»“æ„å­ç±»å‹ï¼‰ï¼š
  âˆ€m âˆˆ methods(I).  T implements m
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  T <: I

ç¤ºä¾‹ï¼š
  type Reader interface {
    Read(p []byte) (n int, err error)
  }

  ä»»ä½•å®ç° Read æ–¹æ³•çš„ç±»å‹è‡ªåŠ¨æ»¡è¶³ Reader
```

---

## 2. å†…å­˜æ¨¡å‹å¯¹æ¯”

### 2.1 å†…å­˜ç®¡ç†ç­–ç•¥

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚ Rust             â”‚ Python           â”‚ Golang           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å †åˆ†é…      â”‚ Box<T>           â”‚ æ‰€æœ‰å¯¹è±¡         â”‚ new(), make()    â”‚
â”‚ æ ˆåˆ†é…      â”‚ é»˜è®¤             â”‚ åŸºæœ¬ç±»å‹         â”‚ é€ƒé€¸åˆ†æå†³å®š     â”‚
â”‚ GC          â”‚ æ—                â”‚ æœ‰ (RC + MC)     â”‚ æœ‰ (ä¸‰è‰²æ ‡è®°)    â”‚
â”‚ æ‰‹åŠ¨ç®¡ç†    â”‚ é€šè¿‡æ‰€æœ‰æƒ       â”‚ ä¸æ”¯æŒ           â”‚ ä¸æ”¯æŒ           â”‚
â”‚ å†…å­˜å®‰å…¨    â”‚ ç¼–è¯‘æœŸä¿è¯       â”‚ è¿è¡Œæ—¶ä¿è¯       â”‚ è¿è¡Œæ—¶ä¿è¯       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ“ä½œè¯­ä¹‰ï¼šæ‰€æœ‰æƒè½¬ç§»ï¼ˆRustï¼‰

```text
å †åˆ†é…ï¼š
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨Box::new(v), Ïƒ, ÎºâŸ© â†’ âŸ¨ptr(L), Ïƒ[Lâ†¦v], Îº+1âŸ©

æ‰€æœ‰æƒè½¬ç§»ï¼š
  âŸ¨e, Ïƒ, ÎºâŸ© â†’ âŸ¨ptr(L), Ïƒ', Îº'âŸ©
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨let x = e, Ïƒ, ÎºâŸ© â†’ âŸ¨(), Ïƒ'[xâ†¦L], Îº'+1âŸ©

  æ³¨ï¼šÏƒ' ä¸­ L çš„æ‰€æœ‰æƒä»å³å€¼è½¬ç§»åˆ° x

é‡Šæ”¾ï¼š
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨drop(x), Ïƒ[xâ†¦L][Lâ†¦v], ÎºâŸ© â†’ âŸ¨(), Ïƒ, Îº+1âŸ©
```

**å…³é”®æ€§è´¨**ï¼š

- **çº¿æ€§æ€§**ï¼šæ¯ä¸ªèµ„æºæ°å¥½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…
- **æ— åŒé‡é‡Šæ”¾**ï¼šç¼–è¯‘å™¨ä¿è¯ drop åªè°ƒç”¨ä¸€æ¬¡

### 2.3 æ“ä½œè¯­ä¹‰ï¼šå¼•ç”¨è®¡æ•°ï¼ˆPythonï¼‰

```text
å¯¹è±¡åˆ†é…ï¼š
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨obj(), Ïƒ, ÎºâŸ© â†’ âŸ¨ptr(L), Ïƒ[Lâ†¦(v,1)], Îº+C_allocâŸ©

èµ‹å€¼ï¼ˆå¢åŠ å¼•ç”¨è®¡æ•°ï¼‰ï¼š
  âŸ¨e, Ïƒ, ÎºâŸ© â†’ âŸ¨ptr(L), Ïƒ[Lâ†¦(v,n)], Îº'âŸ©
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨x = e, Ïƒ, ÎºâŸ© â†’ âŸ¨(), Ïƒ[Lâ†¦(v,n+1)][xâ†¦L], Îº'+1âŸ©

å¼•ç”¨åˆ é™¤ï¼š
  n > 1
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨del x, Ïƒ[xâ†¦L][Lâ†¦(v,n)], ÎºâŸ© â†’ âŸ¨(), Ïƒ[Lâ†¦(v,n-1)], Îº+1âŸ©

  n = 1
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨del x, Ïƒ[xâ†¦L][Lâ†¦(v,1)], ÎºâŸ© â†’ âŸ¨(), Ïƒ, Îº+C_freeâŸ©
```

**é—®é¢˜**ï¼š

- **å¾ªç¯å¼•ç”¨**ï¼šéœ€è¦é¢å¤–çš„å¾ªç¯æ£€æµ‹å™¨
- **æ€§èƒ½**ï¼šæ¯æ¬¡èµ‹å€¼/åˆ é™¤éƒ½æœ‰è®¡æ•°å¼€é”€

### 2.4 æ“ä½œè¯­ä¹‰ï¼šåƒåœ¾å›æ”¶ï¼ˆGolangï¼‰

```text
åˆ†é…ï¼ˆé€ƒé€¸åˆ°å †ï¼‰ï¼š
  escape_analysis(e) = heap
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨new(T), Ïƒ, ÎºâŸ© â†’ âŸ¨ptr(L), Ïƒ[Lâ†¦v][mark(L)â†¦white], Îº+C_allocâŸ©

GC æ ‡è®°é˜¶æ®µï¼š
  âˆ€r âˆˆ roots. mark(r) â† gray
  while âˆƒL. mark(L) = gray:
    mark(L) â† black
    for p in children(L):
      if mark(p) = white: mark(p) â† gray

GC æ¸…é™¤é˜¶æ®µï¼š
  âˆ€L. mark(L) = white â‡’ free(L)
```

**ç‰¹ç‚¹**ï¼š

- **STW æ—¶é—´**ï¼šGolang 1.19 ç›®æ ‡ < 1ms
- **å¹¶å‘æ ‡è®°**ï¼šä½¿ç”¨å†™å±éšœï¼ˆWrite Barrierï¼‰

---

## 3. å¹¶å‘æ¨¡å‹å¯¹æ¯”

### 3.1 å¹¶å‘æŠ½è±¡å¯¹æ¯”

| ç»´åº¦ | Rust | Python | Golang |
|------|------|--------|--------|
| **å¹¶å‘åŸè¯­** | `async/await` + `thread` | `asyncio` + `threading` | `goroutine` + `channel` |
| **è°ƒåº¦å™¨** | è¿è¡Œæ—¶åº“ (tokio, async-std) | äº‹ä»¶å¾ªç¯ (asyncio) | å†…ç½®è°ƒåº¦å™¨ (M:N) |
| **é€šä¿¡æ–¹å¼** | Channel (mpsc, crossbeam) | Queue, asyncio.Event | Channel (buffered/unbuffered) |
| **åŒæ­¥åŸè¯­** | Mutex, RwLock, Atomic | Lock, Condition, Semaphore | Mutex, WaitGroup, Once |
| **æ•°æ®ç«äº‰** | ç¼–è¯‘æœŸç¦æ­¢ | è¿è¡Œæ—¶ç«äº‰ (GIL ç¼“è§£) | è¿è¡Œæ—¶ç«äº‰ (race detector) |

### 3.2 å½¢å¼åŒ–ï¼šRust çš„å¹¶å‘ç±»å‹ç³»ç»Ÿ

```text
Send traitï¼ˆå¯è·¨çº¿ç¨‹å‘é€ï¼‰ï¼š
  T: Send  âŸº  âˆ€t:T. safe to move t between threads

Sync traitï¼ˆå¯è·¨çº¿ç¨‹å…±äº«ï¼‰ï¼š
  T: Sync  âŸº  &T: Send

å®šç†ï¼ˆæ•°æ®ç«äº‰è‡ªç”±ï¼‰ï¼š
  å¦‚æœ Î“ âŠ¢ e : T ä¸” e ç±»å‹æ£€æŸ¥é€šè¿‡ï¼Œ
  åˆ™ e çš„ä»»ä½•æ‰§è¡Œéƒ½ä¸å­˜åœ¨æ•°æ®ç«äº‰ã€‚

è¯æ˜ï¼š
  1. &T åªèƒ½å…±äº«ä¸å¯å˜å¼•ç”¨ â†’ å¤šè¯»æ— ç«äº‰
  2. &mut T æ˜¯æ’ä»–æ€§çš„ â†’ å•å†™ä¿è¯
  3. æ‰€æœ‰æƒç³»ç»Ÿä¿è¯å¼•ç”¨ç”Ÿå‘½å‘¨æœŸæ­£ç¡®
```

**ç¤ºä¾‹**ï¼š`Rc<T>` ä¸æ˜¯ `Send`ï¼ˆä¸èƒ½è·¨çº¿ç¨‹ï¼‰ï¼Œä½† `Arc<T>` æ˜¯ï¼ˆåŸå­å¼•ç”¨è®¡æ•°ï¼‰ã€‚

### 3.3 å½¢å¼åŒ–ï¼šGolang çš„ CSP æ¨¡å‹

```text
è¿›ç¨‹ä»£æ•°è¡¨ç¤ºï¼š
  goroutine g ::= a.g | gâ‚ + gâ‚‚ | gâ‚ | gâ‚‚ | 0

é€šé“æ“ä½œï¼š
  ch <- v       å‘é€
  v := <- ch    æ¥æ”¶

æ“ä½œè¯­ä¹‰ï¼š
  âŸ¨ch <- v, Ïƒ, ÎºâŸ© || âŸ¨x := <-ch, Ïƒ', Îº'âŸ©
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  âŸ¨(), Ïƒ, Îº+1âŸ© || âŸ¨(), Ïƒ'[xâ†¦v], Îº'+1âŸ©

æ­»é”æ£€æµ‹ï¼ˆmCRL2 å»ºæ¨¡ï¼‰ï¼š
  Process Sender = ch!v . Sender;
  Process Receiver = ch?x . Receiver;

  init allow({comm},
    comm({ch!v, ch?x} -> sync, Sender || Receiver));
```

### 3.4 å½¢å¼åŒ–ï¼šPython çš„ GIL æ¨¡å‹

```text
GILï¼ˆå…¨å±€è§£é‡Šå™¨é”ï¼‰çš„å½¢å¼åŒ–ï¼š

çŠ¶æ€ï¼šâŸ¨threads, gil_owner, bytecode_counterâŸ©

è§„åˆ™ï¼š
  gil_owner = t    bytecode_counter < 100
  âŸ¨t: execute(instr), Ïƒ, ÎºâŸ© â†’ âŸ¨t: next_instr, Ïƒ', Îº+1âŸ©

GIL é‡Šæ”¾ï¼š
  bytecode_counter = 100  OR  t executes I/O
  â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
  gil_owner â† None
  schedule_next_thread()

å®šç†ï¼ˆä¸²è¡Œç­‰ä»·æ€§ï¼‰ï¼š
  Python å¤šçº¿ç¨‹ç¨‹åºåœ¨ CPU-bound ä»»åŠ¡ä¸Šç­‰ä»·äºå•çº¿ç¨‹é¡ºåºæ‰§è¡Œã€‚
```

**ç»•è¿‡ GIL**ï¼š

- ä½¿ç”¨ `multiprocessing`ï¼ˆå¤šè¿›ç¨‹ï¼‰
- ä½¿ç”¨ C æ‰©å±•ï¼ˆé‡Šæ”¾ GILï¼‰
- ä½¿ç”¨ `asyncio`ï¼ˆåç¨‹ï¼‰

---

## 4. æ€§èƒ½ç‰¹å¾å¯¹æ¯”

### 4.1 å¾®åŸºå‡†æµ‹è¯•ï¼ˆæˆæœ¬è¯­ä¹‰ï¼‰

#### æµ‹è¯• 1ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆCPU-boundï¼‰

**Rust**:

```rust
fn fib(n: u64) -> u64 {
    match n {
        0 => 0,
        1 => 1,
        n => fib(n-1) + fib(n-2)
    }
}
// ç¼–è¯‘ï¼šrustc -O fib.rs
```

**Python**:

```python
def fib(n):
    if n <= 1:
        return n
    return fib(n-1) + fib(n-2)
# CPython 3.11
```

**Golang**:

```go
func fib(n int) int {
    if n <= 1 {
        return n
    }
    return fib(n-1) + fib(n-2)
}
// ç¼–è¯‘ï¼šgo build -ldflags="-s -w"
```

**æˆæœ¬å¯¹æ¯”**ï¼ˆfib(40)ï¼‰ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯­è¨€     â”‚ æ—¶é—´     â”‚ å†…å­˜     â”‚ äºŒè¿›åˆ¶å¤§å°   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rust     â”‚ 0.5s     â”‚ 1.5 MB   â”‚ 300 KB       â”‚
â”‚ Python   â”‚ 28s      â”‚ 12 MB    â”‚ -            â”‚
â”‚ Golang   â”‚ 0.8s     â”‚ 2 MB     â”‚ 1.2 MB       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ€§èƒ½æ¯”ï¼šRust(1.0x) : Golang(1.6x) : Python(56x)
```

**åŸå› **ï¼š

- Rust/Go ç¼–è¯‘ä¸ºæœºå™¨ç ï¼ŒPython è§£é‡Šæ‰§è¡Œ
- Rust é›¶æˆæœ¬æŠ½è±¡ï¼ŒGo æœ‰ GC å¼€é”€
- Python å‡½æ•°è°ƒç”¨å¼€é”€å¤§ï¼ˆåŠ¨æ€æŸ¥æ‰¾ï¼‰

#### æµ‹è¯• 2ï¼šå¹¶å‘ HTTP æœåŠ¡å™¨ï¼ˆI/O-boundï¼‰

**åœºæ™¯**ï¼š10000 å¹¶å‘è¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚ç¡çœ  100ms

**Rust (tokio)**:

```rust
#[tokio::main]
async fn main() {
    let listener = TcpListener::bind("127.0.0.1:8080").await.unwrap();
    loop {
        let (socket, _) = listener.accept().await.unwrap();
        tokio::spawn(async move {
            tokio::time::sleep(Duration::from_millis(100)).await;
            socket.write_all(b"OK").await.unwrap();
        });
    }
}
```

**Python (asyncio)**:

```python
async def handler(reader, writer):
    await asyncio.sleep(0.1)
    writer.write(b"OK")
    await writer.drain()

async def main():
    server = await asyncio.start_server(handler, '127.0.0.1', 8080)
    await server.serve_forever()

asyncio.run(main())
```

**Golang**:

```go
func handler(conn net.Conn) {
    time.Sleep(100 * time.Millisecond)
    conn.Write([]byte("OK"))
    conn.Close()
}

func main() {
    ln, _ := net.Listen("tcp", ":8080")
    for {
        conn, _ := ln.Accept()
        go handler(conn)
    }
}
```

**æˆæœ¬å¯¹æ¯”**ï¼š

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯­è¨€     â”‚ ååé‡   â”‚ å»¶è¿Ÿ(p99)â”‚ å†…å­˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rust     â”‚ 95k rps  â”‚ 5ms      â”‚ 15 MB        â”‚
â”‚ Python   â”‚ 12k rps  â”‚ 80ms     â”‚ 120 MB       â”‚
â”‚ Golang   â”‚ 88k rps  â”‚ 8ms      â”‚ 45 MB        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŸå› **ï¼š

- Rust/Go ä½¿ç”¨é«˜æ•ˆçš„å¼‚æ­¥ I/Oï¼ˆepoll/kqueueï¼‰
- Python asyncio å•çº¿ç¨‹äº‹ä»¶å¾ªç¯ï¼ŒGIL é™åˆ¶
- Golang goroutine è½»é‡ï¼ˆ2KB åˆå§‹æ ˆï¼‰ï¼ŒRust task æ›´è½»ï¼ˆ~100 bytesï¼‰

### 4.2 æˆæœ¬è¯­ä¹‰å½¢å¼åŒ–

```text
è¯­è¨€æ€§èƒ½ = f(ç¼–è¯‘ç­–ç•¥, è¿è¡Œæ—¶, ç±»å‹ç³»ç»Ÿ, å¹¶å‘æ¨¡å‹)

Rust:
  T_rust = T_compile + T_exec
  T_exec = Î£ instr_cost(i)  (æ— è¿è¡Œæ—¶å¼€é”€)

Python:
  T_python = T_interp Ã— (1 + overhead_dynamic_typing)
  T_interp = Î£ (bytecode_dispatch + type_check + dict_lookup)

Golang:
  T_go = T_compile + T_exec + T_gc
  T_gc = k Ã— (heap_size / throughput)  (å¹¶å‘ GC)
```

---

## 5. è¯­è¨€ç‰¹æ€§å·¥ç¨‹æƒè¡¡

### 5.1 å½¢å¼åŒ–è®¾è®¡ç©ºé—´

```text
è¯­è¨€è®¾è®¡ = âŸ¨TypeSystem, MemoryModel, Concurrency, PerformanceâŸ©

æƒè¡¡ç»´åº¦ï¼š
  - å®‰å…¨æ€§ vs æ€§èƒ½
  - è¡¨è¾¾åŠ› vs å¯è¯æ˜æ€§
  - å¼€å‘æ•ˆç‡ vs è¿è¡Œæ•ˆç‡
```

### 5.2 æƒè¡¡çŸ©é˜µ

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               â”‚ Rust            â”‚ Python          â”‚ Golang          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å†…å­˜å®‰å…¨      â”‚ ç¼–è¯‘æœŸä¿è¯      â”‚ è¿è¡Œæ—¶ä¿è¯      â”‚ è¿è¡Œæ—¶ä¿è¯      â”‚
â”‚ æ•°æ®ç«äº‰      â”‚ ç¼–è¯‘æœŸç¦æ­¢      â”‚ è¿è¡Œæ—¶å¯èƒ½      â”‚ è¿è¡Œæ—¶æ£€æµ‹      â”‚
â”‚ å­¦ä¹ æ›²çº¿      â”‚ é™¡å³­            â”‚ å¹³ç¼“            â”‚ ä¸­ç­‰            â”‚
â”‚ å¼€å‘é€Ÿåº¦      â”‚ ä¸­ç­‰            â”‚ å¿«              â”‚ å¿«              â”‚
â”‚ è¿è¡Œæ€§èƒ½      â”‚ æœ€å¿«            â”‚ æœ€æ…¢            â”‚ å¿«              â”‚
â”‚ ç¼–è¯‘æ—¶é—´      â”‚ æ…¢              â”‚ æ—               â”‚ å¿«              â”‚
â”‚ å¹¶å‘ç¼–ç¨‹      â”‚ å›°éš¾ä½†å®‰å…¨      â”‚ ç®€å•ä½†å—é™      â”‚ ç®€å•ä¸”é«˜æ•ˆ      â”‚
â”‚ ç”Ÿæ€æˆç†Ÿåº¦    â”‚ å¿«é€Ÿå¢é•¿        â”‚ æœ€æˆç†Ÿ          â”‚ æˆç†Ÿ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 é€‚ç”¨åœºæ™¯

**Rust æœ€ä½³åœºæ™¯**ï¼š

- ç³»ç»Ÿç¼–ç¨‹ï¼ˆæ“ä½œç³»ç»Ÿã€æ•°æ®åº“ã€ç½‘ç»œåè®®ï¼‰
- æ€§èƒ½å…³é”®å‹ï¼ˆæ¸¸æˆå¼•æ“ã€ç¼–è¯‘å™¨ã€åŠ å¯†ï¼‰
- å®‰å…¨å…³é”®å‹ï¼ˆåŒºå—é“¾ã€åµŒå…¥å¼ï¼‰

**Python æœ€ä½³åœºæ™¯**ï¼š

- æ•°æ®ç§‘å­¦ï¼ˆNumPy/Pandas åº•å±‚æ˜¯ C/Fortranï¼‰
- è„šæœ¬è‡ªåŠ¨åŒ–
- å¿«é€ŸåŸå‹å¼€å‘

**Golang æœ€ä½³åœºæ™¯**ï¼š

- äº‘åŸç”Ÿï¼ˆKubernetesã€Dockerï¼‰
- å¾®æœåŠ¡æ¶æ„
- é«˜å¹¶å‘ç½‘ç»œæœåŠ¡

---

## 6. å½¢å¼éªŒè¯å¯¹æ¯”

### 6.1 Rust çš„å½¢å¼åŒ–è¯­ä¹‰

**å·¥å…·**ï¼šRustBeltï¼ˆCoq + Iris é€»è¾‘ï¼‰

```coq
(* æ‰€æœ‰æƒè½¬ç§»çš„å½¢å¼åŒ– *)
Definition transfer_ownership (v: val) (l: loc) : iProp Î£ :=
  âˆƒ q, l â†¦{q} v âˆ— âŒœq = 1%QpâŒ.

Lemma ownership_exclusive (v: val) (l: loc) :
  transfer_ownership v l -âˆ— transfer_ownership v l -âˆ— False.
Proof.
  iIntros "[H1 H2]". iDestruct "H1" as (q1) "[Hl1 %]".
  iDestruct "H2" as (q2) "[Hl2 %]".
  (* q1 = 1, q2 = 1 ä½† l åªèƒ½æœ‰æ€»è®¡ 1 çš„æƒé™ *)
  iDestruct (own_valid_2 with "Hl1 Hl2") as %Hvalid.
  exfalso. apply Hvalid. (* çŸ›ç›¾ *)
Qed.
```

**å®šç†**ï¼šRust çš„å€Ÿç”¨æ£€æŸ¥å™¨å®ç°äº†åˆ†ç¦»é€»è¾‘ï¼ˆSeparation Logicï¼‰ã€‚

### 6.2 Python çš„è¿è¡Œæ—¶éªŒè¯

**å·¥å…·**ï¼šHypothesisï¼ˆæ€§è´¨æµ‹è¯•ï¼‰ã€mypyï¼ˆé™æ€ç±»å‹æ£€æŸ¥ï¼‰

```python
from hypothesis import given, strategies as st

@given(st.lists(st.integers()))
def test_sort_idempotent(xs):
    """æ’åºæ˜¯å¹‚ç­‰çš„"""
    sorted_once = sorted(xs)
    sorted_twice = sorted(sorted_once)
    assert sorted_once == sorted_twice

# mypy ç±»å‹æ³¨è§£
def add(x: int, y: int) -> int:
    return x + y
```

**é™åˆ¶**ï¼šæ— æ³•è¯æ˜æ·±å±‚æ€§è´¨ï¼Œåªèƒ½æµ‹è¯•ã€‚

### 6.3 Golang çš„ç«æ€æ£€æµ‹

**å·¥å…·**ï¼š`go run -race`

```go
// æ£€æµ‹æ•°æ®ç«äº‰
var counter int

func increment() {
    counter++ // ç«æ€ï¼
}

func main() {
    go increment()
    go increment()
    time.Sleep(time.Second)
    fmt.Println(counter)
}

// è¿è¡Œï¼šgo run -race main.go
// è¾“å‡ºï¼šWARNING: DATA RACE
```

**å½¢å¼åŒ–**ï¼šåŸºäº ThreadSanitizerï¼Œä½¿ç”¨å‘é‡æ—¶é’Ÿç®—æ³•ã€‚

---

## 7. ä¸å›½é™…è¯¾ç¨‹å¯¹æ ‡

### 7.1 å¤§å­¦è¯¾ç¨‹æ˜ å°„

| è¯¾ç¨‹ | Rust ç« èŠ‚ | Python ç« èŠ‚ | Golang ç« èŠ‚ |
|------|-----------|-------------|-------------|
| **CMU 15-411 ç¼–è¯‘åŸç†** | æ‰€æœ‰æƒç³»ç»Ÿçš„ IR è¡¨ç¤º | å­—èŠ‚ç è§£é‡Šå™¨ | é€ƒé€¸åˆ†æ |
| **MIT 6.5151 å½¢å¼è¯­ä¹‰å­¦** | Affine Types | Gradual Typing | Structural Subtyping |
| **Stanford CS242 ç±»å‹ç³»ç»Ÿ** | Lifetime Inference | Duck Typing å½¢å¼åŒ– | Interface Satisfaction |
| **Berkeley CS262A å¹¶å‘** | `Send`/`Sync` trait | GIL æ¨¡å‹ | CSP è¿›ç¨‹ä»£æ•° |
| **ETH ZÃ¼rich å½¢å¼éªŒè¯** | RustBelt (Coq) | Hypothesis | Race Detector |

### 7.2 æ•™æå¯¹åº”

| æ•™æ | ç›¸å…³ç« èŠ‚ |
|------|----------|
| **TAPL** (Types and Programming Languages) | Rust Affine Types (Ch 16), Golang Structural Subtyping (Ch 15) |
| **PFPL** (Practical Foundations for PL) | Rust æˆæœ¬è¯­ä¹‰ (Ch 36), Python åŠ¨æ€ç±»å‹ (Ch 20) |
| **Concurrent Programming** (Herlihy) | Rust æ— é”æ•°æ®ç»“æ„ (Ch 10), Golang Channel (Ch 3) |
| **Rust for Rustaceans** | æœ¬ç«  Rust æ‰€æœ‰å†…å®¹ |

---

## 8. å·¥å…·é“¾å¯¹æ¯”

### 8.1 å¼€å‘å·¥å…·

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚ Rust             â”‚ Python           â”‚ Golang           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŒ…ç®¡ç†       â”‚ Cargo            â”‚ pip / poetry     â”‚ go mod           â”‚
â”‚ æ„å»ºç³»ç»Ÿ     â”‚ Cargo            â”‚ setuptools       â”‚ go build         â”‚
â”‚ æµ‹è¯•æ¡†æ¶     â”‚ #[test]          â”‚ pytest           â”‚ go test          â”‚
â”‚ æ–‡æ¡£ç”Ÿæˆ     â”‚ rustdoc          â”‚ Sphinx           â”‚ godoc            â”‚
â”‚ æ ¼å¼åŒ–       â”‚ rustfmt          â”‚ black            â”‚ gofmt            â”‚
â”‚ Linter       â”‚ clippy           â”‚ pylint/ruff      â”‚ golangci-lint    â”‚
â”‚ LSP          â”‚ rust-analyzer    â”‚ Pylance/Pyright  â”‚ gopls            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 å½¢å¼åŒ–å·¥å…·

| å·¥å…·ç±»å‹ | Rust | Python | Golang |
|----------|------|--------|--------|
| **å®šç†è¯æ˜å™¨** | RustBelt (Coq) | mypy (Gradual Typing) | - |
| **æ¨¡å‹æ£€æµ‹** | MIRI (è§£é‡Šå™¨) | - | - |
| **ç¬¦å·æ‰§è¡Œ** | KLEE-Rust | PyExZ3 | - |
| **å¹¶å‘æ£€æµ‹** | Loom | ThreadSanitizer | `go run -race` |
| **é™æ€åˆ†æ** | Prusti (Viper) | Pyre, Pytype | staticcheck |

---

## 9. å®æˆ˜æ¡ˆä¾‹ï¼šå¹¶å‘å“ˆå¸Œè¡¨

### 9.1 Rust å®ç°ï¼ˆæ— é”ï¼‰

```rust
use std::sync::Arc;
use std::sync::atomic::{AtomicPtr, Ordering};

struct Node<K, V> {
    key: K,
    value: V,
    next: AtomicPtr<Node<K, V>>,
}

pub struct LockFreeHashMap<K, V> {
    buckets: Vec<AtomicPtr<Node<K, V>>>,
}

impl<K: Eq + Hash, V> LockFreeHashMap<K, V> {
    pub fn insert(&self, key: K, value: V) {
        let hash = hash(&key);
        let bucket = &self.buckets[hash % self.buckets.len()];

        let new_node = Box::into_raw(Box::new(Node {
            key, value,
            next: AtomicPtr::new(std::ptr::null_mut()),
        }));

        loop {
            let head = bucket.load(Ordering::Acquire);
            unsafe { (*new_node).next.store(head, Ordering::Relaxed); }

            if bucket.compare_exchange(
                head, new_node,
                Ordering::Release, Ordering::Acquire
            ).is_ok() {
                break;
            }
        }
    }
}
```

**å½¢å¼åŒ–æ€§è´¨**ï¼š

```text
å®šç†ï¼ˆçº¿æ€§åŒ–æ€§ï¼‰ï¼š
  æ¯ä¸ªæ“ä½œåœ¨æŸä¸ªåŸå­æ—¶é—´ç‚¹ç”Ÿæ•ˆ

è¯æ˜å·¥å…·ï¼šIris åˆ†ç¦»é€»è¾‘ + Coq
```

### 9.2 Python å®ç°ï¼ˆGIL ä¿æŠ¤ï¼‰

```python
import threading

class HashTable:
    def __init__(self):
        self.buckets = [[] for _ in range(16)]
        self.lock = threading.Lock()

    def insert(self, key, value):
        with self.lock:  # GIL + æ˜¾å¼é”
            bucket = self.buckets[hash(key) % len(self.buckets)]
            bucket.append((key, value))
```

**æ€§èƒ½**ï¼šGIL å¯¼è‡´å¤šçº¿ç¨‹é€€åŒ–ä¸ºå•çº¿ç¨‹ã€‚

### 9.3 Golang å®ç°ï¼ˆsync.Mapï¼‰

```go
import "sync"

type HashTable struct {
    m sync.Map
}

func (h *HashTable) Insert(key, value interface{}) {
    h.m.Store(key, value)
}

func (h *HashTable) Get(key interface{}) (interface{}, bool) {
    return h.m.Load(key)
}
```

**å®ç°**ï¼šå†…éƒ¨ä½¿ç”¨è¯»å†™åˆ†ç¦» + åŸå­æ“ä½œã€‚

---

## 10. æ€»ç»“ä¸å»ºè®®

### 10.1 æ ¸å¿ƒæ´å¯Ÿ

```text
Rust = å®‰å…¨ä¼˜å…ˆ + é›¶æˆæœ¬æŠ½è±¡
  â†’ é€‚åˆç³»ç»Ÿçº§ã€å®‰å…¨å…³é”®åº”ç”¨
  â†’ å­¦ä¹ æ›²çº¿é™¡å³­ï¼Œå¼€å‘å‘¨æœŸé•¿

Python = å¼€å‘æ•ˆç‡ä¼˜å…ˆ
  â†’ é€‚åˆåŸå‹ã€è„šæœ¬ã€æ•°æ®åˆ†æ
  â†’ è¿è¡Œæ€§èƒ½å·®ï¼Œä¸é€‚åˆæ€§èƒ½å…³é”®åœºæ™¯

Golang = å·¥ç¨‹æ•ˆç‡ä¼˜å…ˆ
  â†’ é€‚åˆäº‘åŸç”Ÿã€å¾®æœåŠ¡ã€é«˜å¹¶å‘
  â†’ æ€§èƒ½ä¸å¼€å‘æ•ˆç‡å¹³è¡¡
```

### 10.2 é€‰æ‹©å†³ç­–æ ‘

```text
éœ€è¦æœ€é«˜æ€§èƒ½ï¼Ÿ
  â”œâ”€ Yes â†’ éœ€è¦å†…å­˜å®‰å…¨ä¿è¯ï¼Ÿ
  â”‚         â”œâ”€ Yes â†’ Rust
  â”‚         â””â”€ No â†’ C/C++
  â””â”€ No â†’ éœ€è¦å¿«é€Ÿå¼€å‘ï¼Ÿ
            â”œâ”€ Yes â†’ éœ€è¦å¹¶å‘ï¼Ÿ
            â”‚         â”œâ”€ Yes â†’ Golang
            â”‚         â””â”€ No â†’ Python
            â””â”€ No â†’ è€ƒè™‘ Java/C#
```

### 10.3 æ··åˆç­–ç•¥

**å®æˆ˜å»ºè®®**ï¼š

1. **Python + Rust**ï¼šæ•°æ®ç§‘å­¦ï¼ˆPython å‰ç«¯ + Rust è®¡ç®—å†…æ ¸ï¼‰
2. **Golang + Rust**ï¼šå¾®æœåŠ¡ï¼ˆGo ä¸šåŠ¡é€»è¾‘ + Rust æ€§èƒ½çƒ­ç‚¹ï¼‰
3. **Python + Golang**ï¼šWeb æœåŠ¡ï¼ˆPython Flask + Go åç«¯ï¼‰

**æ¡ˆä¾‹**ï¼š

- **Polars**ï¼šPython æ•°æ®æ¡†æ¶ï¼ŒRust å®ç°ï¼Œæ¯” Pandas å¿« 10-100x
- **Kubernetes**ï¼šGolang ç¼–å†™ï¼Œä½† eBPF å·¥å…·é“¾ç”¨ Rust
- **NumPy**ï¼šPython æ¥å£ï¼ŒC/Fortran åç«¯

---

## 11. æ‰©å±•é˜…è¯»

### 11.1 å­¦æœ¯è®ºæ–‡

1. **RustBelt**: Jung et al. "RustBelt: Securing the Foundations of the Rust Programming Language." POPL 2018.
2. **Gradual Typing**: Siek & Taha. "Gradual Typing for Functional Languages." Scheme Workshop 2006.
3. **Golang GC**: Hudson. "Getting to Go: The Journey of Go's Garbage Collector." ISMM 2018.

### 11.2 åœ¨çº¿èµ„æº

- **Rust è¯­ä¹‰å­¦**ï¼š<https://rust-lang.github.io/rustc-dev-guide/>
- **Python æ•°æ®æ¨¡å‹**ï¼š<https://docs.python.org/3/reference/datamodel.html>
- **Golang å†…å­˜æ¨¡å‹**ï¼š<https://go.dev/ref/mem>

### 11.3 æœ¬åœ°é¡¹ç›®å¼•ç”¨

- **å½¢å¼è¯­ä¹‰åŸºç¡€**ï¼š[../01_Formal_Semantics/01.1_Operational_Semantics.md](./01.1_Operational_Semantics.md)
- **ç±»å‹ç³»ç»Ÿ**ï¼š[../01_Formal_Semantics/01.3_Type_Systems.md](./01.3_Type_Systems.md)
- **å¹¶å‘æ¨¡å‹**ï¼š[../../FormalLanguage_Perspective/05_Computational_Models/](../../FormalLanguage_Perspective/05_Computational_Models/)

---

## é™„å½• Aï¼šWikipedia æ¦‚å¿µå¯¹ç…§

| æ¦‚å¿µ | Wikipedia æ¡ç›® | æœ¬æ–‡ç« èŠ‚ |
|------|---------------|----------|
| Affine Type System | <https://en.wikipedia.org/wiki/Substructural_type_system> | Â§1.2 |
| Gradual Typing | <https://en.wikipedia.org/wiki/Gradual_typing> | Â§1.2 |
| Structural Type System | <https://en.wikipedia.org/wiki/Structural_type_system> | Â§1.2 |
| Garbage Collection | <https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)> | Â§2.3, Â§2.4 |
| Communicating Sequential Processes | <https://en.wikipedia.org/wiki/Communicating_sequential_processes> | Â§3.3 |
| Global Interpreter Lock | <https://en.wikipedia.org/wiki/Global_interpreter_lock> | Â§3.4 |
| Separation Logic | <https://en.wikipedia.org/wiki/Separation_logic> | Â§6.1 |

---

**ç‰ˆæœ¬**ï¼šv1.0
**æœ€åæ›´æ–°**ï¼š2025-10-29
**ç»´æŠ¤è€…**ï¼šFormalScience Project
**è®¸å¯**ï¼šMIT
