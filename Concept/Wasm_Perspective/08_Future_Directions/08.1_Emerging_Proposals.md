# 8.1 新兴提案 (Emerging Proposals)

## 核心命题

**提案生命周期**：
\[
\text{Phase 0} \to \text{Phase 1} \to \text{Phase 2} \to \text{Phase 3} \to \text{Phase 4 (标准)}
\]

**复杂性爆炸风险**：
\[
|\text{Features}| \uparrow \implies \text{Complexity}(\text{Verification}) \uparrow\uparrow
\]

**向后兼容约束**：
\[
\forall \text{Proposal} : \text{Breaking-Change} \implies \text{Rejected}
\]

---

## GC 提案（Garbage Collection）

### 动机

**当前限制**：
\[
\text{Linear-Memory} \not\supseteq \text{Managed-Heap}
\]

**目标语言**：

- Java, C#, Go, Python...

### 类型扩展

**引用类型**：

```wit
type ref = struct | array | func | extern
type nullable<T> = T | null
```

**示例**：

```wasm
(type $Point (struct (field $x f64) (field $y f64)))

(func $distance (param $p (ref $Point)) (result f64)
  local.get $p
  struct.get $Point $x
  ;; ...
)
```

### 挑战

**性能开销**：
\[
\text{GC-Pause} \approx 10-100\text{ms（Stop-the-World）}
\]

**互操作复杂性**：
\[
\text{Wasm-GC} \leftrightarrow \text{JS-GC} \quad \text{（如何统一？）}
\]

**批判**：
> GC 提案是"高级语言的需求"，但与 Wasm"底层抽象"理念冲突。可能分裂生态：系统语言 vs 应用语言。

---

## Memory64

### 动机

**4GB 限制**：
\[
|\text{Memory}| \leq 2^{32} = 4\text{GB}
\]

**大数据场景**：

- 科学计算
- 机器学习
- 数据库

### 设计

**64 位索引**：

```wasm
(memory i64 1 1000)  ;; 64 位地址
i64.load (param i64) (result i64)
```

**权衡**：
\[
\begin{align*}
\text{Address-Size} &: 4\text{B} \to 8\text{B} \quad (+100\%) \\
\text{Pointer-Ops} &: \text{slower on 32-bit}
\end{align*}
\]

---

## 组件模型（Component Model）

### 愿景

**模块 → 组件**：
\[
\text{Component} = \text{Module} + \text{Interface} + \text{Composition}
\]

**跨语言互操作**：

```wit
interface http {
    request: func(url: string) -> result<response, error>
}
```

### 状态（2025）

- Phase 3（实现中）
- 工具：wasm-tools, wit-bindgen
- 采用：Fermyon, Bytecode Alliance

**批判**：
> 组件模型是"Wasm 的 Docker"，但推进缓慢（5 年未稳定）。生态先行还是标准先行？这是经典困境。

---

## 异步支持（Async/Await）

### 问题

**当前**：
\[
\text{Wasm} = \text{Synchronous-Only}
\]

**需求**：

- I/O 密集应用
- 事件驱动架构

### 提案

**Stack Switching**：

```wasm
(func $async-read (param $fd i32) (result i32)
  ;; suspend 当前栈
  call $suspend
  ;; 恢复后返回结果
)
```

**挑战**：

- 栈切换开销
- 与 JS Promise 集成
- 实现复杂度

---

## 批判性分析

**命题**：
\[
\text{More-Features} \not\Rightarrow \text{Better-Platform}
\]

**风险**：

- 规范膨胀
- 实现碎片化
- 验证复杂化

**批判**：
> Wasm 面临"功能蔓延"风险。每个提案都有合理性，但累加起来可能超越人类理解极限。MVP 的简洁性是其成功关键，但也可能成为增长天花板。

---

## 参考文献

1. **[Wasm-Proposals]** WebAssembly Proposals. https://github.com/WebAssembly/proposals
2. **[GC-Proposal]** "GC Proposal." https://github.com/WebAssembly/gc
