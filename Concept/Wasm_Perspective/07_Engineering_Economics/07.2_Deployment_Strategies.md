# 7.2 éƒ¨ç½²ç­–ç•¥ (Deployment Strategies)

## ğŸ“‹ ç›®å½•

- [7.2 éƒ¨ç½²ç­–ç•¥ (Deployment Strategies)](#72-éƒ¨ç½²ç­–ç•¥-deployment-strategies)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1 æ ¸å¿ƒå‘½é¢˜](#1-æ ¸å¿ƒå‘½é¢˜)
  - [2 éƒ¨ç½²æ¨¡å¼](#2-éƒ¨ç½²æ¨¡å¼)
    - [2.1 è“ç»¿éƒ¨ç½²](#21-è“ç»¿éƒ¨ç½²)
    - [2.2 é‡‘ä¸é›€å‘å¸ƒ](#22-é‡‘ä¸é›€å‘å¸ƒ)
  - [3 Wasm ä¼˜åŠ¿](#3-wasm-ä¼˜åŠ¿)
    - [3.1 å¿«é€Ÿå›æ»š](#31-å¿«é€Ÿå›æ»š)
    - [3.2 ç‰ˆæœ¬å…±å­˜](#32-ç‰ˆæœ¬å…±å­˜)
  - [4 AB æµ‹è¯•](#4-ab-æµ‹è¯•)
    - [4.1 åˆ†æµç­–ç•¥](#41-åˆ†æµç­–ç•¥)
    - [4.2 ç»Ÿè®¡æ˜¾è‘—æ€§](#42-ç»Ÿè®¡æ˜¾è‘—æ€§)
  - [5 æ‰¹åˆ¤æ€§åˆ†æ](#5-æ‰¹åˆ¤æ€§åˆ†æ)
  - [å‚è€ƒæ–‡çŒ®](#å‚è€ƒæ–‡çŒ®)

---

## 1 æ ¸å¿ƒå‘½é¢˜

**ç°åº¦å‘å¸ƒæ¨¡å‹**ï¼š
\[
\text{Risk} = P(\text{Failure}) \times \text{Impact}(\text{Failure})
\]

**é‡‘ä¸é›€åŸåˆ™**ï¼š
\[
\alpha_{\text{initial}} \ll 1, \quad \alpha_{\text{final}} = 1
\]

**å›æ»šæ—¶é—´ç›®æ ‡**ï¼š
\[
T_{\text{rollback}} < 60\text{s}
\]

---

## 2 éƒ¨ç½²æ¨¡å¼

### 2.1 è“ç»¿éƒ¨ç½²

**æ¶æ„**ï¼š

```text
Load Balancer
  â”œâ”€> Blue (v1)  100% traffic
  â””â”€> Green (v2) 0% traffic
      â†“ (åˆ‡æ¢)
Load Balancer
  â”œâ”€> Blue (v1)  0% traffic
  â””â”€> Green (v2) 100% traffic
```

**åˆ‡æ¢æ—¶é—´**ï¼š
\[
T_{\text{switch}} \approx 1-5\text{sï¼ˆDNS/LB æ›´æ–°ï¼‰}
\]

### 2.2 é‡‘ä¸é›€å‘å¸ƒ

**æµé‡æ¯”ä¾‹**ï¼š
\[
\alpha(t) = \begin{cases}
0.01 & t = 0 \\
0.05 & t = 1\text{h} \\
0.25 & t = 6\text{h} \\
1.00 & t = 24\text{h}
\end{cases}
\]

**é£é™©æ§åˆ¶**ï¼š
\[
\text{Exposed-Users} = \alpha \times N_{\text{total}}
\]

---

## 3 Wasm ä¼˜åŠ¿

### 3.1 å¿«é€Ÿå›æ»š

**å®¹å™¨å›æ»š**ï¼š
\[
T_{\text{container}} = T_{\text{pull}} + T_{\text{start}} \approx 30-120\text{s}
\]

**Wasm å›æ»š**ï¼š
\[
T_{\text{wasm}} = T_{\text{load}} + T_{\text{instantiate}} \approx 1-5\text{s}
\]

### 3.2 ç‰ˆæœ¬å…±å­˜

**å†…å­˜éš”ç¦»**ï¼š

```
Runtime
  â”œâ”€> Instance v1 (10% traffic)
  â””â”€> Instance v2 (90% traffic)
```

**å¼€é”€**ï¼š
\[
\text{Memory}_{\text{overhead}} \approx 2 \times \text{Module-Size}
\]

---

## 4 AB æµ‹è¯•

### 4.1 åˆ†æµç­–ç•¥

**å“ˆå¸Œåˆ†æ¡¶**ï¼š
\[
\text{Bucket}(\text{user-id}) = \text{hash}(\text{user-id}) \bmod N
\]

**å®éªŒç»„åˆ†é…**ï¼š
\[
\text{Version}(u) = \begin{cases}
\text{A} & \text{Bucket}(u) < N/2 \\
\text{B} & \text{otherwise}
\end{cases}
\]

### 4.2 ç»Ÿè®¡æ˜¾è‘—æ€§

**t-æ£€éªŒ**ï¼š
\[
t = \frac{\bar{X}_A - \bar{X}_B}{\sqrt{\frac{s_A^2}{n_A} + \frac{s_B^2}{n_B}}}
\]

**æ ·æœ¬é‡ä¼°è®¡**ï¼š
\[
n \approx \frac{16\sigma^2}{\delta^2} \quad (\alpha=0.05, \beta=0.2)
\]

---

## 5 æ‰¹åˆ¤æ€§åˆ†æ

**å‘½é¢˜**ï¼š
\[
\text{Fast-Deployment} \not\Rightarrow \text{Safe-Deployment}
\]

**æ‰¹åˆ¤**ï¼š
> Wasm çš„å¿«é€Ÿéƒ¨ç½²æ˜¯åŒåˆƒå‰‘ï¼šåŠ é€Ÿåˆ›æ–°ï¼Œä¹ŸåŠ é€Ÿé”™è¯¯ä¼ æ’­ã€‚æ²¡æœ‰å®Œå–„ç›‘æ§ä¸è‡ªåŠ¨å›æ»šï¼Œå¿«é€Ÿéƒ¨ç½²åè€Œå¢åŠ é£é™©ã€‚æŠ€æœ¯èƒ½åŠ›éœ€è¦é…å¥—æµç¨‹ã€‚

---

## å‚è€ƒæ–‡çŒ®

1. **[Humble10]** Jez Humble. "Continuous Delivery." Addison-Wesley, 2010.
