# 7.3 成本效益分析

> **子主题编号**: 07.3
> **主题**: Wasm视角

## 📋 目录

- [7.3 成本效益分析](#73-成本效益分析)
  - [📋 目录](#-目录)
  - [1 核心命题](#1-核心命题)
  - [2 成本结构](#2-成本结构)
    - [2.1 开发成本](#21-开发成本)
    - [2.2 运维成本](#22-运维成本)
    - [2.3 人力成本](#23-人力成本)
  - [3 收益量化](#3-收益量化)
    - [3.1 性能收益](#31-性能收益)
    - [3.2 密度收益](#32-密度收益)
  - [4 风险评估](#4-风险评估)
    - [4.1 技术风险](#41-技术风险)
    - [4.2 机会成本](#42-机会成本)
  - [5 案例研究](#5-案例研究)
    - [5.1 Shopify Functions](#51-shopify-functions)
  - [6 批判性分析](#6-批判性分析)
  - [参考文献](#参考文献)

---

## 1 核心命题

**TCO 模型**（总拥有成本）：
\[
\text{TCO} = C_{\text{acquisition}} + C_{\text{operation}} + C_{\text{maintenance}}
\]

**NPV 决策**（净现值）：
\[
\text{NPV} = \sum_{t=0}^{n} \frac{\text{CashFlow}_t}{(1+r)^t}
\]

**采用条件**：
\[
\text{NPV}_{\text{wasm}} > \text{NPV}_{\text{status-quo}} + \text{Risk-Premium}
\]

---

## 2 成本结构

### 2.1 开发成本

**学习曲线**：
\[
C_{\text{learning}} = N_{\text{dev}} \times T_{\text{training}} \times \text{Rate}_{\text{hourly}}
\]

**工具链投入**：

- 编译器集成：$20k-$50k
- CI/CD 流水线：$10k-$30k
- 监控系统：$15k-$40k

### 2.2 运维成本

**基础设施**：
\[
C_{\text{infra}} = N_{\text{nodes}} \times (\text{Compute} + \text{Network} + \text{Storage})
\]

**Wasm 节省（边缘场景）**：

- 实例密度：10×
- 冷启动：100×
- 带宽：2-5×（差分更新）

### 2.3 人力成本

**技能溢价**：
\[
\text{Salary}_{\text{wasm-expert}} \approx 1.2 \times \text{Salary}_{\text{avg-dev}}
\]

---

## 3 收益量化

### 3.1 性能收益

**延迟降低**：
\[
\Delta\text{Latency} = 200\text{ms} \to 20\text{ms} \quad (\text{边缘})
\]

**转化率提升**：
\[
\Delta\text{Conversion} \approx 0.1\% / 10\text{ms}
\]

**年收入影响**（电商，年GMV $1B）：
\[
\Delta\text{Revenue} = \$1B \times 1.8\% = \$18M
\]

### 3.2 密度收益

**服务器减少**：
\[
\frac{N_{\text{before}}}{N_{\text{after}}} = 10 \implies \text{Saving} = 9 \times \$50k = \$450k/\text{year}
\]

---

## 4 风险评估

### 4.1 技术风险

**概率-影响矩阵**：
\[
\begin{array}{c|cc}
\text{Risk} & \text{Prob} & \text{Impact} \\
\hline
\text{性能回退} & 20\% & -\$100k \\
\text{工具链不成熟} & 30\% & -\$50k \\
\text{人才短缺} & 40\% & -\$200k
\end{array}
\]

**期望损失**：
\[
E[\text{Loss}] = \sum P_i \times \text{Impact}_i = \$110k
\]

### 4.2 机会成本

**投入对比**：

- Wasm 迁移：$200k
- 其他优化：$200k（数据库、缓存...）

**决策原则**：选择 ROI 最高项

---

## 5 案例研究

### 5.1 Shopify Functions

**投入**：

- 开发：6 月 × 10 人 = 60 人月
- 基础设施：$50k

**收益**：

- 函数调用：10B/月
- 成本降低：$2M/年（vs Lambda）
- 灵活性：商家自定义逻辑

**ROI**：
\[
\text{ROI} = \frac{\$2M - \$500k}{\$500k} = 300\%
\]

**盈亏平衡**：3 个月

---

## 6 批判性分析

**命题**：
\[
\text{Quantified-ROI} \not\Rightarrow \text{Actual-Success}
\]

**不可量化因素**：

- 团队士气
- 创新空间
- 技术债务

**批判**：
> 成本收益分析是"理性的假象"：数字可量化，但价值不可穷尽。Wasm 的战略价值（平台无关、未来可扩展性）难以货币化，但可能是最大收益。

---

## 参考文献

1. **[McConnell06]** Steve McConnell. "Software Estimation." Microsoft Press, 2006.
