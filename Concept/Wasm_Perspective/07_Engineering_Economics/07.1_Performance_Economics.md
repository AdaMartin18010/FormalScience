# 7.1 性能经济学 (Performance Economics)

## 核心命题

**延迟-收入模型**：
\[
\Delta\text{Revenue} = -k \times \Delta\text{Latency}
\]

**Amazon 法则**：每 100ms 延迟 → 1% 销售额损失

**成本函数**：
\[
\text{Cost}_{\text{total}} = C_{\text{infra}} + C_{\text{dev}} + C_{\text{maintenance}}
\]

---

## 性能价值量化

### 用户体验价值

**转化率模型**：
\[
\text{Conversion-Rate} = f(\text{Latency}, \text{Throughput}, \text{Availability})
\]

**实证数据**：

- Google：延迟 +500ms → 流量 -20%
- Walmart：加载时间 -1s → 转化率 +2%

### 基础设施成本

**服务器成本**：
\[
C_{\text{server}} = N_{\text{instances}} \times \text{Price}_{\text{unit}} \times \text{Uptime}
\]

**Wasm 密度优势**：
\[
\frac{N_{\text{container}}}{N_{\text{wasm}}} \approx 10-100
\]

**月度节省（10k 实例）**：
\[
\Delta C = 10000 \times (\$50 - \$5) = \$450,000
\]

---

## ROI 模型

### 迁移成本

**一次性投入**：
\[
C_{\text{migration}} = C_{\text{dev}} + C_{\text{test}} + C_{\text{deploy}}
\]

**典型数据**：

- 中型应用：$50k-$200k
- 大型应用：$500k-$2M

### 持续收益

**年度节省**：
\[
\text{Saving}_{\text{annual}} = \Delta C_{\text{infra}} + \Delta C_{\text{bandwidth}} + \Delta\text{Revenue}
\]

**盈亏平衡点**：
\[
T_{\text{break-even}} = \frac{C_{\text{migration}}}{\text{Saving}_{\text{monthly}}}
\]

**实例（边缘 CDN）**：

- 迁移成本：$150k
- 月度节省：$30k
- 盈亏平衡：5 个月

---

## 排队论模型

### M/M/1 队列

**平均延迟**：
\[
E[T] = \frac{1}{\mu - \lambda}
\]

**利用率影响**：
\[
\rho = \frac{\lambda}{\mu}, \quad E[T] \approx \frac{1}{\mu(1 - \rho)}
\]

**性能提升价值**：
\[
\mu_{\text{new}} = 1.2 \times \mu_{\text{old}} \implies E[T]_{\text{new}} = 0.6 \times E[T]_{\text{old}}
\]

---

## 批判性分析

**命题**：
\[
\text{Performance} \not\propto \text{Business-Value}
\]

**边际效应递减**：

- 50ms → 20ms：高价值
- 20ms → 5ms：低价值

**批判**：
> 性能优化是"投资回报递减"。从 90% 优化到 95% 的成本，可能高于从 50% 到 90%。工程决策需权衡边际成本与边际收益。

---

## 参考文献

1. **[Kohavi07]** Ron Kohavi et al. "Practical Guide to Controlled Experiments." KDD, 2007.
